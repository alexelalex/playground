import{j as e,r as u,l as ne,U as q,a as Q,V as te,q as v,W as N}from"./index-Z48k0RZH.js";import{H}from"./Header-DhRB9CJN.js";import{b as A,bp as ie,L as W,h as oe,I as le,bg as re,m as L,bq as z,br as P,x as O,d as h,bs as D,q as S,r as k,bt as $,p as y,C as B,bu as E,j as K,bv as J,bw as R,s as ce,bx as Y,T as de,by as ue,bz as pe,bA as xe,bB as ge,bC as he,B as G,bD as me,bE as X,bF as V,bG as je,bH as fe,bI as be,bJ as Ce,J as Z,ap as Se,a3 as ye,u as ee,bK as ve,bj as we,aC as ze,bL as Oe,bM as ke,K as w,bN as Ie,bO as _e,bP as Fe,bQ as Ne,bR as Ue,N as Te,Y as Ae,O as U,bS as We,bT as Le,a6 as Pe}from"./App-XcBPpDfQ.js";import{A as De}from"./AddIntegrationTooltip-BwRY3ITp.js";function $e({open:s,setOpen:a,panelContent:i,panelHeaderProps:t,children:o,...g}){return e.jsxs(A,{grow:!0,...g,children:[e.jsx(ie,{open:s,children:e.jsxs(W,{className:"filters",style:{maxWidth:300},grow:[0,1],children:[e.jsx(oe,{...t,actions:e.jsxs(e.Fragment,{children:[t==null?void 0:t.actions,e.jsx(le,{size:"small",onClick:()=>a(!s),children:e.jsx(re,{fontSize:"small"})})]})}),i]})}),o]})}function se(s,{omitKey:a}={}){return u.useMemo(()=>Object.keys(ne.omit(s||{},a)).length,[s,a])}const Be=L(s=>({paper:{minHeight:"500px",maxWidth:"650px",minWidth:"340px",width:"100%"},customStepClass:{width:"100%"},dialogContent:{padding:s.spacing(2),overflow:"auto",display:"flex",flexDirection:"column",justifyContent:"space-between"},dialogActions:{padding:s.spacing(2)},cloudLogo:{height:"20px",width:"20px",marginRight:s.spacing(1),fill:s.palette.common.gray},cancelButton:{textTransform:"none"},info:{marginTop:"10px"}})),Ee=({dialogOpen:s,stepInfo:a,users:i,workspaces:t,userWorkspacesRelations:o,checkedUsers:g,closeDialog:n,draggable:l,disableBackdropClick:x})=>{const p=Be({stepInfo:a}),[d,j]=u.useState(!1),[m,r]=u.useState(!1),[b,C]=u.useState(!1),I=()=>{r(!1),n()};return e.jsxs(e.Fragment,{children:[e.jsxs(z,{onClose:n,open:s,classes:{paper:`${p.paper} ${p.customStepClass}`},hideBackdrop:x,disableBackdropClick:x,children:[e.jsx(P,{draggable:l,onClose:n,hideTitleDivider:a.hideTitleDivider,children:e.jsxs(O,{display:"flex",children:[e.jsx(a.Icon,{className:p.cloudLogo,color:"disabled"}),e.jsx(h,{variant:"body1",noWrap:!0,children:a.label})]})}),e.jsxs(D,{className:p.dialogContent,children:[e.jsx(u.Suspense,{fallback:e.jsx(S,{children:e.jsx(k,{})}),children:e.jsx(a.Component,{setLoading:r,loading:m,handleNext:I,onClose:n,optionalInfo:a.optionalInfo,users:i,workspaces:t,userWorkspacesRelations:o,checkedUsers:g,onChangeUpdateAccessable:_=>C(_)})}),e.jsx(q,{severity:"info",className:p.info,children:"Your selection will override existing settings"})]}),e.jsxs($,{className:p.dialogActions,children:[e.jsx(y,{id:"cancel-button",className:p.cancelButton,variant:"text",size:"small",disabled:m,onClick:()=>n(),children:"Cancel"}),e.jsx(y,{id:"ok-button",startIcon:m&&e.jsx(B,{size:20}),disabled:m||!b,color:"primary",form:"wizard-form",type:"submit",size:"small",children:a.submitStepText})]})]}),e.jsx(E,{confirmDialogOpen:d,closeConfirmDialog:()=>j(!1),confirmClose:()=>{n(),j(!1)}})]})},Me=L(s=>({paper:{maxWidth:"435px",width:"100%"},customStepClass:{width:"100%"},dialogContent:{padding:s.spacing(2),overflow:"auto"},dialogActions:{padding:s.spacing(2)},cloudLogo:{height:"20px",width:"20px",marginRight:s.spacing(1),fill:s.palette.common.gray},cancelButton:{textTransform:"none"}})),Re=({dialogOpen:s,stepInfo:a,workspaces:i,userWorkspacesRelations:t,closeDialog:o,draggable:g,disableBackdropClick:n})=>{const l=Me({stepInfo:a}),[x,p]=u.useState(!1),[d,j]=u.useState(!1),[m,r]=u.useState(!1),b=()=>{j(!1),o()};return e.jsxs(e.Fragment,{children:[e.jsxs(z,{onClose:o,open:s,classes:{paper:`${l.paper} ${l.customStepClass}`},hideBackdrop:n,disableBackdropClick:n,children:[e.jsx(P,{draggable:g,onClose:o,hideTitleDivider:a.hideTitleDivider,children:e.jsxs(O,{display:"flex",children:[e.jsx(a.Icon,{className:l.cloudLogo,color:"disabled"}),e.jsx(h,{variant:"body1",noWrap:!0,children:a.label})]})}),e.jsx(D,{className:l.dialogContent,children:e.jsx(u.Suspense,{fallback:e.jsx(S,{children:e.jsx(k,{})}),children:e.jsx(a.Component,{setLoading:j,loading:d,handleNext:b,onClose:o,optionalInfo:a.optionalInfo,workspaces:i,userWorkspacesRelations:t,onChangeSaveAccessable:C=>r(C)})})}),e.jsxs($,{className:l.dialogActions,children:[e.jsx(y,{id:"cancel-button",className:l.cancelButton,variant:"text",size:"small",disabled:d,onClick:()=>o(),children:"Cancel"}),e.jsx(y,{id:"ok-button",startIcon:d&&e.jsx(B,{size:20}),disabled:d||!m,color:"primary",form:"wizard-form",type:"submit",size:"small",children:a.submitStepText})]})]}),e.jsx(E,{confirmDialogOpen:x,closeConfirmDialog:()=>p(!1),confirmClose:()=>{o(),p(!1)}})]})},Ge=L(s=>({paper:{maxWidth:"435px",width:"100%"},customStepClass:{width:"100%"},dialogContent:{padding:s.spacing(2),overflow:"auto"},dialogActions:{padding:s.spacing(2)},cloudLogo:{height:"20px",width:"20px",marginRight:s.spacing(1),fill:s.palette.common.gray},cancelButton:{textTransform:"none"},info:{marginTop:s.spacing(4)}})),Ve=({dialogOpen:s,stepInfo:a,workspaces:i,closeDialog:t,draggable:o,disableBackdropClick:g})=>{const n=Ge({stepInfo:a}),[l,x]=u.useState(!1),[p,d]=u.useState(!1),j=()=>{d(!1),t()};return e.jsxs(e.Fragment,{children:[e.jsxs(z,{onClose:t,open:s,classes:{paper:`${n.paper} ${n.customStepClass}`},hideBackdrop:g,disableBackdropClick:g,children:[e.jsx(P,{draggable:o,onClose:t,hideTitleDivider:a.hideTitleDivider,helpText:a.HelpText,children:e.jsxs(O,{display:"flex",children:[e.jsx(a.Icon,{className:n.cloudLogo,color:"disabled"}),e.jsx(h,{variant:"body1",noWrap:!0,children:a.label})]})}),e.jsxs(D,{className:n.dialogContent,children:[e.jsx(u.Suspense,{fallback:e.jsx(S,{children:e.jsx(k,{})}),children:e.jsx(a.Component,{setLoading:d,loading:p,handleNext:j,onClose:t,workspaces:i})}),e.jsxs(q,{severity:"info",className:n.info,children:["The default permission is Standard User.",e.jsx("br",{}),"Changing permissions is allowed after the user accepts the invitation."]})]}),e.jsxs($,{className:n.dialogActions,children:[e.jsx(y,{id:"cancel-button",className:n.cancelButton,variant:"text",size:"small",disabled:p,onClick:()=>t(),children:"Cancel"}),e.jsx(y,{id:"ok-button",startIcon:p&&e.jsx(B,{size:20}),disabled:p,color:"primary",form:"wizard-form",type:"submit",size:"small",children:a.submitStepText})]})]}),e.jsx(E,{confirmDialogOpen:l,closeConfirmDialog:()=>x(!1),confirmClose:()=>{t(),x(!1)}})]})};function qe({searchValue:s,filtersValues:a,filtersOpen:i,setFiltersOpen:t,handleSearchValueChange:o,...g}){var M;const[n,l]=u.useState([]),[x,p]=u.useState([]),[d,j]=u.useState([]),m=se(a,{omitKey:"search_value"}),{data:{users:r=[]}={},...b}=Q(K`
      query Users($filters: UsersFilters) {
        users(filters: $filters) {
          _id
          email
          status
          full_name
          two_factor_state
          organization_admin
          permissions {
            _id
            workspace_id
            role
            user_groups
          }
        }
      }
    `,{fetchPolicy:"cache-and-network",variables:{filters:a}}),[C,I]=J(),_=u.useMemo(()=>r==null?void 0:r.filter(c=>d.includes(c._id)).every(c=>c.status===R.PENDING),[r,d]),ae=u.useMemo(()=>r==null?void 0:r.filter(c=>d.includes(c._id)).every(c=>c.status===R.ACTIVE),[r,d]);return b.error?e.jsx(S,{children:e.jsx(ce,{error:b.error})}):e.jsxs(W,{...g,children:[e.jsx(H,{Icon:Y,title:e.jsx(e.Fragment,{children:e.jsx(h,{variant:"inherit",color:d.length?"primary":"textPrimary",children:d.length?`${d.length}/${r.length} Selected users`:`Users ${r.length?` (${r.length})`:""}`})}),actions:e.jsxs(A,{gap:1,children:[e.jsx(de,{placeholder:"Search",variant:"outlined",value:s,size:"small",style:{width:260},onChange:c=>o(c.target.value.trim()),InputProps:{endAdornment:e.jsx(ue,{fontSize:"small",color:"action"})}}),e.jsx(pe,{triggerComponent:c=>d.length>0&&e.jsx(G,{variant:"text",color:"primary",...c,selected:!0,endIcon:e.jsx(me,{}),children:"Actions"}),options:_?xe():ae?ge():he(),onClickOptions:c=>{l(c.steps(r.filter(f=>d.includes(f._id))))}}),e.jsxs(G,{variant:"text",startIcon:e.jsx(X,{fontSize:"small"}),onClick:()=>t(!i),active:i,selected:m>0,children:["Filters ",`${m>0?`(${m})`:""}`]}),e.jsx(De,{startIcon:e.jsx(je,{fontSize:"large",color:"action"}),onClick:()=>l([V]),children:"Invite user"})]})}),b.loading?e.jsx(S,{children:e.jsx(k,{})}):(m>0||a!=null&&a.search_value)&&(r==null?void 0:r.length)===0?e.jsx(S,{children:e.jsx(h,{color:"textSecondary",children:"No results"})}):e.jsx(O,{p:3,flexGrow:1,overflow:"auto",children:e.jsx(fe,{users:r,usersQuery:b,workspaces:C,workspacesQuery:I,checkedUsers:d,openWizard:c=>l(c),updateUserWorkspacesRelations:c=>{p(f=>[...f.filter(F=>F.userId!==c.userId),c])},toggleAllUsersChecking:()=>{j(c=>r.length!==c.length?r.map(f=>f._id):[])},changeCheckedUsers:c=>{j(f=>f.includes(c)?f.filter(F=>F!==c):[...f,c])}})}),!!n.length&&(((M=n[0])==null?void 0:M.label)===V.label?e.jsx(Ve,{stepInfo:n[0],workspaces:C,closeDialog:()=>l(!1),dialogOpen:!0}):n[0].label===be.label?e.jsx(Ee,{stepInfo:{...n[0],optionalInfo:[n[0].optionalInfo]},users:r,workspaces:C,checkedUsers:d,userWorkspacesRelations:x,closeDialog:()=>l(!1),dialogOpen:!0}):n[0].label===Ce.label?e.jsx(Re,{stepInfo:n[0],workspaces:C,userWorkspacesRelations:x,closeDialog:()=>l(!1),dialogOpen:!0}):e.jsx(Z,{stepsInfo:n,closeDialog:()=>l(!1),dialogOpen:!0}))]})}function Qe({values:s,onChange:a}){const i=He();return e.jsx(Se,{filters:i,filterValues:s,onChange:a})}function He(){const[s]=J(),a=ye(s,"_id");return u.useMemo(()=>[{key:"workspace_id",displayName:"Workspace",options:s==null?void 0:s.map(i=>({value:i._id,filterBy:i.display_name})),renderOption:i=>{var t;return((t=a[i])==null?void 0:t.display_name)||i},searchableOptions:!0,defaultOpen:!0}],[a,s])}function Ke(){const[s,a]=ee("f"),i=se(s),[t,o]=u.useState(i>0),[g,n,l]=te("",1e3);return e.jsx($e,{open:t,setOpen:o,panelContent:e.jsx(Qe,{values:s,onChange:a}),panelHeaderProps:{icon:e.jsx(X,{fontSize:"small",color:"action"}),title:e.jsx(h,{variant:"subtitle1",children:"Filters"})},children:e.jsx(qe,{searchValue:l,filtersValues:{...s,search_value:g},filtersOpen:t,setFiltersOpen:o,handleSearchValueChange:x=>{n(x)}})})}function Je(){return e.jsx(Ye,{children:e.jsx(Xe,{children:e.jsx(ve,{})})})}const Ye=v.div.withConfig({displayName:"SSOPage__Container",componentId:"sc-1i6zea6-0"})(({theme:s})=>({padding:s.spacing(2)})),Xe=v.div.withConfig({displayName:"SSOPage__Paper",componentId:"sc-1i6zea6-1"})(({theme:s})=>({background:s.palette.background.paper,borderRadius:s.shape.borderRadius,margin:"0 auto",maxWidth:700,padding:s.spacing(2)}));function Ze(){return e.jsxs(es,{children:[e.jsx(T,{icon:e.jsx(we,{}),name:N.Compliance,title:"Compliance",description:e.jsx(h,{color:"textSecondary",children:"Enable compliance to automatically check your cloud infrastructure against industry standards."})}),e.jsx(T,{icon:e.jsx(ze,{}),name:N.Simulations,title:"IaC Governance",description:e.jsx(h,{color:"textSecondary",children:"Enable IaC governance to simulate changes to your cloud infrastructure."})}),e.jsx(T,{icon:e.jsx(Oe,{}),name:N.Cost,title:"Cost Governance",description:e.jsx(h,{color:"textSecondary",children:"Enable cost to track and optimize your cloud costs."})})]})}function T({name:s,icon:a,title:i,description:t=null,prompt:o,isBeta:g=!1}){const[n,l]=u.useState(!1),[x,p]=ke(s);async function d(){o?l(!0):p(!x)}return e.jsxs(e.Fragment,{children:[e.jsxs(w,{column:!0,round:!0,paper:!0,gap:2,pad:2,children:[e.jsxs(w,{row:!0,gap:2,center:!0,children:[a,i&&e.jsx(h,{variant:"subtitle2",children:i}),g&&e.jsx(Ie,{variant:"caption"}),e.jsx(w,{grow:!0}),e.jsx(_e,{checked:!!x,size:"small",onClick:d})]}),e.jsx(w,{children:e.jsx(h,{color:"textSecondary",children:t})})]}),e.jsx(z,{open:n,onClose:()=>l(!1),children:o==null?void 0:o({enabled:x,onClose:()=>l(!1),onConfirm:()=>{l(!1),setTimeout(()=>p(!x),100)}})})]})}const es=v.div.withConfig({displayName:"FeatureFlagsPage__Container",componentId:"sc-16pvt1t-0"})(({theme:s})=>({display:"flex",flexDirection:"column",gap:s.spacing(2),margin:"0 auto",maxWidth:700,padding:s.spacing(2)}));function ls(){const s=Fe(),[a,i]=ee("t","users"),[t,o]=u.useState(!1),{disableSSO:g}=Ne();return e.jsxs(e.Fragment,{children:[e.jsxs(as,{children:[e.jsx(H,{Icon:Ue,title:e.jsxs(A,{gap:2,style:{alignItems:"center"},children:[e.jsx(h,{variant:"h5",children:"Organization Settings"}),e.jsxs(Te,{value:a,onChange:(n,l)=>i(l),children:[e.jsx(U,{value:"users",label:"Users and access",icon:e.jsx(Y,{color:"action"})}),!g&&e.jsx(U,{value:"sso",label:"Single Sign On (SSO)",icon:e.jsx(We,{color:"action"}),disabled:!(s!=null&&s.organization_admin)}),Ae()&&e.jsx(U,{value:"ffs",label:"Feature Flags",icon:e.jsx(Le,{color:"action"})})]})]})}),e.jsx(ss,{children:{users:e.jsx(Ke,{}),sso:e.jsx(Je,{}),ffs:e.jsx(Ze,{})}[a]})]}),e.jsx(Z,{stepsInfo:t,closeDialog:()=>o(!1),dialogOpen:!0})]})}const ss=v.div.withConfig({displayName:"OrganizationSettingsPage__PageWrapper",componentId:"sc-141imlp-0"})({flexGrow:1,overflow:"auto"}),as=v(W).withConfig({displayName:"OrganizationSettingsPage__Container",componentId:"sc-141imlp-1"})({height:"100%"});function rs(s){var o;const{data:a,loading:i}=Q(K`
      query OrganizationNameQuery {
        organizationDetails {
          organization_id
          organization_name
        }
      }
    `,{fetchPolicy:"cache-first"}),t=(o=a==null?void 0:a.organizationDetails)==null?void 0:o.organization_name;return i?e.jsx(Pe,{width:150,animation:"wave"}):t?e.jsx(h,{variant:"h6",children:t}):e.jsx(h,{color:"textSecondary",children:"Organization Settings"})}export{rs as OrganizationName,ls as WorkspaceSettingsPage,ls as default};

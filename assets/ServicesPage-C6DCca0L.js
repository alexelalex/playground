import{ag as Ee,ah as Ae,ai as Ne,aj as Ve,r as n,w as O,_ as Q,ak as Le,al as Be,K as z,M as P,am as Pe,I as H,m as ze,a8 as ce,an as q,j as e,q as A,d as F,R as Oe,ao as He,a7 as ve,f as Z,a as qe}from"./index-CDz6_-F0.js";import{d_ as Fe,w as ye,d as u,a7 as Ke,m as fe,dB as de,L as T,b as f,d$ as ue,T as B,cg as X,e0 as U,p as M,e1 as J,e2 as Ge,e3 as Ye,e4 as Ue,i as ee,j as We,e5 as ae,I as je,bg as te,bs as ne,bt as se,C as K,bq as ie,e6 as Ce,c5 as Qe,e7 as Ze,ae as pe,e8 as W,cI as Xe,co as oe,n as re,de as Je,e9 as ea,cv as aa,ea as ta,y as na,cF as sa,eb as ia,ec as oa,ed as ra,by as la,bX as ca,bY as da,M as he,cm as ge,ee as Se,bZ as xe,ef as ua,h as pa}from"./App-c61S4xKC.js";import{T as ha}from"./TagOutline-Sd9LFuCz.js";function ga(t){return Ee(t)||Ae(t)||Ne(t)||Ve()}var be=n.createContext({}),xa=function(a){var i={duration:a.transitions.duration.shortest};return{root:{position:"relative",transition:a.transitions.create(["margin"],i),"&:before":{position:"absolute",left:0,top:-1,right:0,height:1,content:'""',opacity:1,backgroundColor:a.palette.divider,transition:a.transitions.create(["opacity","background-color"],i)},"&:first-child":{"&:before":{display:"none"}},"&$expanded":{margin:"16px 0","&:first-child":{marginTop:0},"&:last-child":{marginBottom:0},"&:before":{opacity:0}},"&$expanded + &":{"&:before":{display:"none"}},"&$disabled":{backgroundColor:a.palette.action.disabledBackground}},rounded:{borderRadius:0,"&:first-child":{borderTopLeftRadius:a.shape.borderRadius,borderTopRightRadius:a.shape.borderRadius},"&:last-child":{borderBottomLeftRadius:a.shape.borderRadius,borderBottomRightRadius:a.shape.borderRadius,"@supports (-ms-ime-align: auto)":{borderBottomLeftRadius:0,borderBottomRightRadius:0}}},expanded:{},disabled:{}}},ma=n.forwardRef(function(a,i){var c=a.children,s=a.classes,g=a.className,x=a.defaultExpanded,r=x===void 0?!1:x,m=a.disabled,S=m===void 0?!1:m,b=a.expanded,_=a.onChange,I=a.square,k=I===void 0?!1:I,w=a.TransitionComponent,C=w===void 0?ye:w,v=a.TransitionProps,D=Q(a,["children","classes","className","defaultExpanded","disabled","expanded","onChange","square","TransitionComponent","TransitionProps"]),R=Fe({controlled:b,default:r,name:"Accordion",state:"expanded"}),l=Le(R,2),o=l[0],j=l[1],N=n.useCallback(function(Y){j(!o),_&&_(Y,!o)},[o,_,j]),y=n.Children.toArray(c),d=ga(y),p=d[0],E=d.slice(1),G=n.useMemo(function(){return{expanded:o,disabled:S,toggle:N}},[o,S,N]);return n.createElement(Be,z({className:P(s.root,g,o&&s.expanded,S&&s.disabled,!k&&s.rounded),ref:i,square:k},D),n.createElement(be.Provider,{value:G},p),n.createElement(C,z({in:o,timeout:"auto"},v),n.createElement("div",{"aria-labelledby":p.props.id,id:p.props["aria-controls"],role:"region"},E)))});const va=O(xa,{name:"MuiAccordion"})(ma);var ya=function(a){return{root:{display:"flex",padding:a.spacing(1,2,2)}}},fa=n.forwardRef(function(a,i){var c=a.classes,s=a.className,g=Q(a,["classes","className"]);return n.createElement("div",z({className:P(c.root,s),ref:i},g))});const ja=O(ya,{name:"MuiAccordionDetails"})(fa);var Ca=function(a){var i={duration:a.transitions.duration.shortest};return{root:{display:"flex",minHeight:8*6,transition:a.transitions.create(["min-height","background-color"],i),padding:a.spacing(0,2),"&:hover:not($disabled)":{cursor:"pointer"},"&$expanded":{minHeight:64},"&$focused, &$focusVisible":{backgroundColor:a.palette.action.focus},"&$disabled":{opacity:a.palette.action.disabledOpacity}},expanded:{},focused:{},focusVisible:{},disabled:{},content:{display:"flex",flexGrow:1,transition:a.transitions.create(["margin"],i),margin:"12px 0","&$expanded":{margin:"20px 0"}},expandIcon:{transform:"rotate(0deg)",transition:a.transitions.create("transform",i),"&:hover":{backgroundColor:"transparent"},"&$expanded":{transform:"rotate(180deg)"}}}},Sa=n.forwardRef(function(a,i){var c=a.children,s=a.classes,g=a.className,x=a.expandIcon,r=a.focusVisibleClassName,m=a.IconButtonProps,S=m===void 0?{}:m,b=a.onClick,_=Q(a,["children","classes","className","expandIcon","focusVisibleClassName","IconButtonProps","onClick"]),I=n.useContext(be),k=I.disabled,w=k===void 0?!1:k,C=I.expanded,v=I.toggle,D=function(l){v&&v(l),b&&b(l)};return n.createElement(Pe,z({focusRipple:!1,disableRipple:!0,disabled:w,component:"div","aria-expanded":C,className:P(s.root,g,w&&s.disabled,C&&s.expanded),focusVisibleClassName:P(s.focusVisible,s.focused,r),onClick:D,ref:i},_),n.createElement("div",{className:P(s.content,C&&s.expanded)},c),x&&n.createElement(H,z({className:P(s.expandIcon,C&&s.expanded),edge:"end",component:"div",tabIndex:null,role:null,"aria-hidden":!0},S),x))});const ba=O(Ca,{name:"MuiAccordionSummary"})(Sa);var Ia={root:{marginBottom:12}},ka=n.forwardRef(function(a,i){return n.createElement(u,z({component:"p",variant:"body1",color:"textSecondary",ref:i},a))});const le=O(Ia,{name:"MuiDialogContentText"})(ka);var Ie={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=i(Ke);function i(s){return s&&s.__esModule?s:{default:s}}var c=(0,a.default)("M18 16H17.42L16.61 15.19C17.5 14 18 12.5 18 11C18 7.13 14.87 4 11 4C9.5 4 8 4.5 6.79 5.4C3.7 7.72 3.07 12.11 5.39 15.2C7.71 18.29 12.1 18.92 15.19 16.6L16 17.41V18L21 23L23 21L18 16M11 16C8.24 16 6 13.76 6 11S8.24 6 11 6 16 8.24 16 11 13.76 16 11 16M3 6L1 8V1H8L6 3H3V6M21 1V8L19 6V3H16L14 1H21M6 19L8 21H1V14L3 16V19H6Z");t.default=c})(Ie);const wa=ze(Ie),Da=[{label:"Is",value:"equals"},{label:"Contains",value:"contains"}],_a=fe(t=>({root:{width:72},inputRoot:{paddingRight:"0px !important"},clearIndicator:{display:"none"}})),Ta=({tags:t,handleChange:a})=>{const i=_a(),[c,s]=n.useState(""),[g,x]=n.useState([]),[r,m]=n.useState([]),[S,b]=n.useState(""),[_,{loading:I}]=de(Ge),[k,{loading:w}]=de(Ye),C=n.useCallback(async y=>{const{data:d}=await k({variables:{search_keyword:y,ignore_services:!0}});m((d==null?void 0:d.resourceTagValues)||[])},[k]),v=ce(y=>{C(y||"")},500);n.useEffect(()=>{v(S)},[S]);const D=ce(async y=>{const{data:d}=await _({variables:{search_keyword:y,ignore_services:!0}});x((d==null?void 0:d.resourceTagKeys)??[])},500);n.useEffect(()=>{D(c)},[c]);const R=n.useCallback(()=>{a([...t,{key:"",key_operand:q.Equals,value:"",value_operand:q.Equals}]),s(""),b("")},[t,a]),l=n.useCallback(y=>{const d=[...t];d.splice(y,1),a(d)},[t,a]),o=n.useCallback((y,d)=>{const p=[...t];p[d]={...p[d],value_operand:y.value},a(p)},[t,a]),j=n.useCallback((y,d)=>{const p=[...t];p[d]={...p[d],key:y},a(p),s(y)},[t,a]),N=n.useCallback((y,d)=>{const p=[...t];p[d]={...p[d],value:y},a(p),b(y)},[t,a]);return e.jsxs(T,{gap:2,children:[e.jsx(u,{variant:"body2",children:"Resource Tags"}),t.map((y,d)=>e.jsxs(f,{gap:2,children:[e.jsx(me,{style:{flexGrow:1},options:g,value:y.key||"",loading:I,onChange:(p,E)=>j(E,d),onInputChange:(p,E)=>j(E,d),PopperComponent:ue,renderInput:p=>e.jsx(B,{...p,variant:"standard"})}),e.jsx(X,{classes:i,options:Da,value:{value:String(y.value_operand||""),label:y.value_operand===q.Equals?"Is":"Contains"},onChange:(p,E)=>o(E,d),getOptionLabel:p=>p.label,renderInput:p=>e.jsx(B,{...p,variant:"standard"})}),e.jsx(me,{style:{flexGrow:1},value:y.value||"",options:r,loading:w,onChange:(p,E)=>N(E,d),onInputChange:(p,E)=>N(E,d),PopperComponent:ue,renderInput:p=>e.jsx(B,{...p,variant:"standard"})}),e.jsx(Ra,{onClick:()=>l(d),children:e.jsx(U,{fontSize:"small"})})]},d)),e.jsx(f,{children:e.jsx(M,{onClick:R,variant:"text",color:"inherit",startIcon:e.jsx(J,{}),children:"Tags"})})]})},Ra=A(H).withConfig({displayName:"ResourceTagsSelector__RemoveButton",componentId:"sc-1ex17lc-0"})(["margin-left:auto;"]),me=A(X).withConfig({displayName:"ResourceTagsSelector__TagAutocomplete",componentId:"sc-1ex17lc-1"})([".MuiAutocomplete-clearIndicator{display:none;}.MuiInputBase-root{padding-right:0 !important;}.MuiAutocomplete-popupIndicator{display:none;}"]);function $a({onClose:t,service:a,isOpen:i,onTagsChange:c,isEdit:s}){const{description:g,tags:x,name:r}=a||{description:"",tags:[],name:""},[m,S]=n.useState(r),[b,_]=n.useState(g),[I]=Ue(),k=F(),[w,{loading:C}]=ee(We`
      mutation CreateStaticService($input: ServiceInput) {
        createStaticService(input: $input)
      }
    `,{update(o){o.evict({fieldName:"services"})}}),v=async o=>{o.preventDefault();const j={name:m,description:b,tags:x};try{s?await I({variables:{input:{...j,id:a==null?void 0:a.id}}}):await w({variables:{input:j}})}catch(N){k(N.message,"error");return}t(!a)},D=o=>{_(o.target.value)},R=n.useCallback(o=>{S(o.target.value)},[]),l=n.useMemo(()=>(x==null?void 0:x.length)===0||m==="",[x,m]);return e.jsxs(Ma,{open:!!i,style:{marginLeft:"auto",marginRight:"auto"},onClose:()=>t(!1),children:[e.jsxs(f,{children:[e.jsx(ae,{children:`${a?"Edit":"Create"} Specific Service`}),e.jsx(je,{edge:"end",style:{marginLeft:"auto",marginRight:0},color:"inherit",onClick:()=>t(!1),"aria-label":"close",children:e.jsx(te,{})})]}),e.jsxs(ne,{children:[e.jsxs(le,{children:["By ",a?"editing":"creating","a service group, users can efficiently group tags under specific services, allowing them to access real-time data relevant to each service."]}),e.jsxs(T,{gap:2,children:[e.jsxs(T,{gap:1,children:[e.jsx(u,{children:"Service Name"}),e.jsx(B,{placeholder:"Type Service name",style:{width:"100%"},size:"small",value:m,variant:"outlined",onChange:R})]}),e.jsxs(T,{gap:1,children:[e.jsx(u,{children:"Service Description"}),e.jsx(B,{placeholder:"Type Service Description",value:b,style:{width:"100%"},size:"small",variant:"outlined",onChange:D})]}),e.jsx(Ta,{tags:x??[],handleChange:c})]})]}),e.jsx(se,{children:e.jsx(M,{disabled:l,onClick:v,style:{width:"100%"},color:"primary",children:C?e.jsx(K,{size:24,color:"inherit"}):`${s?"Edit Service":"Create Service"}`})})]})}const Ma=A(ie).withConfig({displayName:"CreateServiceModal__CreateServiceDialog",componentId:"sc-14fi8xy-0"})([".MuiPaper-root{width:408px;}"]),Ea=t=>fe(a=>({root:{height:40,maxHeight:40,minHeight:"40px !important","&$expanded":{borderBottom:"1px solid #F0F3F6"},"&:hover":{backgroundColor:a.palette.action.hover},backgroundColor:t.isSelected?a.palette.action.selected:"inherit"},expanded:{}})),Aa=t=>{var w,C;const a=F(),{toggleService:i,editService:c,item:s,isSelected:g}=t,x=Ea(t)(),[r,m]=Oe.useState(!1),[S]=Ce(),b=()=>{m(!r)},_=n.useCallback(v=>{v.stopPropagation(),c(s)},[c,s]),I=n.useCallback(async v=>{v.stopPropagation();try{await S({variables:{input:{service_views:[{id:s.id,type:s.type}]}},update(D){D.evict({fieldName:"services"})}}),a("Service deleted succesfully","success")}catch(D){a(`Service delete error: ${D.message}`,"error")}},[S,s,a]),k=n.useCallback(()=>{i(s)},[i,s]);return e.jsx("div",{children:e.jsxs(Va,{square:!0,expanded:r,onChange:b,children:[e.jsx(ba,{className:x.root,children:e.jsxs(f,{style:{width:"100%"},children:[e.jsxs(f,{gap:1,style:{alignItems:"center",width:"50%",flex:1},children:[e.jsx(Qe,{checked:g,onChange:k,onClick:v=>v.stopPropagation()}),e.jsx(Ze,{detailsOpen:r}),e.jsx(u,{children:s.name}),s.type===He.Dynamic&&e.jsx(pe,{title:"Dynamic Service",children:e.jsx(W,{color:"primary",fontSize:"small"})})]}),e.jsxs(f,{gap:1,style:{alignItems:"center",width:"50%",flex:1},children:[e.jsx(ha,{fontSize:"small",color:"action"}),e.jsx(u,{children:((w=s.tags)==null?void 0:w.length)||0}),e.jsxs(Na,{className:"service-actions",gap:1,expanded:r,children:[e.jsx(M,{variant:"text",onClick:_,startIcon:e.jsx(Xe,{color:"action",fontSize:"small"}),children:e.jsx(u,{variant:"body2",children:"Edit"})}),e.jsx(M,{variant:"text",onClick:I,startIcon:e.jsx(oe,{color:"action",fontSize:"small"}),children:e.jsx(u,{variant:"body2",children:"Delete"})})]})]})]})}),e.jsx(La,{children:e.jsxs(f,{style:{width:"100%"},children:[e.jsxs(T,{gap:1,style:{width:"50%",flex:1,marginRight:26},children:[e.jsx(u,{color:"textSecondary",children:"Description:"}),e.jsx(u,{children:s.description})]}),e.jsx(re,{light:!0,flexItem:!0,orientation:"vertical",variant:"middle"}),e.jsxs(T,{gap:1,style:{width:"50%",flex:1},children:[e.jsx(u,{color:"textSecondary",children:"Tags:"}),(C=s==null?void 0:s.tags)==null?void 0:C.map((v,D)=>{const R=v.value_operand===q.Contains;return e.jsx("div",{style:{display:"inline-flex"},children:e.jsx(pe,{placement:"top",title:R?`Contains "${v.value}"`:v.value||"",children:e.jsx(Je,{style:{borderRadius:6},size:"small",label:`${v.key} : ${R?"*":""}${v.value}${R?"*":""}`})})},D)})]})]})})]})})},Na=A(f).withConfig({displayName:"ServiceItem__ServiceActions",componentId:"sc-1bbseqj-0"})(["margin-left:auto;visibility:",";"],t=>t.expanded?"visible":"hidden"),Va=O({root:{backgroundColor:"transpernt","&:before":{display:"none"},"&$expanded":{margin:"auto"},"&:hover .service-actions":{visibility:"visible"}},expanded:{}})(va),La=O(t=>({root:{padding:t.spacing(2,9)}}))(ja);function Ba({isOpen:t,onClose:a,services:i}){const c=ve(),[s,{loading:g}]=Ce(),x=n.useCallback(async()=>{await s({variables:{input:{service_views:i.map(({name:r,...m})=>m)}}}),c.resetStore(),a()},[i,a,s,c]);return e.jsxs(Pa,{open:t,style:{width:471,marginLeft:"auto",marginRight:"auto"},onClose:a,children:[e.jsx(ae,{children:e.jsxs(f,{gap:1,style:{alignItems:"center"},children:[e.jsx(oe,{color:"action"}),e.jsxs(u,{children:["Delete Service (",i==null?void 0:i.length,")"]})]})}),e.jsx(ne,{children:e.jsx(le,{children:e.jsxs(T,{gap:3,children:[e.jsx(u,{color:"textPrimary",variant:"body2",children:"The following service(s) will be deleted:"}),e.jsx(T,{gap:1,children:i.map(r=>e.jsxs(T,{gap:2,children:[e.jsx(u,{children:r.name},r.id),e.jsx(re,{light:!0})]}))})]})})}),e.jsx(se,{children:e.jsxs(f,{gap:1,children:[e.jsx(M,{variant:"text",onClick:a,children:"Cancel"}),e.jsx(M,{onClick:x,color:"primary",children:g?e.jsx(K,{size:24,color:"inherit"}):"Delete Service"})]})})]})}const Pa=A(ie).withConfig({displayName:"DeleteServiceModal__DeleteServiceDialog",componentId:"sc-10zfn79-0"})([".MuiPaper-root{width:408px;}"]);function za({onClose:t,service:a,isOpen:i}){const[c,{loading:s}]=ea(),[g,x]=n.useState(""),[r,m]=n.useState([]),{data:S,search:b,loading:_}=aa({ignoreServices:!0}),I=ta(),k=F();n.useEffect(()=>{g?I([g]).then(l=>{var o;l.length>0&&m((o=l[0])==null?void 0:o.values.map(j=>({value:j,checked:!1})))}):m([])},[g,I]);const w=async l=>{l.preventDefault();const o={tag_key:g,values:r.filter(({checked:j})=>j).map(({value:j})=>j)};try{const{data:{createDynamicServices:j}={}}=await c({variables:{input:o}});k(`${j==null?void 0:j.count} Service(s) Created Successfully`,"success")}catch(j){k(j.message,"error");return}t()},C=n.useCallback(l=>{x(l)},[]),v=n.useMemo(()=>r.filter(({checked:l})=>l).length,[r]),D=n.useCallback(l=>{m(r.map(o=>o.value===l?{value:l,checked:!o.checked}:o))},[r]),R=n.useCallback(l=>{m(o=>o.map(j=>({...j,checked:l})))},[]);return e.jsxs(ie,{open:!!i,style:{width:471,marginLeft:"auto",marginRight:"auto"},onClose:t,children:[e.jsxs(f,{children:[e.jsx(ae,{children:"Create Services (Bulk)."}),e.jsx(je,{edge:"end",style:{marginLeft:"auto",marginRight:0},color:"inherit",onClick:t,"aria-label":"close",children:e.jsx(te,{})})]}),e.jsxs(ne,{style:{maxHeight:450},children:[e.jsx(le,{children:"The services will be created for each value based on the selected tag"}),e.jsxs(T,{gap:2,children:[e.jsx(X,{style:{flexGrow:1},options:S,value:g,loading:_,onChange:(l,o)=>C(o),onInputChange:(l,o)=>b(o),renderInput:l=>e.jsx(B,{...l,variant:"standard"})}),e.jsxs(T,{children:[g&&e.jsxs(T,{gap:1,children:[e.jsxs(u,{children:[`${r.length}`," values have found attached. select the following values to create service"]}),e.jsxs(f,{style:{justifyContent:"space-between",alignItems:"center"},children:[e.jsx(u,{color:"textSecondary",children:`Selected ${v}/${r.length}`}),e.jsxs(f,{children:[e.jsx(M,{variant:"text",onClick:()=>R(!1),children:"Clear"}),e.jsx(re,{light:!0,orientation:"vertical",flexItem:!0,variant:"middle"}),e.jsx(M,{onClick:()=>R(!0),color:"primary",variant:"text",children:"Select all"})]})]})]}),r.map(l=>e.jsxs(f,{style:{alignItems:"center"},children:[e.jsx(na,{checked:l.checked,onChange:()=>D(l.value)}),e.jsx(u,{children:l.value})]},l.value)),e.jsx(u,{children:"Unselect values will be ignored in future scans"})]})]})]}),e.jsx(se,{children:e.jsx(M,{disabled:!g,onClick:w,style:{width:"100%"},color:"primary",children:s?e.jsx(K,{size:24,color:"inherit"}):"Create Service"})})]})}const Oa=({dynamicKey:t,onDelete:a})=>{const i=sa(),[c]=ee(Z(`
      mutation DeleteDynamicServiceKey($tag_key: String) {
        deleteDynamicServiceKey(tag_key: $tag_key)
      }
    `)),s=n.useCallback(async g=>{await i.confirm({anchorEl:g.currentTarget,title:e.jsxs(f,{gap:1,style:{alignItems:"center"},children:[e.jsx(U,{color:"action"}),e.jsx(u,{children:"Delete Dynamic Service"})]}),inputText:{disabled:!0},text:e.jsxs(T,{gap:2,children:[e.jsx(u,{children:"The following tags will be removed from Dynamic Services and cannot be used to create services automatically:"}),e.jsx(u,{children:`"${t}"`}),e.jsxs(Fa,{gap:1,children:[e.jsx(ia,{color:"action"}),e.jsx(u,{children:"This action will delete all the Services associated with deleted tags"})]})]}),confirmText:"Delete Service",declineText:"Cancel",origin:"bottom"})&&(c({variables:{tag_key:t}}),a(t))},[t,c,a,i]);return e.jsxs(Ha,{children:[e.jsx(u,{children:t}),e.jsx(qa,{onClick:s,children:e.jsx(U,{fontSize:"small"})})]})},Ha=A(f).withConfig({displayName:"DynamicItem__DynamicItemRow",componentId:"sc-d7vezj-0"})(["align-items:center;border-bottom:1px solid ",";padding:","px;"],t=>t.theme.palette.dividerLight,t=>t.theme.spacing(1)),qa=A(H).withConfig({displayName:"DynamicItem__RemoveButton",componentId:"sc-d7vezj-1"})(["margin-left:auto;"]),Fa=A(f).withConfig({displayName:"DynamicItem__WarningMessage",componentId:"sc-d7vezj-2"})(({theme:t})=>({backgroundColor:t.palette.dividerLight,borderRadius:t.spacing(1),padding:t.spacing(1),alignItems:"center"})),Ka=({onClose:t})=>{const a=ve(),[i,{loading:c}]=ee(Z(`
      mutation RefreshDynamicServices {
        refreshDynamicServices
      }
    `)),s=n.useCallback(async()=>{await i(),a.resetStore()},[i,a]);return e.jsxs(Ga,{gap:2,children:[e.jsxs(f,{style:{alignItems:"center"},children:[e.jsx(u,{variant:"h4",children:"Dynamic Services Settings"}),e.jsxs(f,{style:{marginLeft:"auto"},children:[e.jsx(M,{size:"small",variant:"text",onClick:s,startIcon:c?e.jsx(K,{size:20,color:"inherit"}):e.jsx(wa,{fontSize:"small",color:"primary"}),children:e.jsx(u,{color:"primary",children:"Scan"})}),e.jsx(H,{onClick:t,"aria-label":"close",children:e.jsx(te,{})})]})]}),e.jsx(u,{children:"Scan your cloud to find more services according to your dynamic service settings"})]})},Ga=A(T).withConfig({displayName:"SideBarHeader__StyledHeader",componentId:"sc-1dy3elv-0"})(["background-color:",";padding:","px;"],t=>t.theme.palette.type==="dark"?"#232629":"#F0F3F6",t=>t.theme.spacing(3)),Ya=({onClose:t,dynamicKeys:a=[],onDelete:i})=>e.jsxs(Ua,{children:[e.jsx(Ka,{onClose:t}),e.jsx("div",{style:{padding:12},children:a==null?void 0:a.map(c=>e.jsx(Oa,{dynamicKey:c,onDelete:i},c))})]}),Ua=A.div.withConfig({displayName:"DynamicSideBar__SideBarContainer",componentId:"sc-1czz8mi-0"})(["position:fixed;top:116px;right:0;width:430px;height:100%;background-color:",";transition:right 0.3s ease-out;border-left:1px solid ",";"],t=>t.theme.palette.background.paper,t=>t.theme.palette.divider),Wa=A.div.withConfig({displayName:"ServicesPageHeader__Toolbar",componentId:"sc-1vpwc5l-0"})(({theme:t})=>({background:t.palette.background.paper,padding:t.spacing(2),borderBottom:`solid 1px ${t.palette.dividerLight}`})),Qa=A.div.withConfig({displayName:"ServicesPageHeader__InnerContainer",componentId:"sc-1vpwc5l-1"})(({theme:t,padding:a})=>({width:"100%",maxWidth:1550,margin:"0 auto",...a&&{padding:t.spacing(a)}})),Za=t=>{const{onToggleDynamicServices:a,selected:i,handleModalOpen:c,handleDynamicModalOpen:s,onDeleteServices:g,services:x,clearAll:r,handleSearchChange:m,searchValue:S,...b}=t;return e.jsx(Wa,{...b,children:e.jsx(Qa,{children:e.jsxs(f,{style:{alignItems:"center"},children:[e.jsxs(f,{gap:2,style:{alignItems:"center"},children:[e.jsx(u,{variant:"h6",children:`${x==null?void 0:x.length} Services Group`}),(i==null?void 0:i.length)>0&&e.jsxs(e.Fragment,{children:[e.jsx(u,{color:"primary",children:`${i.length} Selected`}),e.jsx(M,{variant:"text",onClick:r,children:"Clear selection"})]})]}),e.jsxs(f,{gap:1,style:{marginLeft:"auto"},children:[e.jsx(B,{placeholder:"Search by Service or tag name",variant:"outlined",value:S,size:"small",style:{width:223},onChange:m,InputProps:{style:{borderRadius:6},startAdornment:e.jsx(la,{fontSize:"small",color:"action"}),endAdornment:e.jsx(oa,{position:"end",children:S&&e.jsx(H,{size:"small",onClick:r,children:e.jsx(ra,{fontSize:"small"})})})}}),e.jsx(M,{variant:"text",onClick:a,startIcon:e.jsx(W,{color:"action",fontSize:"small"}),children:e.jsx(u,{variant:"body2",children:" Dynamic Services"})}),(i==null?void 0:i.length)>0&&e.jsx(M,{variant:"text",onClick:g,startIcon:e.jsx(oe,{color:"action",fontSize:"small"}),children:e.jsx(u,{variant:"body2",children:"Delete"})}),e.jsx(ca,{trigger:e.jsx(M,{variant:"text",startIcon:e.jsx(J,{}),children:"Create Service"}),menu:({handleMenuClose:_,...I})=>e.jsxs(da,{...I,children:[e.jsxs(he,{onClick:c,children:[e.jsx(ge,{children:e.jsx(Se,{})}),e.jsx(xe,{primary:"Create Specific Service"})]}),e.jsxs(he,{onClick:s,children:[e.jsx(ge,{children:e.jsx(W,{fontSize:"small"})}),e.jsx(xe,{primary:"Create bulk of services"})]})]})})]})]})})})};function at(){const t=F(),[a,i]=n.useState(!1),[c,s]=n.useState(!1),[g,x]=n.useState(!1),[r,m]=n.useState([]),[S,b]=n.useState(),[_,I]=n.useState(!1),[k,w]=n.useState([]),[C,v]=n.useState(""),[D,R]=n.useState(!1),l=ua(),{data:{services:o}={}}=qe(Z(`
      query ServicesQuery {
        services {
          id
          name
          description
          type
          tags {
            key
            value
            key_operand
            value_operand
          }
        }
      }
    `)),j=n.useCallback(h=>{v(h.target.value)},[v]),N=n.useMemo(()=>C?o==null?void 0:o.filter(({name:h,tags:$})=>(h==null?void 0:h.toLowerCase().includes(C))||($==null?void 0:$.some(({key:V,value:L})=>(V==null?void 0:V.includes(C))||(L==null?void 0:L.includes(C))))):o,[o,C]),y=()=>{i(!0)},d=()=>{s(!0)},p=h=>{i(!1),b(null),h&&t("Service(s) Created Successfully","success")},E=()=>{x(!1)},G=()=>{s(!1)},Y=n.useCallback(async h=>{x(!0)},[]),ke=n.useCallback(h=>{const $=r==null?void 0:r.findIndex(L=>(L==null?void 0:L.id)===h.id);let V=[...r||[]];$===-1?V.push({id:h.id,type:h.type,name:h.name}):V=V.filter(L=>L.id!==h.id),m(V)},[r]),we=n.useMemo(()=>r==null?void 0:r.filter(({id:h})=>o==null?void 0:o.some($=>($==null?void 0:$.id)===h)),[r,o]),De=n.useCallback(h=>{b(h),y(),R(!0)},[]),_e=n.useCallback(async()=>{const h=await l();w(h),I($=>!$)},[l]),Te=()=>{I(!1)},Re=n.useCallback(()=>{v(""),m([])},[]),$e=n.useCallback(h=>{w($=>$.filter(V=>V!==h))},[]),Me=h=>{b({...S,tags:h})};return e.jsxs(T,{style:{height:"100%",overflow:"unset",display:"relative"},children:[e.jsx(pa,{paper:!0,title:e.jsx(f,{children:e.jsxs(f,{gap:1,style:{alignItems:"center",marginRight:"12px"},children:[e.jsx(Se,{color:"action"}),e.jsx(u,{variant:"h5",children:"Services"})]})})}),e.jsx(Za,{style:{position:"sticky",top:0,zIndex:150},onToggleDynamicServices:_e,selected:we,handleModalOpen:y,handleDynamicModalOpen:d,onDeleteServices:Y,services:o,clearAll:Re,handleSearchChange:j,searchValue:C}),(o==null?void 0:o.length)===0?e.jsx(f,{gap:1,style:{alignItems:"center",justifyContent:"center",height:"100%"},children:e.jsx(M,{variant:"contained",color:"primary",onClick:y,startIcon:e.jsx(J,{fontSize:"small"}),children:"Create New Service"})}):e.jsx("div",{style:{marginTop:30,padding:"0 10%",position:"relative",overflow:"auto",height:"100%"},children:e.jsx(T,{gap:1,children:N==null?void 0:N.map(h=>e.jsx(Aa,{isSelected:!!(r!=null&&r.some(({id:$})=>$===h.id)),toggleService:ke,editService:De,item:h},h.id))})}),a&&e.jsx($a,{service:S,onClose:p,isOpen:a,onTagsChange:Me,isEdit:D}),c&&e.jsx(za,{onClose:G,isOpen:c}),e.jsx(Ba,{services:r,isOpen:g,onClose:E}),e.jsx(ye,{in:_,children:e.jsx(Ya,{onDelete:$e,dynamicKeys:k,onClose:Te})})]})}export{at as ServicesPage,at as default};

import{z as de,r as i,m as Ne,d as I,j as e,I as V,aK as C,R as M,w as ue,p as Re,aL as Oe,aM as $e,V as ne,f as k,q as N,aN as se,aO as re,a as ie,l as Pe,n as U,ap as De,am as Be,F as Fe}from"./index-Ba6YVotX.js";import{a8 as Ve,hl as me,z as R,K as s,hm as pe,d as u,f3 as Me,bg as P,hn as x,p as b,g5 as ge,cZ as he,B as J,T as p,c$ as ae,g8 as We,ho as He,cX as Y,bb as fe,m as X,k as S,i as j,j as $,F as le,y as Le,q as Ue,C as B,S as Ye,n as Je,w as Ge,hp as Ke,hq as Qe,L as ce,hr as Xe,hs as Ze,I as F,ht as xe,ao as W,hu as ye,hv as _e,hw as et,hx as tt,hy as nt,hz as rt,hA as it,R as at,hB as ot,hC as be,bm as st,bN as G,hD as lt,hE as je,hF as Ie,d_ as ct,Z as dt,b as ut,hG as mt,hH as pt,eJ as gt}from"./App-CM6DQiPl.js";const ve=de(i.createElement("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})),ht=de(i.createElement("path",{d:"M10.5 4.5c.28 0 .5.22.5.5v2h6v6h2c.28 0 .5.22.5.5s-.22.5-.5.5h-2v6h-2.12c-.68-1.75-2.39-3-4.38-3s-3.7 1.25-4.38 3H4v-2.12c1.75-.68 3-2.39 3-4.38 0-1.99-1.24-3.7-2.99-4.38L4 7h6V5c0-.28.22-.5.5-.5m0-2C9.12 2.5 8 3.62 8 5H4c-1.1 0-1.99.9-1.99 2v3.8h.29c1.49 0 2.7 1.21 2.7 2.7s-1.21 2.7-2.7 2.7H2V20c0 1.1.9 2 2 2h3.8v-.3c0-1.49 1.21-2.7 2.7-2.7s2.7 1.21 2.7 2.7v.3H17c1.1 0 2-.9 2-2v-4c1.38 0 2.5-1.12 2.5-2.5S20.38 11 19 11V7c0-1.1-.9-2-2-2h-4c0-1.38-1.12-2.5-2.5-2.5z"}));var we={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(Ve);function a(o){return o.__esModule?o:{default:o}}var r=(0,n.default)("M13.2 22V21.7C13.2 20.21 12 19 10.5 19C9 19 7.8 20.21 7.8 21.7V22H4C2.9 22 2 21.11 2 20V16.2H2.3C3.79 16.2 5 15 5 13.5S3.79 10.8 2.3 10.8H2V7C2 5.9 2.9 5 4 5H7.04C7.28 3.3 8.74 2 10.5 2S13.72 3.3 13.96 5H17C18.11 5 19 5.9 19 7V10.04C20.7 10.28 22 11.74 22 13.5C22 13.6 22 13.7 21.97 13.79C21.35 13.44 20.67 13.2 19.93 13.08C19.75 12.46 19.18 12 18.5 12H17V7H12V5.5C12 4.67 11.33 4 10.5 4S9 4.67 9 5.5V7H4V9.12C5.76 9.8 7 11.5 7 13.5S5.75 17.2 4 17.88V20H6.12C6.8 18.25 8.5 17 10.5 17C11.47 17 12.37 17.3 13.12 17.81C13.04 18.19 13 18.59 13 19C13 20.1 13.3 21.12 13.81 22H13.2M18 15V18H15V20H18V23H20V20H23V18H20V15H18Z");t.default=r})(we);const ft=Ne(we),xt=({onClose:t,data:n})=>{const{create:[a,{loading:r}],update:[o,{loading:c}]}=me(),d=r||c,h=I(),m=!!n,y="https://docs.streamsec.io/docs/azure-boards-integration-and-ticketing",{control:l,handleSubmit:f,formState:{isValid:v}}=R({mode:"onBlur",defaultValues:{name:n==null?void 0:n.name,description:n==null?void 0:n.description,access_token:n==null?void 0:n.access_token,organization_name:n==null?void 0:n.organization_name}}),A=f(async({name:w,description:T,access_token:q,organization_name:O})=>{try{m&&(n!=null&&n._id)?await o({variables:{integration_id:n._id,new_fields:{name:w,description:T,access_token:q,organization_name:O}}}):await a({variables:{fields:{name:w,description:T,access_token:q,organization_name:O},integration_type:"azure"}}),h(`operation ${m?"updated":"created"}: `,"success"),t()}catch(H){h(`operation failed: ${H.message}`,"error")}});return e.jsxs(s,{column:!0,fullHeight:!0,style:{minWidth:440},pad:2,gap:2,children:[e.jsxs(s,{row:!0,center:!0,gap:!0,children:[e.jsx(pe,{}),e.jsx(u,{children:"Integrate Azure Boards"}),e.jsx(s,{grow:!0}),e.jsx(V,{onClick:()=>window.open(y,"_blank"),children:e.jsx(Me,{fontSize:"small"})}),e.jsx(V,{onClick:()=>t(),children:e.jsx(P,{fontSize:"small"})})]}),e.jsx(s,{row:!0,center:!0,children:e.jsx(u,{variant:"subtitle2",children:"Create and monitor tickets with Azure Boards Integration."})}),e.jsx("form",{onSubmit:A,children:e.jsxs(s,{column:!0,className:"modal-content",gap:4,children:[e.jsx(x,{name:"name",control:l,label:"Integration Name",rules:{required:"*required"},inputProps:{placeholder:"Integration Name"}}),e.jsx(x,{name:"description",control:l,label:"Description",inputProps:{minRows:5,maxRows:10,multiline:!0,placeholder:"Integration Description"}}),e.jsx(x,{name:"organization_name",control:l,label:"Azure Boards Organization Name",subText:"Your Azure Board Organization Name is part of the organizations URL.",inputProps:{placeholder:"Enter your Azure Board Organization Name"},rules:{required:"*required"}}),e.jsx(x,{name:"access_token",control:l,label:"Personal Access Token",inputProps:{placeholder:"Enter Personal Access Token"},rules:{required:"*required"}})]})}),e.jsxs(s,{row:!0,center:!0,gap:!0,children:[e.jsx(s,{grow:!0}),e.jsx(b,{variant:"text",onClick:()=>t(),children:"Cancel"}),e.jsx(b,{color:"primary",disableElevation:!0,disabled:!v||d,type:"submit",onClick:A,style:{minWidth:"111px"},children:m?"Update":"Integrate"})]})]})},Ce=({onClose:t,onDelete:n,isLoading:a})=>{const r=I(),o=async()=>{try{await n(),r("operation deleted ","success"),t()}catch(c){r(`operation failed: ${c.message}`,"error")}};return e.jsxs(s,{column:!0,gap:3,pad:2,children:[e.jsx(u,{variant:"body2",children:"Continue with this action will remove all data and settings from this account."}),e.jsx(u,{variant:"subtitle1",children:"Would you like to to continue?"}),e.jsx(b,{variant:"outlined",disabled:a,onClick:o,style:{color:"red",border:"1px solid red"},children:"Yes, Remove this integration"}),e.jsx(b,{variant:"text",onClick:t,size:"large",color:"primary",children:e.jsx(u,{variant:"subtitle1",children:"No, Take me back"})})]})},yt=Object.values(C).filter(t=>t!==C.Inspector&&t!==C.StreamSecurity&&t!==C.AzureDefender);function _t(t){const{values:n={},disableType:a=!1,onSubmit:r}=t,o=R({mode:"onChange",values:n}),c=o.watch("type");return e.jsx("form",{id:"wizard-form",autoComplete:"off",noValidate:!0,onSubmit:o.handleSubmit(r),children:e.jsx(We,{...o,children:e.jsxs(s,{column:!0,gap:2,children:[e.jsxs(s,{column:!0,gap:!0,children:[e.jsx(g,{label:"Integration Name",name:"display_name"}),e.jsx(g,{label:"Integration Description",name:"description"})]}),e.jsx(u,{color:"textSecondary",children:"Integrate with one of the following vulnerability scanning services"}),e.jsx(bt,{name:"type",disabled:a,values:yt,renderValue:d=>e.jsxs(s,{row:!0,center:!0,gap:!0,style:{width:"100%"},children:[e.jsx(He,{source:d}),e.jsx(u,{children:Re(d)})]})}),e.jsxs(s,{gap:1,children:[c===C.Snyk&&e.jsxs(s,{column:!0,gap:!0,children:[e.jsx(g,{label:"API Key",name:"api_key"}),e.jsx(g,{label:"Organization ID",name:"organization_id"})]}),c===C.Tenable&&e.jsxs(s,{column:!0,gap:!0,children:[e.jsx(g,{label:"Access Key",name:"access_key"}),e.jsx(g,{label:"Secret Key",name:"secret_key"})]}),c===C.Qualys&&e.jsxs(s,{column:!0,gap:!0,children:[e.jsx(g,{label:"Username",name:"username"}),e.jsx(g,{label:"Password",name:"password",InputProps:{type:"password"}}),e.jsx(g,{label:"Platform",name:"platform",placeholder:"Select a platform",children:Object.values(Oe).map(d=>e.jsx(Y,{value:d,children:d},d))})]}),c===C.Rapid7&&e.jsxs(s,{column:!0,gap:!0,children:[e.jsx(g,{label:"Rapid7 Username",name:"username"}),e.jsx(g,{label:"Rapid7 Password",name:"password",InputProps:{type:"password"}}),e.jsx(g,{label:"Server URL",name:"url"}),e.jsx(g,{label:"Port",name:"port",InputProps:{type:"number"}})]}),c===C.Rapid7Cloud&&e.jsxs(s,{column:!0,gap:!0,children:[e.jsx(g,{label:"API Key",name:"api_key"}),e.jsx(g,{label:"Region",name:"region",placeholder:"Select a region",children:Object.values($e).map(d=>e.jsx(Y,{value:d,children:d},d))})]}),c===C.Oligo&&e.jsxs(s,{column:!0,gap:!0,children:[e.jsx(g,{label:"Client ID",name:"client_id"}),e.jsx(g,{label:"Client Secret",name:"client_secret"})]}),c===C.Spotlight&&e.jsxs(s,{column:!0,gap:!0,children:[e.jsx(g,{label:"Client ID",name:"client_id"}),e.jsx(g,{label:"Client Secret",name:"client_secret"})]})]})]})})})}const bt=M.forwardRef((t,n)=>{const{control:a}=ge();return e.jsx(he,{control:a,name:t.name,render:({field:r})=>e.jsx(s,{column:!0,gap:!0,children:t.values.map(o=>{var c;return e.jsx(J,{size:"small",selected:o===r.value,onClick:()=>r.onChange(o),disabled:t.disabled,children:((c=t.renderValue)==null?void 0:c.call(t,o))||o},o)})})})}),g=M.forwardRef(({label:t,placeholder:n,...a},r)=>{const{control:o}=ge();return e.jsx(he,{control:o,name:a.name,render:({field:c})=>e.jsx(jt,{labelPlacement:"top",label:t,control:e.jsx(p,{variant:"outlined",placeholder:n||t,select:!!a.children,SelectProps:{displayEmpty:!0,renderValue(d){return d||e.jsx(u,{color:"textSecondary",children:n||t})}},fullWidth:!0,...c,...a})})})}),jt=ue(t=>({root:{alignItems:"flex-start",margin:0},label:{marginBottom:t.spacing(1)}}))(ae),It=({setLoading:t,handleNext:n})=>{const a=ne(),r=I();return e.jsx(_t,{onSubmit:async o=>{t(!0),await a.mutate({variables:{input:o},mutation:k(`
              mutation CreateCVEIntegration($input: CVEIntegrationInput) {
                createCVEIntegration(input: $input) {
                  _id
                }
              }
            `),update(c){c.evict({fieldName:"cve_integrations"})}}).then(()=>{n()}).catch(c=>{r(c.message,"error")}).finally(()=>{t(!1)})}})},vt=[{label:"CVE Integration",Component:It,hideSteper:!0,Icon:fe,submitStepText:"Integrate"}],wt=` {{ 
 "payload":{{ "summary": "Event name: {eventName} | User/role: {userIdentity}", 
  "source":"Configuration event on account {account} / {awsRegion}", 
  "severity": "{severity}", 
  "custom_details": {{ "resources": "Resources:  {resources}",  
 "violation": "Violations summary:  {violation_summary}", 
 "rules": "Rules: {rules}", 
  "View Event Details": "{event_link}" 
 }}}}, 
 "routing_key": "PLACEHOLDER", 
 "event_action": "trigger",  
 "client_url":"{event_link}", 
  "client": "StreamSecurity" 
  }} `,Ct='{"Content-Type": "application/json"}',St=X(t=>({container:{display:"flex",flexDirection:"column",width:"100%","& > *:not(:last-child)":{marginBottom:t.spacing(1.5)}},spacer:{marginBottom:"15% !important"},removeButtom:{color:t.palette.common.error,borderColor:t.palette.common.error,fontWeight:600},submitButtons:{display:"flex",justifyContent:"flex-end","& > *:not(:last-child)":{marginRight:t.spacing(1)}}})),kt=({updateStep:t,setLoading:n,handleNext:a})=>{const r=I(),[o,c]=S(""),[d,h]=S(wt),[m,y]=S(Ct),[l,f]=S(!0),[v,A]=S(""),[w,T]=S(""),[q]=i.useState({}),[O]=j($`
      mutation createTorqIntegration(
        $Torq_url: String
        $Torq_json: String
        $app_name: String
        $app_description: String
        $Torq_header: String
        $tls_enabled: Boolean
      ) {
        createTorqIntegration(
          Torq_url: $Torq_url
          Torq_json: $Torq_json
          app_name: $app_name
          app_description: $app_description
          Torq_header: $Torq_header
          tls_enabled: $tls_enabled
        ) {
          _id
          Torq_url
          Torq_json
          app_name
          app_description
          Torq_header
          tls_enabled
        }
      }
    `),H=St(),K=()=>{let z=null;return o||(z={...z,Torq_url:"This is a required field"}),v||(z={...z,app_name:"This is a required field"}),z},ee=async z=>{z.preventDefault();const Q=K();if(Q){q(Q);return}n(!0);try{const{data:_}=await O({variables:{Torq_url:o,Torq_json:d,app_name:v,app_description:w,Torq_header:m,tls_enabled:l}});t({_id:_.createTorqIntegration._id}),a()}catch(_){r(`Torq create failed: ${_.message}`,"error")}n(!1)};return e.jsxs("form",{className:H.container,onSubmit:ee,id:"wizard-form",noValidate:!0,children:[e.jsx("div",{children:e.jsx(u,{variant:"body2",color:"textSecondary",children:"You can configure sending notifications to a Torq whenever it generates a new alert."})}),e.jsx(le,{variant:"outlined",children:e.jsx(p,{id:"Torq-url-input",label:"URL",fullWidth:!0,variant:"outlined",...c,required:!0,inputProps:{maxLength:300}})}),e.jsx(le,{variant:"outlined",children:e.jsx(p,{fullWidth:!0,label:"Name",variant:"outlined",...A,required:!0,inputProps:{maxLength:50}})}),e.jsx(p,{id:"app-description-input",fullWidth:!0,variant:"outlined",label:"Description",...T,required:!0,inputProps:{maxLength:50}}),e.jsx(p,{id:"Torq-json-input",fullWidth:!0,variant:"outlined",label:"Payload JSON",multiline:!0,rowsMax:10,...h,inputProps:{maxLength:3050}}),e.jsx(p,{id:"Torq-header-input",fullWidth:!0,variant:"outlined",label:"Header JSON (Optional)",...y,inputProps:{maxLength:1050}}),e.jsx(ae,{label:"TLS enabled",control:e.jsx(Le,{id:"tls-enabled-input",...f})})]})},Et=X(t=>({container:{display:"flex",flexDirection:"column","& > *:not(:last-child)":{marginBottom:t.spacing(2)}},spacer:{margin:t.spacing(1,0)},testNotification:{display:"flex",justifyContent:"space-between",alignItems:"center"}})),At=({optionalInfo:t,stepsState:n,updateStep:a,handleNext:r,setLoading:o})=>{const{_id:c,notify_settings:d}=t||n,h=I(),m=Et(),y=d||{TYPE_CONFIG:"none","CAT-EVENT_CONFIG":[],EVENT_CONFIG:[],ACCOUNTS_CONFIG:[],TAGS_CONFIG:[],EVENT_SIMULATION:[se.Done,se.Failed]},[l,f]=i.useState(y),[v]=j($`
      mutation updateTorqIntegration($id: ID!, $notify_settings: Object!) {
        updateTorqIntegration(id: $id, notify_settings: $notify_settings) {
          _id
        }
      }
    `),[A,{loading:w,data:T,error:q}]=j($`
      mutation sendTestMessage($id: ID!) {
        testTorq(id: $id)
      }
    `,{onError:()=>{}}),O=()=>{try{A({variables:{id:c}})}catch(_){h(_.message,"error")}},H=async _=>{_.preventDefault();const D={...l};o(!0);try{await v({variables:{id:c,notify_settings:D}})}catch(E){h(`Torq update failed: ${E.message}`,"error")}r()},K=i.useCallback(()=>{n.confirmClose||a({confirmClose:!0})},[a,n.confirmClose]),ee=i.useCallback((_,D)=>{const E={...l};K(),E[_]=D,f(E)},[l,K]),z=i.useCallback((_,D)=>{const E={...l};E[_]=E[_].filter(ze=>ze!==D),f(E)},[l]),Q=i.useCallback(_=>{const D=_.target.value,E={...l,TYPE_CONFIG:D};f(E)},[l]);return c?e.jsxs("form",{className:m.container,id:"wizard-form",noValidate:!0,onSubmit:H,children:[e.jsx(u,{variant:"subtitle2",gutterBottom:!0,children:"Configure Torq Notification"}),e.jsx(u,{variant:"body2",children:"You can choose where and when to receive notification to your Torq (you can change this later from settings):"}),e.jsxs(Ye,{value:(l==null?void 0:l.TYPE_CONFIG)||"events",fullWidth:!0,variant:"outlined",onChange:Q,children:[(l==null?void 0:l.TYPE_CONFIG)==="none"&&e.jsx(Tt,{disabled:!0,value:"none",children:"Click to select notification type"}),e.jsx(Y,{value:"events",children:"Events"}),e.jsx(Y,{value:"simulations",children:"Simulations"})]}),e.jsx(Je,{light:!0,style:{margin:"12px 0"}}),e.jsx(Ge,{in:l.TYPE_CONFIG!=="none",children:e.jsx(Ke,{state:l,handleCategories:ee,handleDelete:z})}),e.jsxs("div",{className:`${m.spacer} ${m.testNotification}`,children:[e.jsx(b,{variant:"text",onClick:O,startIcon:w&&e.jsx(B,{size:20}),disabled:w,children:"Test Connection"}),e.jsxs("div",{children:[q&&e.jsxs(u,{variant:"body2",color:"error",children:["Sending message failed: ",q.message]}),T&&!w&&e.jsx(u,{variant:"body2",color:"secondary",children:"Torq message sent"})]})]})]}):e.jsx(Ue,{children:e.jsx(B,{})})},Tt=N(Y).withConfig({displayName:"TorqEditStep__PlacehollderMenuItem",componentId:"sc-u95in3-0"})(["color:",";"],t=>t.theme.palette.text.secondary);X(t=>({container:{display:"flex",flexDirection:"column","& > *:not(:last-child)":{marginBottom:t.spacing(3)}},removeButtom:{color:t.palette.common.error,borderColor:t.palette.common.error,fontWeight:600,height:44}}));const qt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACzSURBVHgB7ZS9DYMwEIWfHQrSZQRWyAZ4BJpImSYZJU3EGDGZIBtkBUoan/kRSJjGRrKNhPgK64p3etLd8wEHFtgqdfn9QOvcqmMkcBeyLzlCQDyfyjAGM4IbJKvUqSrQ4GLVnVEjFmaK3tUTPuAkpxQlC7sHfEDDauXghcBEThFjL3hB/bAbzJiW1d+lCScqcBNOYzB3oJHBBeXwm0cix1T7vyHmiDhduzezdqXYUQw3pwXr9CCwUzKY3AAAAABJRU5ErkJggg==",zt=t=>e.jsx("img",{...t,src:qt,alt:"Torq Icon"}),Nt=[{label:"Torq Integration",Component:kt,hideSteper:!0,Icon:zt,submitStepText:"Integrate Torq"},{label:"Manage Notifications",Component:At,hideSteper:!0,Icon:Qe,submitStepText:"Save settings"}],Rt=t=>{const[n,a]=S(""),[r,o]=S(""),[c,d]=S(""),[h,m]=S(""),[y,l]=S(""),f={name:n,description:r,cloud_url:c,api_token:h,email:y};return e.jsx(Ot,{variables:f,stepProps:t,id:"wizard-form",noValidate:!0,children:e.jsxs(ce,{gap:2,children:[e.jsx(u,{variant:"body2",color:"textSecondary",children:"Create and monitor Jira Bugs for Violated resources with Jira Integration"}),e.jsxs(ce,{gap:1,children:[e.jsx(L,{label:"Integration Name",controlBinding:a}),e.jsx(L,{label:"Integration Description",controlBinding:o,multiline:!0}),e.jsx(L,{label:"Atlassian Cloud URL",controlBinding:d}),e.jsx(L,{label:"API Creator Email",controlBinding:l}),e.jsx(L,{label:"API Token",controlBinding:m})]})]})})};function Ot({stepProps:{setLoading:t,handleNext:n},variables:a,children:r}){const o=I(),[c]=j($`
      mutation CreateJiraIntegration(
        $fields: IntegrationFields
        $integration_type: String!
      ) {
        ticket_system_create_integration(
          fields: $fields
          integration_type: $integration_type
        ) {
          _id
          name
          description
          cloud_url
          ... on JiraSystemIntegration {
            email
            api_token
          }
        }
      }
    `,{update(d){d.evict({fieldName:"ticket_system_integrations"})}});return e.jsx("form",{onSubmit:async d=>{d.preventDefault(),t(!0);try{await c({variables:{fields:a,integration_type:"jira"}}),n()}catch(h){o(`Jira create failed: ${h.message}`,"error")}t(!1)},id:"wizard-form",noValidate:!0,children:r})}function L({label:t,multiline:n,controlBinding:a}){return e.jsx($t,{labelPlacement:"top",label:t,control:e.jsx(p,{variant:"outlined",placeholder:t,multiline:n,fullWidth:!0,required:!0,...a})})}const $t=ue(t=>({root:{alignItems:"flex-start",margin:0},label:{marginBottom:t.spacing(1)}}))(ae),Pt=t=>e.jsx(Xe,{...t}),Dt=[{label:"Jira Integration",Component:Rt,hideSteper:!0,Icon:Pt,submitStepText:"Integrate"}],Bt=({title:t,titleId:n,...a},r)=>i.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",ref:r,"aria-labelledby":n,...a},t?i.createElement("title",{id:n},t):null,i.createElement("g",{clipPath:"url(#Int_AWS_svg__a)"},i.createElement("path",{fill:"currentColor",d:"M4.509 6.691q-.006.242.058.474.07.198.17.382a.23.23 0 0 1 .037.122.21.21 0 0 1-.1.16l-.335.224a.26.26 0 0 1-.138.048.25.25 0 0 1-.16-.074 1.7 1.7 0 0 1-.192-.25 4 4 0 0 1-.165-.314 1.97 1.97 0 0 1-1.565.734 1.46 1.46 0 0 1-1.064-.383 1.5 1.5 0 0 1 .09-2.118c.368-.292.83-.44 1.3-.416q.284.003.564.043c.2.027.4.07.613.117v-.388c.03-.305-.059-.61-.25-.85a1.22 1.22 0 0 0-.863-.25q-.292 0-.575.07a4 4 0 0 0-.574.18q-.09.04-.187.07a.3.3 0 0 1-.085.015q-.111.002-.112-.165v-.259a.34.34 0 0 1 .037-.187.4.4 0 0 1 .149-.112 3 3 0 0 1 .67-.24c.27-.069.55-.103.829-.1a1.95 1.95 0 0 1 1.394.431 1.76 1.76 0 0 1 .442 1.31v1.723zm-2.16.81q.282-.006.548-.1c.196-.068.37-.186.507-.342a.84.84 0 0 0 .181-.34q.055-.23.053-.464v-.224a5 5 0 0 0-.491-.09 4 4 0 0 0-.5-.032 1.22 1.22 0 0 0-.793.213.76.76 0 0 0 .5 1.373zm4.273.574a.3.3 0 0 1-.2-.053.43.43 0 0 1-.112-.207L5.057 3.7a1 1 0 0 1-.048-.213.117.117 0 0 1 .128-.135h.522a.3.3 0 0 1 .207.053c.054.058.09.13.107.207l.894 3.523.83-3.523a.267.267 0 0 1 .314-.26h.427c.075-.009.15.01.213.052.055.056.09.129.1.207l.841 3.565.921-3.565a.45.45 0 0 1 .107-.207.35.35 0 0 1 .208-.053h.495a.12.12 0 0 1 .133.133.748.748 0 0 1-.048.218l-1.286 4.114a.4.4 0 0 1-.112.207.34.34 0 0 1-.2.053h-.458a.32.32 0 0 1-.213-.053.38.38 0 0 1-.1-.213l-.824-3.432-.82 3.427a.4.4 0 0 1-.1.213.33.33 0 0 1-.213.053zm6.838.144a3.5 3.5 0 0 1-.82-.1 2.4 2.4 0 0 1-.612-.213.4.4 0 0 1-.165-.149.4.4 0 0 1-.032-.149v-.27q.002-.168.122-.166a.3.3 0 0 1 .1.016c.032.011.08.032.133.053q.283.125.585.187.313.063.633.062c.27.016.54-.044.777-.175a.57.57 0 0 0 .277-.507.52.52 0 0 0-.144-.373 1.34 1.34 0 0 0-.537-.277l-.772-.24a1.62 1.62 0 0 1-.851-.543 1.27 1.27 0 0 1-.123-1.363c.095-.17.226-.32.383-.436a1.7 1.7 0 0 1 .554-.273c.218-.062.444-.093.67-.09q.18 0 .357.021c.122.016.234.037.347.058a2 2 0 0 1 .523.185.46.46 0 0 1 .16.133.3.3 0 0 1 .048.175v.25q-.002.169-.122.17a.6.6 0 0 1-.2-.064 2.44 2.44 0 0 0-1.022-.207 1.4 1.4 0 0 0-.708.15.51.51 0 0 0-.25.473.5.5 0 0 0 .16.378 1.6 1.6 0 0 0 .587.293l.756.24c.32.082.609.26.825.511.162.214.249.476.245.745a1.4 1.4 0 0 1-.141.615 1.4 1.4 0 0 1-.389.468c-.176.138-.376.24-.591.3a2.5 2.5 0 0 1-.761.112z"}),i.createElement("path",{fill:"#F90",fillRule:"evenodd",d:"M14.465 10.804a11.47 11.47 0 0 1-6.482 1.98A11.73 11.73 0 0 1 .07 9.767c-.165-.149-.016-.351.18-.234a15.96 15.96 0 0 0 7.919 2.1 15.8 15.8 0 0 0 6.04-1.235c.29-.132.544.193.256.406",clipRule:"evenodd"}),i.createElement("path",{fill:"#F90",fillRule:"evenodd",d:"M15.199 9.97c-.223-.287-1.48-.138-2.05-.069-.17.021-.2-.128-.041-.24a3.16 3.16 0 0 1 2.836-.267 3.12 3.12 0 0 1-.99 2.671c-.144.122-.282.058-.218-.1.208-.522.68-1.709.463-1.995",clipRule:"evenodd"})),i.createElement("defs",null,i.createElement("clipPath",{id:"Int_AWS_svg__a"},i.createElement("rect",{width:16,height:16,fill:"#fff",rx:3})))),Ft=i.forwardRef(Bt),Vt=({title:t,titleId:n,...a},r)=>i.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",ref:r,"aria-labelledby":n,...a},t?i.createElement("title",{id:n},t):null,i.createElement("g",{clipPath:"url(#Int_Azure_svg__a)"},i.createElement("path",{fill:"url(#Int_Azure_svg__b)",d:"M5.334.462h4.735L5.154 15.025a.755.755 0 0 1-.715.513H.754a.754.754 0 0 1-.714-.995L4.619.976a.755.755 0 0 1 .715-.514"}),i.createElement("path",{fill:"#0078D4",d:"M12.214 10.23H4.706a.347.347 0 0 0-.237.602l4.824 4.503c.14.13.326.204.518.203h4.251z"}),i.createElement("path",{fill:"url(#Int_Azure_svg__c)",d:"M5.334.462a.75.75 0 0 0-.717.523L.045 14.531a.753.753 0 0 0 .71 1.007h3.78a.81.81 0 0 0 .62-.527l.912-2.687 3.257 3.037a.77.77 0 0 0 .485.177h4.235l-1.858-5.308H6.771L10.086.463z"}),i.createElement("path",{fill:"url(#Int_Azure_svg__d)",d:"M11.381.975a.75.75 0 0 0-.714-.513H5.39a.75.75 0 0 1 .715.513l4.579 13.568a.754.754 0 0 1-.714.995h5.276a.753.753 0 0 0 .715-.995z"})),i.createElement("defs",null,i.createElement("linearGradient",{id:"Int_Azure_svg__b",x1:7.06,x2:2.143,y1:1.579,y2:16.105,gradientUnits:"userSpaceOnUse"},i.createElement("stop",{stopColor:"#114A8B"}),i.createElement("stop",{offset:1,stopColor:"#0669BC"})),i.createElement("linearGradient",{id:"Int_Azure_svg__c",x1:8.595,x2:7.458,y1:8.349,y2:8.733,gradientUnits:"userSpaceOnUse"},i.createElement("stop",{stopOpacity:.3}),i.createElement("stop",{offset:.071,stopOpacity:.2}),i.createElement("stop",{offset:.321,stopOpacity:.1}),i.createElement("stop",{offset:.623,stopOpacity:.05}),i.createElement("stop",{offset:1,stopOpacity:0})),i.createElement("linearGradient",{id:"Int_Azure_svg__d",x1:7.97,x2:13.367,y1:1.155,y2:15.535,gradientUnits:"userSpaceOnUse"},i.createElement("stop",{stopColor:"#3CCBF4"}),i.createElement("stop",{offset:1,stopColor:"#2892DF"})),i.createElement("clipPath",{id:"Int_Azure_svg__a"},i.createElement("path",{fill:"#fff",d:"M0 0h16v16H0z"})))),Mt=i.forwardRef(Vt),Wt=({title:t,titleId:n,...a},r)=>i.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"xMidYMid",viewBox:"0 0 256 206",ref:r,"aria-labelledby":n,...a},t?i.createElement("title",{id:n},t):null,i.createElement("path",{fill:"#ea4335",d:"m170.252 56.819 22.253-22.253 1.483-9.37C153.437-11.677 88.976-7.496 52.42 33.92 42.267 45.423 34.734 59.764 30.717 74.573l7.97-1.123 44.505-7.34 3.436-3.513c19.797-21.742 53.27-24.667 76.128-6.168z"}),i.createElement("path",{fill:"#4285f4",d:"M224.205 73.918a100.25 100.25 0 0 0-30.217-48.722l-31.232 31.232a55.52 55.52 0 0 1 20.379 44.037v5.544c15.35 0 27.797 12.445 27.797 27.796 0 15.352-12.446 27.485-27.797 27.485h-55.671l-5.466 5.934v33.34l5.466 5.231h55.67c39.93.311 72.553-31.494 72.864-71.424a72.3 72.3 0 0 0-31.793-60.453"}),i.createElement("path",{fill:"#34a853",d:"M71.87 205.796h55.593V161.29H71.87a27.3 27.3 0 0 1-11.399-2.498l-7.887 2.42-22.409 22.253-1.952 7.574c12.567 9.489 27.9 14.825 43.647 14.757"}),i.createElement("path",{fill:"#fbbc05",d:"M71.87 61.426C31.94 61.663-.237 94.227.001 134.158a72.3 72.3 0 0 0 28.222 56.88l32.248-32.247c-13.99-6.32-20.208-22.786-13.887-36.776s22.786-20.207 36.775-13.887a27.8 27.8 0 0 1 13.887 13.887l32.248-32.247A72.22 72.22 0 0 0 71.87 61.425"})),Ht=i.forwardRef(Wt),Lt=({title:t,titleId:n,...a},r)=>i.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",ref:r,"aria-labelledby":n,...a},t?i.createElement("title",{id:n},t):null,i.createElement("g",{clipPath:"url(#Int_Slack_svg__a)"},i.createElement("path",{fill:"#E01E5A",d:"M3.362 10.111a1.68 1.68 0 1 1-1.681-1.68h1.68zM4.209 10.111a1.68 1.68 0 1 1 3.361 0v4.208a1.68 1.68 0 1 1-3.362 0z"}),i.createElement("path",{fill:"#36C5F0",d:"M5.89 3.362A1.68 1.68 0 1 1 7.57 1.68v1.68zM5.89 4.209a1.68 1.68 0 1 1 0 3.361H1.68a1.68 1.68 0 1 1 0-3.362z"}),i.createElement("path",{fill:"#2EB67D",d:"M12.638 5.89a1.68 1.68 0 1 1 1.681 1.68h-1.68zM11.792 5.89a1.68 1.68 0 0 1-3.362 0V1.68a1.68 1.68 0 1 1 3.361 0z"}),i.createElement("path",{fill:"#ECB22E",d:"M10.11 12.639a1.68 1.68 0 1 1-1.68 1.68v-1.68zM10.11 11.792a1.68 1.68 0 1 1 0-3.362h4.21a1.68 1.68 0 1 1 0 3.362z"})),i.createElement("defs",null,i.createElement("clipPath",{id:"Int_Slack_svg__a"},i.createElement("path",{fill:"#fff",d:"M0 0h16v16H0z"})))),Ut=i.forwardRef(Lt),Yt=({title:t,titleId:n,...a},r)=>i.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",ref:r,"aria-labelledby":n,...a},t?i.createElement("title",{id:n},t):null,i.createElement("g",{clipPath:"url(#Int_Webhook_svg__a)"},i.createElement("path",{fill:"#C73A63",d:"M7.471 6.308c-.663 1.12-1.298 2.203-1.947 3.279-.166.276-.249.501-.116.852.368.97-.15 1.914-1.124 2.17-.919.242-1.814-.364-1.996-1.352-.162-.874.514-1.73 1.474-1.867.08-.012.162-.013.297-.024l1.46-2.458c-.918-.917-1.465-1.988-1.344-3.316.086-.939.453-1.75 1.125-2.415a3.81 3.81 0 0 1 4.766-.502c1.455.939 2.121 2.767 1.553 4.332l-1.334-.363c.179-.87.047-1.652-.538-2.321-.386-.442-.881-.674-1.445-.76-1.13-.17-2.238.558-2.567 1.671-.374 1.264.192 2.296 1.736 3.074"}),i.createElement("path",{fill:"#4B4B4B",d:"m9.365 4.984 1.412 2.5c2.376-.738 4.168.583 4.81 1.997.777 1.708.246 3.731-1.279 4.785-1.565 1.082-3.544.897-4.93-.492l1.088-.915c1.369.891 2.567.85 3.456-.206a2.4 2.4 0 0 0-.038-3.122c-.9-1.016-2.107-1.047-3.565-.072-.605-1.077-1.22-2.146-1.806-3.231-.197-.366-.415-.578-.86-.656-.744-.13-1.224-.77-1.252-1.488A1.64 1.64 0 0 1 7.44 2.48a1.62 1.62 0 0 1 1.835.503c.355.45.468.957.281 1.512-.052.155-.12.304-.192.488"}),i.createElement("path",{fill:"#4A4A4A",d:"M10.482 11.75H7.62c-.274 1.132-.866 2.046-1.887 2.628a3.8 3.8 0 0 1-2.558.457C1.5 14.564.13 13.05.01 11.344c-.137-1.932 1.186-3.65 2.948-4.035l.367 1.334c-1.618.829-2.177 1.873-1.725 3.178C2 12.97 3.13 13.6 4.36 13.356c1.254-.249 1.887-1.296 1.81-2.977 1.19 0 2.38-.012 3.57.006.465.008.824-.04 1.174-.452.576-.677 1.637-.616 2.257.023a1.63 1.63 0 0 1-.067 2.33 1.613 1.613 0 0 1-2.277-.079c-.124-.134-.222-.293-.345-.458"})),i.createElement("defs",null,i.createElement("clipPath",{id:"Int_Webhook_svg__a"},i.createElement("path",{fill:"#fff",d:"M0 0h16v15H0z"})))),Jt=i.forwardRef(Yt),Gt=({title:t,titleId:n,...a},r)=>i.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",ref:r,"aria-labelledby":n,...a},t?i.createElement("title",{id:n},t):null,i.createElement("path",{fill:"#00A6C1",d:"M2 6.313h12.322v2.738H2zM2 10.762h6.845V13.5H3a1 1 0 0 1-1-1zM14.322 4.738H7.476V2h5.846a1 1 0 0 1 1 1z"})),Kt=i.forwardRef(Gt),Qt=({title:t,titleId:n,...a},r)=>i.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:17,height:17,fill:"none",ref:r,"aria-labelledby":n,...a},t?i.createElement("title",{id:n},t):null,i.createElement("g",{clipPath:"url(#Int_Jira_svg__a)"},i.createElement("path",{fill:"#0052CC",d:"M8.458 7.803H.744a3.48 3.48 0 0 0 3.488 3.476h1.42v1.372a3.477 3.477 0 0 0 3.475 3.476V8.473a.67.67 0 0 0-.67-.67zm3.816-3.838H4.568a3.477 3.477 0 0 0 3.477 3.476h1.42v1.372a3.48 3.48 0 0 0 3.476 3.476V4.633a.667.667 0 0 0-.668-.668M16.086.127H8.381a3.477 3.477 0 0 0 3.476 3.477h1.42v1.371a3.477 3.477 0 0 0 3.467 3.474V.797a.667.667 0 0 0-.658-.67"})),i.createElement("defs",null,i.createElement("clipPath",{id:"Int_Jira_svg__a"},i.createElement("path",{fill:"#fff",d:"M.744.127h16v16h-16z"})))),Xt=i.forwardRef(Qt),Zt=({title:t,titleId:n,...a},r)=>i.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",ref:r,"aria-labelledby":n,...a},t?i.createElement("title",{id:n},t):null,i.createElement("rect",{width:16,height:16,fill:"currentColor",rx:3}),i.createElement("path",{fill:"#6F6",d:"M3.79 5.013a1.238 1.238 0 0 0-.048 2.476 1.237 1.237 0 0 0 1.282-1.238v-.458c0-.434.345-.78.777-.78h.441c.673 0 1.234-.53 1.25-1.197.024-.7-.537-1.27-1.226-1.278-.69-.008-1.242.57-1.242 1.262v.514c0 .386-.313.7-.697.7zM5.024 9.748c0-.7-.577-1.262-1.283-1.238a1.238 1.238 0 0 0 .048 2.476h.457c.433 0 .778.345.778.78v.442c0 .675.529 1.237 1.194 1.254a1.24 1.24 0 0 0 1.274-1.23c.008-.691-.569-1.246-1.258-1.246H5.72a.7.7 0 0 1-.697-.7z"}),i.createElement("path",{fill:"#6F6",d:"M7.131 11.348a1.23 1.23 0 0 0-1.779.032 1.25 1.25 0 0 0 0 1.68c.481.514 1.282.53 1.78.032l.32-.321a.77.77 0 0 1 1.098 0l.312.313a1.246 1.246 0 0 0 1.731.04c.505-.482.521-1.278.032-1.768a1.24 1.24 0 0 0-1.763.008l-.36.362a.695.695 0 0 1-.986 0z"}),i.createElement("path",{fill:"#6F6",d:"M9.744 10.986a1.238 1.238 0 0 0-.048 2.476 1.237 1.237 0 0 0 1.282-1.238v-.458c0-.434.345-.78.777-.78h.441c.673 0 1.234-.53 1.25-1.198.024-.699-.537-1.27-1.226-1.278s-1.242.571-1.242 1.262v.515c0 .386-.312.7-.697.7zM2.916 8.88a1.24 1.24 0 0 0 .032 1.785 1.24 1.24 0 0 0 1.675 0 1.24 1.24 0 0 0 .032-1.785l-.32-.321a.78.78 0 0 1 0-1.102l.312-.313a1.256 1.256 0 0 0 .04-1.736 1.227 1.227 0 0 0-1.763-.033 1.25 1.25 0 0 0 .008 1.769l.36.362a.7.7 0 0 1 0 .988z"}),i.createElement("path",{fill:"#6F6",d:"M11.338 8.88a1.24 1.24 0 0 0 .032 1.785 1.24 1.24 0 0 0 1.675 0 1.24 1.24 0 0 0 .032-1.785l-.32-.321a.78.78 0 0 1 0-1.102l.312-.313a1.256 1.256 0 0 0 .04-1.736 1.227 1.227 0 0 0-1.763-.033 1.25 1.25 0 0 0 .008 1.769l.36.362a.7.7 0 0 1 0 .988zM9.744 5.014c.681 0 1.234-.554 1.234-1.238s-.553-1.238-1.234-1.238c-.682 0-1.234.554-1.234 1.238s.552 1.238 1.234 1.238"})),en=i.forwardRef(Zt);function tn({onClose:t}){const n=I(),[a,{loading:r}]=nn(),o=R();return e.jsxs(s,{column:!0,pad:2,gap:2,style:{minWidth:300},children:[e.jsxs(s,{row:!0,center:!0,gap:!0,children:[e.jsx("img",{src:Ze,alt:"Cyera logo",width:20,height:20}),e.jsx(u,{variant:"subtitle1",children:"Cyera"}),e.jsx(s,{grow:!0}),e.jsx(F,{size:"small",onClick:t,children:e.jsx(P,{fontSize:"small"})})]}),e.jsx(p,{fullWidth:!0,variant:"outlined",label:"Display Name",disabled:r,...o.register("display_name",{required:!0})}),e.jsx(p,{fullWidth:!0,variant:"outlined",label:"Description (optional)",disabled:r,...o.register("description")}),e.jsx(p,{fullWidth:!0,variant:"outlined",label:"Client ID",disabled:r,...o.register("client_id",{required:!0})}),e.jsx(p,{fullWidth:!0,variant:"outlined",label:"Secret Key",disabled:r,...o.register("secret_key",{required:!0})}),e.jsxs(s,{row:!0,children:[e.jsx(s,{grow:!0}),e.jsx(J,{startIcon:r&&e.jsx(B,{size:15}),disabled:r||!o.formState.isValid,color:"primary",onClick:async()=>{try{await a({variables:{input:o.getValues()}}),n("Cyera integration successfully created","success"),t()}catch(c){console.error(c),n(`Cyera integration failed to create: ${c.message}`,"error")}},children:"Integrate"})]})]})}function nn(){return j(k(`
    mutation CreateDPIntegration($input: DPIntegrationInput) {
      createDPIntegration(input: $input, type: Cyera) {
        _id
      }
    }
  `),{update(t){t.evict({fieldName:"dp_integrations"})}})}function oe({type:t}){return j(k(`
      mutation CreateEDRIntegration($input: EDRIntegrationInput, $type: EDRIntegrationType) {
        createEDRIntegration(input: $input, type: $type) {
          _id
        }
      }
    `),{variables:{type:t},update(n){n.evict({fieldName:"edr_integrations"})}})}function rn({onClose:t}){const n=I(),[a,{loading:r}]=oe({type:re.Crowdstrike}),o=R();return e.jsxs(s,{column:!0,pad:2,gap:2,style:{minWidth:300},children:[e.jsxs(s,{row:!0,center:!0,gap:!0,children:[e.jsx(xe,{style:{width:"20px",height:"20px"}}),e.jsx(u,{variant:"subtitle1",children:"CrowdStrike"}),e.jsx(s,{grow:!0}),e.jsx(F,{size:"small",onClick:()=>window.open("https://docs.streamsec.io/docs/crowdstrike-edr","_blank"),children:e.jsx(W,{fontSize:"small"})}),e.jsx(F,{size:"small",onClick:t,children:e.jsx(P,{fontSize:"small"})})]}),e.jsx(p,{fullWidth:!0,variant:"outlined",label:"Display Name",disabled:r,...o.register("display_name",{required:!0})}),e.jsx(p,{fullWidth:!0,variant:"outlined",label:"Description (optional)",disabled:r,...o.register("description")}),e.jsx(p,{fullWidth:!0,variant:"outlined",label:"Client ID",disabled:r,...o.register("client_id",{required:!0})}),e.jsx(p,{fullWidth:!0,variant:"outlined",label:"Secret Key",disabled:r,...o.register("client_secret",{required:!0})}),e.jsxs(s,{row:!0,children:[e.jsx(s,{grow:!0}),e.jsx(J,{startIcon:r&&e.jsx(B,{size:15}),disabled:r||!o.formState.isValid,color:"primary",onClick:async()=>{try{await a({variables:{input:o.getValues()}}),n("CrowdStrike integration successfully created","success"),t()}catch(c){n(`CrowdStrike integration failed to create: ${c.message}`,"error")}},children:"Integrate"})]})]})}function an({onClose:t}){const n=I(),[a,{loading:r}]=oe({type:re.SentinelOne}),o=R();return e.jsxs(s,{column:!0,pad:2,gap:2,style:{minWidth:300},children:[e.jsxs(s,{row:!0,center:!0,gap:!0,children:[e.jsx(ye,{}),e.jsx(u,{variant:"subtitle1",children:"SentinelOne"}),e.jsx(s,{grow:!0}),e.jsx(F,{size:"small",onClick:()=>window.open("https://docs.streamsec.io/docs/sentinelone-edr-integration","_blank"),children:e.jsx(W,{fontSize:"small"})}),e.jsx(F,{size:"small",onClick:t,children:e.jsx(P,{fontSize:"small"})})]}),e.jsx(u,{children:"To configure the SentinelOne integration, first generate an API token in your SentinelOne management console. This token allows Stream Security to access and synchronize data from your SentinelOne environment."}),e.jsx(u,{variant:"subtitle2",children:"Integration Display Name"}),e.jsx(p,{fullWidth:!0,variant:"outlined",placeholder:"e.g., My SentielOne Integration",disabled:r,...o.register("display_name",{required:!0})}),e.jsx(u,{variant:"subtitle2",children:"Integration Description (Optional)"}),e.jsx(p,{fullWidth:!0,variant:"outlined",placeholder:"Describe the purpose of this integration",disabled:r,...o.register("description")}),e.jsx(u,{variant:"subtitle2",children:"Domain URL"}),e.jsx(p,{fullWidth:!0,variant:"outlined",placeholder:"e.g., https://usea1-org.sentinelone.net/",disabled:r,...o.register("platform_url",{required:!0})}),e.jsx(u,{variant:"subtitle2",children:"SentinelOne Token"}),e.jsx(p,{fullWidth:!0,variant:"outlined",placeholder:"Paste your SentielOne token here",disabled:r,...o.register("access_token",{required:!0})}),e.jsxs(s,{row:!0,children:[e.jsx(s,{grow:!0}),e.jsx(J,{startIcon:r&&e.jsx(B,{size:15}),disabled:r||!o.formState.isValid,color:"primary",onClick:async()=>{try{await a({variables:{input:o.getValues()}}),n("SentinelOne integration successfully created","success"),t()}catch(c){n(`SentinelOne integration failed to create: ${c.message}`,"error")}},children:"Integrate"})]})]})}function on({onClose:t}){const n=I(),[a,{loading:r}]=oe({type:re.Cortex}),o=R();return e.jsxs(s,{column:!0,pad:2,gap:2,style:{minWidth:300},children:[e.jsxs(s,{row:!0,center:!0,gap:!0,children:[e.jsx(_e,{style:{width:"20px",height:"20px"}}),e.jsx(u,{variant:"subtitle1",children:"Cortex"}),e.jsx(s,{grow:!0}),e.jsx(F,{size:"small",onClick:()=>window.open("https://docs.streamsec.io/docs/cortex-xdr-xsiam-integration","_blank"),children:e.jsx(W,{fontSize:"small"})}),e.jsx(F,{size:"small",onClick:t,children:e.jsx(P,{fontSize:"small"})})]}),e.jsx(u,{children:"To configure the Cortex XDR / XSIAM integration, first generate an API token in your Cortex XDR / XSIAM management console. This token allows Stream Security to access and synchronize data from your Cortex XDR environment."}),e.jsx(u,{variant:"subtitle2",children:"Display Name"}),e.jsx(p,{fullWidth:!0,variant:"outlined",placeholder:"e.g., My Cortex XDR / XSIAM Integration",disabled:r,...o.register("display_name",{required:!0})}),e.jsx(u,{variant:"subtitle2",children:"Description (Optional)"}),e.jsx(p,{fullWidth:!0,variant:"outlined",placeholder:"Describe the purpose of this integration",disabled:r,...o.register("description")}),e.jsx(u,{variant:"subtitle2",children:"API Key"}),e.jsx(p,{fullWidth:!0,variant:"outlined",placeholder:"Paste your Cortex API Key here",disabled:r,...o.register("api_key",{required:!0})}),e.jsx(u,{variant:"subtitle2",children:"API Key ID"}),e.jsx(p,{fullWidth:!0,variant:"outlined",placeholder:"Paste your Cortex API Key ID here",disabled:r,...o.register("api_key_id",{required:!0})}),e.jsx(u,{variant:"subtitle2",children:"API Base URL"}),e.jsx(p,{fullWidth:!0,variant:"outlined",placeholder:"e.g., https://api-<tenant>.xdr.<region>.paloaltonetworks.com",disabled:r,...o.register("platform_url",{required:!0})}),e.jsxs(s,{row:!0,children:[e.jsx(s,{grow:!0}),e.jsx(J,{startIcon:r&&e.jsx(B,{size:15}),disabled:r||!o.formState.isValid,color:"primary",onClick:async()=>{try{await a({variables:{input:o.getValues()}}),n("Cortex integration successfully created","success"),t()}catch(c){n(`Cortex integration failed to create: ${c.message}`,"error")}},children:"Integrate"})]})]})}const sn="addIntegrationAWS-button",ln="addIntegrationAzure-button",Se="addIntegrationJira-button",cn=[{id:sn,title:"Amazon Web Services",subTitle:"Cloud computing service created by Amazon",img:Ft,steps:et},{id:ln,title:"Azure",subTitle:"Cloud computing service created by Microsoft",img:Mt,steps:tt},{title:"Google Cloud Platform",subTitle:"Cloud computing service created by Google",img:Ht,Form:nt,dialogProps:{fullWidth:!0,size:"md"}},{id:"addIntegrationSlack-button",title:"Slack",subTitle:"Integrate Slack to recieve notifications",img:Ut,steps:rt},{id:"addIntegrationWebhook-button",title:"Webhook",subTitle:"Integrate Webhook to recieve notifications",img:Jt,steps:it},{id:"addIntegratioTorq-button",title:"Torq",subTitle:"Automatic Exposure and Threat Response",img:Kt,steps:Nt},{id:"addIntegrationCVE-button",title:"Vulnerabilities",subTitle:"Integrate with vulnerabilities scanner",icon:e.jsx(fe,{style:{fontSize:16}}),steps:vt},{id:Se,title:"Jira",subTitle:"Integrate Jira to create and monitor stories bugs",img:Xt,steps:Dt},{id:"addIntegrationEKSAuditLogs-button",title:"EKS Audit Logs",subTitle:"Integrate EKS audit logs",icon:e.jsx(at,{type:"eks",size:16}),steps:ot},{title:"Cyera",subTitle:"Enrich detections with data classifications",img:en,Form:tn},{title:"CrowdStrike",subTitle:"Enrich investigation with workload detections",img:xe,Form:rn},{title:"SentielOne",subTitle:"Enrich investigation with workload detections",img:ye,Form:an},{title:"Cortex",subTitle:"Enrich investigation with workload detections",img:_e,Form:on}],Rn=t=>{var r;const{data:n,...a}=ie($(`
      query OktaQuery($filters: Object) {
        list_idp_integrations(filters: $filters) {
            results {
              id
              domain
              api_key
              display_name
              status
            }
          }
      }
    `),{variables:{filters:{integration_id:t}}});return{...a,integrations:(r=n==null?void 0:n.list_idp_integrations)==null?void 0:r.results}},dn=$(`
  mutation UpdateOktaIntegration(
    $idp_integration_id: String!
    $api_key: String
    $display_name: String
  ) {
    modify_okta_integration(
      idp_integration_id: $idp_integration_id
      api_key: $api_key
      display_name: $display_name
    ) {
      id
      domain
      api_key
      display_name
    }
  }
`),un=$(`
  mutation CreateOktaIntegration(
   $domain: String!
   $api_key: String!
   $display_name: String!
  ) {
    create_okta_integration(
        domain: $domain
        api_key: $api_key
        display_name: $display_name
    ) {
      id
      domain
      api_key
      display_name
    }
  }
`),mn=$(`
  mutation DeleteOktaIntegration($idp_integration_id: String!) {
    delete_idp_integration(idp_integration_id: $idp_integration_id)
  }
`),te={update(t){t.evict({fieldName:"list_idp_integrations"})}},ke=()=>({create:j(un,te),update:j(dn,te),delete:j(mn,te)}),pn=({onClose:t,data:n})=>{const{create:[a,{loading:r}],update:[o,{loading:c}]}=ke(),d=r||c,h=I(),m=!!n,y="https://docs.streamsec.io/docs/okta-integration",{control:l,handleSubmit:f,formState:{isValid:v}}=R({mode:"onBlur",defaultValues:{display_name:n==null?void 0:n.display_name,api_key:n==null?void 0:n.api_key,domain:n==null?void 0:n.domain}}),A=f(async({display_name:w,api_key:T,domain:q})=>{try{m?await o({variables:{idp_integration_id:n==null?void 0:n.id,display_name:w,api_key:T}}):await a({variables:{display_name:w,api_key:T,domain:q}}),h(`operation ${m?"updated":"created"}: `,"success"),t()}catch(O){h(`operation failed: ${O.message}`,"error")}});return e.jsxs(s,{column:!0,fullHeight:!0,style:{minWidth:440},pad:2,gap:2,children:[e.jsxs(s,{row:!0,center:!0,gap:!0,children:[e.jsx(be,{}),e.jsx(u,{children:"Add Okta Integration"}),e.jsx(s,{grow:!0}),e.jsx(V,{onClick:()=>t(),children:e.jsx(P,{})})]}),e.jsx(s,{row:!0,center:!0,children:e.jsx(u,{variant:"subtitle2",children:"To configure Okta integration, first generate an API token in your Okta organization settings. Stream Security will use this token to access your Okta resources."})}),e.jsxs("form",{onSubmit:A,children:[e.jsxs(s,{column:!0,className:"modal-content",gap:4,children:[e.jsx(x,{name:"display_name",control:l,label:"Integration Display Name",rules:{required:"*required"},inputProps:{placeholder:"Integration Name"}}),e.jsx(x,{name:"api_key",control:l,label:"Okta Token",inputProps:{placeholder:"-"},rules:{required:"*required"}}),e.jsx(x,{name:"domain",control:l,label:"Domain URL",inputProps:{placeholder:"-"},disabled:m,rules:{required:"*required"}})]}),e.jsx(b,{variant:"text",color:"primary",startIcon:e.jsx(W,{color:"action"}),endIcon:e.jsx(st,{fontSize:"small",style:{fontSize:12}}),onClick:()=>window.open(y,"_blank"),children:"Learn more about Okta integration"}),e.jsxs(s,{row:!0,center:!0,gap:!0,children:[e.jsx(s,{grow:!0}),e.jsx(b,{variant:"text",onClick:()=>t(),children:"Cancel"}),e.jsx(b,{color:"primary",disableElevation:!0,disabled:!v||d,type:"submit",onClick:A,style:{minWidth:"111px"},children:m?"Update":"Integrate"})]})]})]})},gn=({onClose:t})=>{const{start:n}=hn(),a=M.useCallback(()=>{n({}),t()},[t,n]);return e.jsx(Z,{onClick:a,title:"Okta",subTitle:"Track, manage, and secure your Okta identities",Icon:e.jsx(be,{style:{fontSize:16}})})};function hn(){const t=G(),{delete:[n,{loading:a}]}=ke();return{start:i.useCallback(r=>{t.open(o=>e.jsx(pn,{data:r,...o}),{fullWidth:!1})},[t]),remove:i.useCallback(r=>t.open(o=>e.jsx(Ce,{onClose:o.onClose,onDelete:()=>n({variables:{idp_integration_id:r}}),isLoading:a}),{fullWidth:!1}),[t,n,a])}}function fn({onClose:t,id:n}){const a=ne(),r=I(),[o,{loading:c}]=j(k(`
    mutation YouTrackIntegrationCreate($fields: IntegrationFields) {
      ticket_system_create_integration(integration_type: "youtrack", fields: $fields) {
        _id
      }
    } 
  `),{onCompleted(){r("Integration created successfully","success"),t()},onError(l){r((l==null?void 0:l.message)||"Integration create error","error")},update(l){l.evict({fieldName:"ticket_system_integrations"})}}),[d,{loading:h}]=j(k(`
    mutation YouTrackIntegrationUpdate($id: ID!, $fields: IntegrationFields) {
      ticket_system_update_integration(integration_id: $id, new_fields: $fields) {
        _id
      }
    } 
  `),{onCompleted(){r("Integration updated successfully","success"),t()},onError(l){r((l==null?void 0:l.message)||"Integration update error","error")},update(l){l.evict({fieldName:"ticket_system_integrations"})}}),{control:m,getValues:y}=R({async defaultValues(){var f;const{data:l}=await a.query({query:k(`
          query YouTrackIntegration {
            ticket_system_integrations(filters: { integration_type: "youtrack" }) {
              _id
              name
              description
              cloud_url
              ... on YoutrackSystemIntegration {
                api_token
              }
            }
          }  
        `)});return lt((f=l==null?void 0:l.ticket_system_integrations)==null?void 0:f.find(v=>v._id===n),["_id","integration_type"])}});return e.jsxs(s,{column:!0,fullHeight:!0,style:{minWidth:440},pad:2,gap:2,children:[e.jsxs(s,{row:!0,center:!0,gap:!0,children:[e.jsx(je,{}),e.jsx(u,{children:"Add JetBrains YouTrack Integration"}),e.jsx(s,{grow:!0}),e.jsx(V,{onClick:()=>t(),children:e.jsx(P,{fontSize:"small"})})]}),e.jsx(s,{row:!0,center:!0,children:e.jsx(u,{variant:"subtitle2",children:"To configure the JetBrains YouTrack integration, first generate an API token in your YouTrack organization settings. This will allow Stream Security to access your YouTrack resources."})}),e.jsxs(s,{column:!0,className:"modal-content",gap:2,children:[e.jsx(x,{name:"name",control:m,label:"Integration Display Name",rules:{required:"*required"},inputProps:{placeholder:"e.g., YouTrack Incident Tracker"}}),e.jsx(x,{name:"description",control:m,label:"Integration Description",inputProps:{maxRows:10,multiline:!0,placeholder:"Optional: describe the purpose of this integration"}}),e.jsx(x,{name:"cloud_url",control:m,label:"YouTrack Service URL",inputProps:{placeholder:"e.g., https://yourcompany.youtrack.cloud"},rules:{required:"*required"}}),e.jsx(x,{name:"api_token",control:m,label:"Permanent Token",inputProps:{placeholder:"Paste your YouTrack API token here"},rules:{required:"*required"}}),e.jsxs(s,{row:!0,center:!0,gap:!0,children:[e.jsx(W,{fontSize:"small",color:"action"}),e.jsx(u,{color:"primary",component:"a",href:"https://docs.streamsec.io/docs/jetbrains-youtrack-integration",target:"_blank",rel:"noreferrer",children:"Learn more about JetBrains YouTrack integration ->"})]})]}),e.jsxs(s,{row:!0,center:!0,gap:!0,children:[e.jsx(s,{grow:!0}),e.jsx(b,{variant:"text",onClick:()=>t(),children:"Cancel"}),e.jsx(b,{color:"primary",disableElevation:!0,type:"submit",disabled:c||h,onClick:()=>{n?d({variables:{id:n,fields:y()}}):o({variables:{fields:y()}})},children:n?"Update":"Integrate"})]})]})}const xn=k(`
  query YouTrackIntegrations {
    ticket_system_integrations(filters: { integration_type: "youtrack" }) {
      _id
      name
      status
      ... on YoutrackSystemIntegration {
        cloud_url
      }
    }
  }
`),yn=({onClose:t})=>{const n=G(),{data:a,loading:r}=ie(xn),o=M.useCallback(()=>{t(),n.open(fn,{fullWidth:!1})},[n,t]);return r||a!=null&&a.ticket_system_integrations&&a.ticket_system_integrations.length>0?null:e.jsx(Z,{Icon:e.jsx(je,{}),title:"JetBrains YouTrack",subTitle:"Enhance security and monitor threats",onClick:o})},_n=({onClose:t,id:n})=>{const a=ne(),r=I(),[o,{loading:c}]=j(k(`
    mutation ServiceNowIntegrationCreate($fields: IntegrationFields) {
      ticket_system_create_integration(integration_type: "service_now", fields: $fields) {
        _id
      }
    } 
  `),{onCompleted(){r("Integration created successfully","success"),t()},onError(l){r((l==null?void 0:l.message)||"Integration create error","error")},update(l){l.evict({fieldName:"ticket_system_integrations"})}}),[d,{loading:h}]=j(k(`
    mutation ServiceNowIntegrationUpdate($id: ID!, $fields: IntegrationFields) {
      ticket_system_update_integration(integration_id: $id, new_fields: $fields) {
        _id
      }
    } 
  `),{onCompleted(){r("Integration updated successfully","success"),t()},onError(l){r((l==null?void 0:l.message)||"Integration update error","error")},update(l){l.evict({fieldName:"ticket_system_integrations"})}}),{control:m,getValues:y}=R({async defaultValues(){var f;const{data:l}=await a.query({query:k(`
          query ServiceNowIntegration {
            ticket_system_integrations(filters: { integration_type: "service_now" }) {
              _id
              name
              description
              cloud_url
              ... on ServiceNowSystemIntegration {
                instance_name
                username
                password
              }
            }
          }  
        `)});return Pe.omit((f=l==null?void 0:l.ticket_system_integrations)==null?void 0:f.find(v=>v._id===n),["_id","integration_type"])}});return e.jsxs(s,{column:!0,fullHeight:!0,style:{minWidth:440},pad:2,gap:2,children:[e.jsxs(s,{row:!0,center:!0,gap:!0,children:[e.jsx(Ie,{}),e.jsx(u,{children:"Add ServiceNow Integration"}),e.jsx(s,{grow:!0}),e.jsx(V,{onClick:()=>t(),children:e.jsx(P,{fontSize:"small"})})]}),e.jsx(s,{row:!0,center:!0,children:e.jsx(u,{variant:"subtitle2",children:"To configure the ServiceNow integration, enter your ServiceNow instance details and credentials. This allows Stream Security to connect and manage incidents directly through your ServiceNow account."})}),e.jsxs(s,{column:!0,className:"modal-content",gap:2,children:[e.jsx(x,{name:"name",control:m,label:"Integration Display Name",rules:{required:"*required"},inputProps:{placeholder:"e.g., ServiceNow Security Incidents"}}),e.jsx(x,{name:"description",control:m,label:"Integration Description",inputProps:{maxRows:10,multiline:!0,placeholder:"Optional – describe the purpose of this integration"}}),e.jsx(x,{name:"instance_name",control:m,label:"ServiceNow Instance Name",inputProps:{placeholder:"yourcompany",endAdornment:e.jsx(ct,{position:"end",children:".service-now.com"})},rules:{required:"*required"}}),e.jsx(x,{name:"username",control:m,label:"Username",inputProps:{placeholder:"Enter your ServiceNow username"},rules:{required:"*required"}}),e.jsx(x,{name:"password",control:m,label:"Password",inputProps:{placeholder:"Enter your ServiceNow password",type:"password"},rules:{required:"*required"}}),e.jsxs(s,{row:!0,center:!0,gap:!0,children:[e.jsx(W,{fontSize:"small",color:"action"}),e.jsx(u,{color:"primary",component:"a",href:"https://docs.streamsec.io/docs/servicenow-integration",target:"_blank",rel:"noreferrer",children:"Learn more about ServiceNow integration ->"})]})]}),e.jsxs(s,{row:!0,center:!0,gap:!0,children:[e.jsx(s,{grow:!0}),e.jsx(b,{variant:"text",onClick:()=>t(),children:"Cancel"}),e.jsx(b,{color:"primary",disableElevation:!0,type:"submit",disabled:c||h,onClick:()=>{n?d({variables:{id:n,fields:y()}}):o({variables:{fields:y()}})},children:n?"Update":"Integrate"})]})]})},bn=k(`
  query ServiceNowIntegrations {
    ticket_system_integrations(filters: { integration_type: "service_now" }) {
      _id
      name
      status
      ... on ServiceNowSystemIntegration {
        instance_name
        username
      }
    }
  }
`),jn=({onClose:t})=>{var c;const n=G(),{data:a,loading:r}=ie(bn),o=M.useCallback(()=>{t(),n.open(_n,{fullWidth:!1})},[n,t]);return r||Number((c=a==null?void 0:a.ticket_system_integrations)==null?void 0:c.length)>0?null:e.jsx(Z,{Icon:e.jsx(Ie,{}),title:"ServiceNow",subTitle:"Enhance security and monitor threats",onClick:o})},In=N.div.withConfig({displayName:"AddIntegration__Container",componentId:"sc-19ftaev-0"})(["display:flex;flex-direction:column;width:363px;max-height:90vh;overflow:auto;margin-top:","px;& > :not(:last-child){margin-bottom:","px;}"],t=>t.theme.spacing(2),t=>t.theme.spacing(2)),vn=N.div.withConfig({displayName:"AddIntegration__Header",componentId:"sc-19ftaev-1"})(["display:flex;align-items:center;position:sticky;top:0;z-index:100;background:",";& > *{margin-left:","px;}"],t=>t.theme.palette.background.paper,t=>t.theme.spacing(1)),Ee=N(V).withConfig({displayName:"AddIntegration__IntegrationBox",componentId:"sc-19ftaev-2"})(["position:relative;display:flex;text-align:start;justify-content:flex-start;padding:","px;border-radius:","px;background-color:",";border:1px solid ",";&:hover{background-color:",";}"],t=>t.theme.spacing(2),t=>t.theme.shape.borderRadius,t=>U(t.theme.palette.common.gray,.06),t=>U(t.theme.palette.common.gray,.25),t=>U(t.theme.palette.common.gray,.13)),Ae=N.div.withConfig({displayName:"AddIntegration__IntegrationContent",componentId:"sc-19ftaev-3"})(["display:flex;flex-direction:column;margin-left:","px;& > *:not(:last-child){margin-bottom:","px;}"],t=>t.theme.spacing(2),t=>t.theme.spacing(1)),Te=N.div.withConfig({displayName:"AddIntegration__AddIcon",componentId:"sc-19ftaev-4"})(["position:absolute;top:","px;right:","px;"],t=>t.theme.spacing(2),t=>t.theme.spacing(2));function wn(){const{integrations:t,loading:n}=mt();return i.useMemo(()=>({loading:n,types:cn.filter(({id:a})=>!(t!=null&&t.length)||a!==Se)}),[t==null?void 0:t.length,n])}const Cn=({setIntegrationSteps:t,closeTooltip:n})=>{const a=dt(),{types:r,loading:o}=wn(),c=G();return e.jsx(Be,{onClickAway:n,children:e.jsxs(In,{children:[e.jsxs(vn,{children:[e.jsx(ht,{color:"disabled"}),e.jsx(u,{variant:"subtitle1",children:"Add Integration"})]}),o?e.jsx(ut,{style:{justifyContent:"center"},children:e.jsx(B,{})}):e.jsxs(e.Fragment,{children:[r==null?void 0:r.map(d=>(!d.hidden||a)&&e.jsxs(Ee,{id:d.id,onClick:()=>{if(n(),d.Form){c.open(d.Form,{fullWidth:!1,...d.dialogProps});return}t(d.steps)},children:[e.jsx(kn,{integrationType:d}),e.jsxs(Ae,{children:[e.jsx(u,{variant:"subtitle2",color:"textPrimary",children:d.title}),e.jsx(u,{variant:"body2",color:"textSecondary",children:d.subTitle})]}),e.jsx(Te,{children:e.jsx(ve,{})})]},d.title)),e.jsx(An,{onClose:n}),e.jsx(yn,{onClose:n}),e.jsx(jn,{onClose:n}),e.jsx(gn,{onClose:n})]})]})})},Sn=N(De).withConfig({displayName:"AddIntegration__ScaledIcon",componentId:"sc-19ftaev-5"})(["height:16px;width:16px;"]);function kn({integrationType:t}){const n=Fe();return t.icon?t.icon:typeof t.img=="object"?e.jsx(Sn,{children:e.jsx(t.img,{})}):e.jsx(En,{alt:t.title,src:t.darkImg&&n.palette.type==="dark"?t.darkImg:t.img})}const En=N.img.withConfig({displayName:"AddIntegration__StyledImage",componentId:"sc-19ftaev-6"})(["width:24px;height:24px;align-self:flex-start;"]),Z=({onClick:t,title:n,subTitle:a,Icon:r})=>e.jsxs(Ee,{onClick:t,children:[r,e.jsxs(Ae,{children:[e.jsx(u,{variant:"subtitle2",color:"textPrimary",children:n}),e.jsx(u,{variant:"body2",color:"textSecondary",children:a})]}),e.jsx(Te,{children:e.jsx(ve,{})})]}),An=({onClose:t})=>{const{start:n}=Tn(),{integrations:a}=pt(),r=M.useCallback(()=>{n({}),t()},[t,n]);return a!=null&&a.length?null:e.jsx(Z,{Icon:e.jsx(pe,{style:{fontSize:16}}),title:"Azure Boards",subTitle:`Integrate Azure Boards to create and monitor issues directly from
          Stream`,onClick:r})};function Tn(){const t=G(),{delete:[n,{loading:a}]}=me();return{start:i.useCallback(r=>{t.open(o=>e.jsx(xt,{data:r,...o}),{fullWidth:!1})},[t]),remove:i.useCallback(r=>t.open(o=>e.jsx(Ce,{onClose:o.onClose,onDelete:()=>n({variables:{integration_id:r}}),isLoading:a}),{fullWidth:!1}),[t,n,a])}}const qn=X(t=>({tooltipContainer:{backgroundColor:t.palette.background.paper,color:t.palette.text.primary,boxShadow:t.shadows[4],border:`solid 1px ${U(t.palette.common.gray,.1)}`,maxWidth:"435px",margin:0,padding:t.spacing(0,1),paddingBottom:t.spacing(1)}})),qe=N(b).withConfig({displayName:"AddIntegrationTooltip__AddButton",componentId:"sc-1oa2bhb-0"})(["",""],t=>t.$isActive&&`
      background-color: ${U(t.theme.palette.primary.main,.2)} !important;
    `);qe.defaultProps={variant:"text"};const On=({setIntegrationSteps:t,initialOpened:n})=>{const a=qn(),[r,o]=i.useState(n),c=()=>o(!0),d=()=>o(!1);return e.jsx(gt,{classes:{tooltip:a.tooltipContainer},interactive:!0,open:r,title:e.jsx(Cn,{setIntegrationSteps:t,closeTooltip:d}),children:e.jsx(qe,{id:"integrations-addIntegration-button",startIcon:e.jsx(ft,{fontSize:"large",color:"action"}),$isActive:r,color:r?"primary":"default",onClick:c,children:"Add integration"})})};export{qe as A,_n as S,fn as Y,ve as a,hn as b,Rn as c,On as d,vt as e,xn as f,bn as g,Tn as u};

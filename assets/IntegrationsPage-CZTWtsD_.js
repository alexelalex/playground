import{m as os,q as h,b0 as _,j as e,ap as ue,af as Oe,I as Pe,r as j,n as ee,e as we,V as Me,d as xe,f as he,b1 as as,a as J,F as is,aJ as jt,b2 as cs,b3 as D,X as ls,p as ds,aO as F,k as us,w as hs,H as ps,v as xs,x as ms}from"./index-Ba6YVotX.js";import{a8 as js,R as U,ir as yt,is as gt,bb as ys,hr as ft,hs as bt,ht as It,hu as vt,hv as Ct,d as r,fx as gs,f7 as fs,it as bs,iu as Is,iv as vs,iw as Cs,ix as Ss,m as ie,n as z,fr as ws,c_ as _s,c$ as Be,d0 as Ze,p as w,l as St,F as Fe,c as Ge,S as _e,cX as pe,eJ as ks,iy as Rs,iz as L,iA as As,o as wt,T as $e,cs as De,K as l,il as _t,I as te,bg as ke,s as kt,ai as Xe,M as Rt,ah as Ts,iB as Ns,g6 as Ws,bN as me,B as ne,aL as Es,iC as zs,q as O,g1 as k,ci as se,iD as W,iE as At,iF as Ls,U as et,as as Tt,iG as We,iH as Bs,iI as $s,hw as ve,j as Nt,iJ as Ds,i as Re,iK as Us,ca as Wt,bl as oe,iL as Os,dZ as Ps,C as ae,iM as Ms,bs as Fs,bt as Et,bu as Gs,bO as Hs,bT as Ks,bv as Vs,g as Ce,bS as zt,iN as Ys,iO as qs,hq as Lt,hp as Bt,iP as Js,y as Qs,gf as Zs,gb as Xs,k as $t,gd as er,gc as tt,c6 as tr,ge as sr,iQ as rr,iR as Dt,e2 as Ut,hj as nr,f3 as Ot,L as Pt,iS as or,iT as ar,ho as ir,iU as cr,g2 as lr,fK as dr,iV as st,iW as ur,iX as hr,hm as Mt,iY as pr,iZ as xr,i_ as mr,i$ as jr,hC as Ft,hE as Gt,hF as Ht,j0 as le,A as yr,hy as Kt,j1 as gr,J as Vt,e as fr,cv as br,bA as Ir,gg as vr,j2 as Ee,hG as Cr,hH as Sr,hz as ze,hA as rt,x as wr,an as _r,N as kr,O as Le,hx as nt,j3 as Rr,j4 as Ar,j5 as Tr,j6 as Nr,j7 as Wr,j8 as Er,j9 as zr,ja as Lr,jb as Br}from"./App-CM6DQiPl.js";import Se from"./kubernetes-EPGtmjra.js";import{a as Yt,u as qt,b as He,Y as $r,S as Dr,c as Ur,d as Or,e as Pr,f as Mr,g as Fr}from"./AddIntegrationTooltip-DIe93P-e.js";import Gr from"./Cloud_AWS_light-DeL8Cr2-.js";import Hr from"./Cloud_AWS_dark-jQLIDrgG.js";import Kr from"./s3_bucket_light-CBsXXTUX.js";import{K as Vr}from"./K8sClusterMenuItem-IYAE9FOJ.js";import{H as Yr}from"./Header-GcB7EjiI.js";var Jt={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=n(js);function n(a){return a.__esModule?a:{default:a}}var o=(0,s.default)("M4 2A2 2 0 0 0 2 4V20A2 2 0 0 0 4 22H12.41A7 7 0 0 0 16 23A7 7 0 0 0 23 16A7 7 0 0 0 18 9.3V8L12 2H4M4 4H11V9H16A7 7 0 0 0 9 16A7 7 0 0 0 10.26 20H4V4M16 11A5 5 0 0 1 21 16A5 5 0 0 1 16 21A5 5 0 0 1 11 16A5 5 0 0 1 16 11M15 12V17L18.61 19.16L19.36 17.94L16.5 16.25V12H15Z");t.default=o})(Jt);const qr=os(Jt),Jr=h(r).withConfig({displayName:"IntegrationList__ListTitle",componentId:"sc-pry133-0"})(["display:inline-block;font-size:1rem;"]),Qr=h.div.withConfig({displayName:"IntegrationList__SideBySide",componentId:"sc-pry133-1"})(["display:flex;align-items:center;& > :first-child{margin-right:","px;}"],t=>t.theme.spacing(2)),Zr=h.div.withConfig({displayName:"IntegrationList__SpaceBetween",componentId:"sc-pry133-2"})(["display:flex;justify-content:space-between;margin-bottom:","px;"],t=>t.theme.spacing(2)),Xr=h(Oe).withConfig({displayName:"IntegrationList__TablePaper",componentId:"sc-pry133-3"})(["padding:","px;box-shadow:0px 3px 6px #00000029;&:not(:last-of-type){margin-bottom:","px;}"],t=>t.theme.spacing(1),t=>t.theme.spacing(2)),en={[_.Aws]:{Icon:()=>e.jsx(U,{id:"AWS",type:"Cloud",size:"medium"})},[_.Azure]:{Icon:()=>e.jsx(U,{id:"Azure",type:"Cloud",size:"medium"})},[_.Gcp]:{Icon:()=>e.jsx(U,{id:"GCP",type:"Cloud",size:"medium"})},slack:{Icon:()=>e.jsx(ue,{children:e.jsx(yt,{})})},webhook:{Icon:()=>e.jsx(ue,{children:e.jsx(gt,{})})},kubernetes:{Icon:()=>e.jsx(ue,{children:e.jsx(Se,{})})},cve:{Icon:()=>e.jsx(ys,{})},jira:{Icon:()=>e.jsx(ue,{children:e.jsx(ft,{})})},dp:{Icon:()=>e.jsx("img",{height:18,width:18,src:bt,alt:"Cyera icon"})},edr:{Icon:({id:t})=>({CrowdStrike:e.jsx(It,{style:{width:"18px",height:"18px"}}),SentinelOne:e.jsx(vt,{style:{width:"18px",height:"18px"}}),Cortex:e.jsx(Ct,{style:{width:"18px",height:"18px"}})})[t]}},tn=h.div.withConfig({displayName:"IntegrationList__WarningContainer",componentId:"sc-pry133-4"})(["position:relative;display:flex;align-items:center;border-radius:","px;padding:","px;margin-bottom:","px;background-color:#252629;background:linear-gradient( 90deg,rgba(255,154,0,1) 2%,rgba(37,38,41,1) 7% );color:#fff;& > *:not(:last-child){margin-right:","px;}"],t=>t.theme.shape.borderRadius,t=>t.theme.spacing(2),t=>t.theme.spacing(2),t=>t.theme.spacing(3)),sn=h(Pe).withConfig({displayName:"IntegrationList__CloseWarning",componentId:"sc-pry133-5"})(["margin-left:auto;"]),rn=h(Pe).withConfig({displayName:"IntegrationList__AddIntegrationButton",componentId:"sc-pry133-6"})(["margin-right:","px;"],t=>t.theme.spacing(1));function nn({children:t,...s}){return e.jsx(Ss,{...s,children:t})}function $({id:t,title:s,type:n,addModal:o=void 0,integrations:a,selected:i,setSelected:c,handleOptionsClick:d}){var y,I;const[u,p]=j.useState(!0);return(a==null?void 0:a.length)>0&&e.jsxs(e.Fragment,{children:[e.jsxs(Zr,{children:[e.jsxs(Qr,{children:[(I=(y=en[n])==null?void 0:y.Icon)==null?void 0:I.call(y,{id:t}),e.jsxs(Jr,{variant:"body1",children:[s," ",a.length>1&&`(${a.length})`]})]}),o&&e.jsx(rn,{onClick:o,id:`${t}-addIntegration-button`,children:e.jsx(Yt,{color:"action"})})]}),n==="aws"&&u&&(a==null?void 0:a.reduce((x,R)=>{var v;return x+(R.status!=="PENDING"?((v=R.cloud_regions)==null?void 0:v.length)??0:0)},0))>(a==null?void 0:a.reduce((x,R)=>{var v;return x+(((v=R.realtime_regions)==null?void 0:v.length)||0)},0))&&e.jsx(gs,{children:e.jsxs(tn,{children:[e.jsx(nn,{$isDark:!0,children:e.jsx(fs,{})}),e.jsxs(r,{variant:"body2",children:["Some accounts are not configured to receive real-time events via CloudTrail on all managed regions.",e.jsx("br",{}),"It may cause a drift between the state of the account and its representation in the system."]}),e.jsx(sn,{onClick:()=>p(!1),id:"closeWarning-button",children:e.jsx(bs,{color:"action"})})]})}),e.jsx(Xr,{children:e.jsx(Is,{children:e.jsx(vs,{id:`${t}-listIntegrations`,children:a==null?void 0:a.map((x,R)=>e.jsx(Cs,{id:`${t}-integration-${R}`,type:n,integration:x,isActive:(i==null?void 0:i._id)===x._id,setSelected:()=>c(x),handleOptionsClick:v=>d(x,v)},x._id))})})})]})}const on=h.div.withConfig({displayName:"GroupedIntegrationInfo__GroupedInfo",componentId:"sc-15ngptr-0"})(["position:relative;display:flex;align-items:center;flex-wrap:wrap;overflow-wrap:break-word;img{align-self:flex-start;}.group-info-divider{width:100%;margin-bottom:","px;}&:first-of-type{.group-info-divider{display:none;}}"],t=>t.theme.spacing(2)),an=h.div.withConfig({displayName:"GroupedIntegrationInfo__ChildrenContainer",componentId:"sc-15ngptr-1"})(["display:flex;flex-direction:column;flex-basis:calc(100% - 30px - ","px);word-break:break-word;overflow:hidden;"],t=>t.theme.spacing(2)),cn=ie(t=>({icon:{alignSelf:"flex-start",height:24,width:24,marginRight:t.spacing(2),color:`rgba(${t.palette.type==="dark"?"255, 255, 255":"0, 0, 0"}, 0.3)`,fill:t.palette.common.gray},muiIcon:{height:18,width:18}})),g=({Icon:t,children:s})=>{const n=cn();return e.jsxs(on,{children:[e.jsx(z,{className:"group-info-divider",light:!0}),typeof t=="string"?e.jsx("img",{src:t,alt:"Icon",className:n.icon}):e.jsx(t,{className:ws(n.icon,n.muiIcon)}),e.jsx(an,{children:s})]})},ln=h(Kr).withConfig({displayName:"CostOptionStep__BucketIconSvg",componentId:"sc-vklyfz-0"})(["path{fill:",";}height:25px;width:25px;"],t=>t.theme.palette.common.gray),ot=h.div.withConfig({displayName:"CostOptionStep__OptionWrapper",componentId:"sc-vklyfz-1"})(["display:flex;& > *:not(:last-child){margin-bottom:","px;}"],t=>t.theme.spacing(2)),at=h.div.withConfig({displayName:"CostOptionStep__OptionIconWrapper",componentId:"sc-vklyfz-2"})(["background-color:",";border:2px solid ",";display:flex;flex-shrink:0;justify-content:center;align-items:center;width:60px;height:60px;border-radius:10px;margin-right:","px;"],t=>ee(t.theme.palette.common.gray,.2),t=>t.$selected?t.theme.palette.primary.main:"none",t=>t.theme.spacing(2)),dn=({handleNext:t,updateStep:s})=>{const[n,o]=j.useState("1"),a=i=>{i.preventDefault(),s({createCURAndBucket:n}),t()};return e.jsxs("form",{onSubmit:a,id:"wizard-form",children:[e.jsx(r,{variant:"h6",paragraph:!0,children:"Connect with CUR"}),e.jsxs(r,{variant:"subtitle2",color:"textSecondary",paragraph:!0,children:["Follow the steps below to enable the integration of Cost and Usage report from AWS. ",e.jsx("br",{}),"There are two different options for CUR setup:"]}),e.jsxs(_s,{"aria-label":"Theme",value:n,onChange:i=>o(i.target.value),children:[e.jsx(Be,{value:"1",control:e.jsx(Ze,{color:"primary",id:"preferences-lightMode-input"}),label:e.jsxs(ot,{children:[e.jsx(at,{$selected:n==="1",children:e.jsx(Yt,{color:"action"})}),e.jsxs("div",{children:[e.jsx(r,{variant:"subtitle1",children:"Create new CUR file"}),e.jsx(r,{variant:"body1",color:"textSecondary",children:"This option automatically creates the proper setup (CUR, S3 Bucket, and permissions)"})]})]})}),e.jsx(Be,{value:"0",control:e.jsx(Ze,{color:"primary",id:"preferences-defaultMode-input"}),label:e.jsxs(ot,{children:[e.jsx(at,{$selected:n==="0",children:e.jsx(ln,{})}),e.jsxs("div",{style:{flex:"auto"},children:[e.jsx(r,{variant:"subtitle1",children:"Connect to existing S3 bucket"}),e.jsx(r,{variant:"body1",color:"textSecondary",children:"This option makes use of an existing S3 bucket that has historical CUR files."})]})]})})]}),e.jsx("br",{}),e.jsx(w,{variant:"contained",type:"submit",fullWidth:!0,color:"primary",children:"Next"})]})},X="us-east-1",un=ie(t=>({submitButtons:{display:"flex",justifyContent:"flex-end","& > *:not(:last-child)":{marginRight:t.spacing(1)}}})),hn=({handleNext:t,stepsState:s,updateStep:n,optionalInfo:o,onClose:a})=>{const i=un(),{workspaceId:c}=we(),d=`${St()}-streamsec-cost-stack-${c}`,u=p=>{p.preventDefault();const y=window.location.hostname.endsWith("streamsec.io"),I=y?"https://prod-lightlytics-public-cloudformation.s3.amazonaws.com/lightlytics-cost-main.yaml":"https://public-lightlytics-cft.s3.amazonaws.com/lightlytics-cost-main.yaml";window.open(`https://${s.region||X}.console.aws.amazon.com/cloudformation/home?region=${s.region||X}#/stacks/create/review?templateURL=${I}&stackName=${d}&param_LightlyticsCostCollectionToken=${o==null?void 0:o.lightlytics_collection_token}&param_CFTBucketName=${y?"prod-lightlytics-public-cloudformation":"public-lightlytics-cft"}&param_LightlyticsApiUrl=${window.location.protocol}//${window.location.hostname}&param_LightlyticsAwsAccountId=${y?"624907860825":"654654251344"}${(s==null?void 0:s.createCURAndBucket)==="0"?`&param_CURBucketName=${s==null?void 0:s.bucketName}${s!=null&&s.prefixPath?`&param_CURBucketPrefix=${s==null?void 0:s.prefixPath}`:""}`:`&param_CURBucketName=lightlytics-cur-${o==null?void 0:o.cloud_account_id}`}&param_CreateCURAndBucket=${s==null?void 0:s.createCURAndBucket}`,"_blank"),t()};return e.jsxs("form",{onSubmit:u,id:"wizard-form",children:[(s==null?void 0:s.createCURAndBucket)==="0"?e.jsx(xn,{regions:(o==null?void 0:o.cloud_regions)||[],updateStep:n}):e.jsx(pn,{regions:(o==null?void 0:o.cloud_regions)||[],updateStep:n}),e.jsxs("div",{className:i.submitButtons,children:[e.jsx(w,{variant:"text",onClick:a,children:"Dismiss"}),e.jsx(w,{variant:"contained",type:"submit",color:"primary",children:"Launch Stack"})]})]})},pn=()=>e.jsxs(e.Fragment,{children:[e.jsx(r,{variant:"h6",paragraph:!0,children:"Create a new CUR file"}),e.jsx(r,{variant:"subtitle2",color:"textSecondary",paragraph:!0,children:"Select the region where the S3 bucket will contain CUR file(s)"}),e.jsxs(Fe,{fullWidth:!0,variant:"outlined",children:[e.jsx(Ge,{children:"Select Region"}),e.jsx(_e,{fullWidth:!0,value:X,placeholder:"Select Region",label:"Select Region",variant:"outlined",disabled:!0,children:e.jsx(pe,{value:X,children:e.jsx(ks,{title:e.jsxs(r,{variant:"body2",children:["The AWS Cost and Usage Report service is only available in",X," currently."]}),children:e.jsxs("div",{style:{display:"flex"},children:[e.jsx(Rs,{color:"action",fontSize:"small",display:"inline",style:{marginLeft:"3px"}})," ",X]})})})})]}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("br",{}),e.jsx(r,{variant:"subtitle2",color:"textSecondary",paragraph:!0,children:"Clicking on “Launch stack” will open AWS console. launch and approve a new stack that will create the necessary resources to forward CUR files."})]}),xn=({regions:t,updateStep:s})=>e.jsxs(e.Fragment,{children:[e.jsx(r,{variant:"h6",paragraph:!0,children:"Connect to existing S3 Bucket"}),e.jsxs(L,{color:"gray",padding:3,Icon:As,children:[e.jsx(r,{variant:"body2",gutterBottom:!0,children:"Ensure the CUR configuration meets the prerequisite for this integration"}),e.jsx(wt,{variant:"subtitle2",color:"secondary",href:"https://docs.streamsec.io/docs/costs-integration#connect-to-existing-s3-bucket",target:"_blank",children:"Read More ->"})]}),e.jsx("br",{}),e.jsxs(Fe,{fullWidth:!0,variant:"outlined",children:[e.jsx(Ge,{children:"Select Region"}),e.jsx(_e,{defaultValue:X,onChange:n=>s({region:n.target.value}),fullWidth:!0,placeholder:"Select Region",label:"Select Region",variant:"outlined",children:t==null?void 0:t.map(n=>e.jsx(pe,{value:n,children:n},n))})]}),e.jsx("br",{}),e.jsx("br",{}),e.jsx($e,{label:"S3 Bucket Name",fullWidth:!0,defaultValue:"",variant:"outlined",onChange:n=>s({bucketName:n.target.value}),required:!0}),e.jsx("br",{}),e.jsx("br",{}),e.jsx($e,{label:"Report path prefix",fullWidth:!0,required:!0,defaultValue:"",variant:"outlined",onChange:n=>s({prefixPath:n.target.value})}),e.jsx("br",{}),e.jsx("br",{}),e.jsx(r,{variant:"subtitle2",color:"textSecondary",paragraph:!0,children:'Clicking on "Launch stack” will open AWS console. Launch and approve a new stack that will create the necessary resources to forward CUR files.'})]}),mn=[{label:"Cost Module",stepLabel:"Integration options",Component:dn,maxWidth:"700px",Icon:De,hideSubmit:!0},{Icon:De,label:"Cost Module",stepLabel:"Launch Stack",Component:hn,maxWidth:"700px",hideSubmit:!0}];function jn(t){const s=Me(),n=xe(),[o,a]=j.useState(!1),[i,c]=j.useState(null),[d,u]=j.useState();return j.useEffect(()=>{I();async function I(){try{a(!0);let x=await p();x||(await y(),x=await p()),u(x)}catch(x){n(x.message,"error"),c(x)}finally{a(!1)}}},[]),{templateURL:d,loading:o,error:i};async function p(){var x;const{data:I}=await s.query({query:he(`
        query AutoRemediationTemplate($accountId: ID) {
            account(id: $accountId) {
                _id
                remediation_template_url
            }
        }    
    `),fetchPolicy:"network-only",variables:{accountId:t}});return(x=I==null?void 0:I.account)==null?void 0:x.remediation_template_url}async function y(){await s.mutate({mutation:he(`
        mutation GenerateAutoRemediationTemplate($accountId: ID!) {
            remediation_generate_template(cloud_account_id: $accountId) 
        }
    `),variables:{accountId:t}})}}function yn({accountId:t,onClose:s}){const{workspaceId:n}=we(),[o,a]=j.useState(it[0]),i=`${St()}-streamsec-remediation-stack-${n}`,{templateURL:c,loading:d,error:u}=jn(t);return e.jsxs(l,{column:!0,children:[e.jsxs(l,{row:!0,center:!0,gap:!0,pad:2,children:[e.jsx(_t,{color:"action"}),e.jsx(r,{variant:"subtitle1",children:"Enable Auto-Remediation"}),e.jsx(l,{grow:!0}),e.jsx(te,{size:"small",onClick:s,children:e.jsx(ke,{fontSize:"small"})})]}),e.jsx(l,{pad:2,children:u?e.jsx(kt,{error:u}):e.jsxs(l,{column:!0,gap:2,style:{minWidth:400},children:[e.jsxs(l,{round:!0,bg:!0,pad:2,row:!0,gap:!0,children:[e.jsx(Xe,{color:"action"}),e.jsx(r,{children:"You are about to deploy the auto remediation stack with the required resources. Please ensure that you are logged in to the appropriate cloud account in your console and that you have the necessary permissions to create these resources before proceeding with the stack creation."})]}),e.jsxs(l,{row:!0,center:!0,gap:!0,children:[e.jsx(r,{variant:"subtitle2",children:"Select Region"}),e.jsx(Xe,{fontSize:"small",color:"action"})]}),e.jsx(_e,{fullWidth:!0,variant:"outlined",value:o,onChange:y=>a(y.target.value),children:it.map(y=>e.jsx(Rt,{value:y,children:Ts[y].name},y))}),e.jsx(r,{color:"textSecondary",children:"The stack creation process may take up to 1 minute. Once it has been created successfully, the remediation status in your integration section will be updated accordingly."})]})}),e.jsxs(l,{pad:2,row:!0,center:!0,gap:!0,children:[d&&e.jsx(r,{color:"textSecondary",children:"Loading template..."}),e.jsx(l,{grow:!0}),e.jsx(w,{variant:"text",onClick:s,children:"Cancel"}),e.jsx(w,{color:"primary",disabled:!c||d,onClick:p,endIcon:e.jsx(Ns,{fontSize:"small"}),children:"Deploy Stack"})]})]});async function p(){if(!c)return;const y=as(`https://console.aws.amazon.com/cloudformation/home?region=${o}#/stacks/quickcreate`,{templateURL:c,stackName:i});window.open(y,"_blank"),s()}}const it=["us-east-1","us-east-2","us-west-1","us-west-2","ap-south-1","ap-northeast-3","ap-northeast-2","ap-southeast-1","ap-southeast-2","ap-northeast-1","ca-central-1","eu-central-1","eu-west-1","eu-west-2","eu-west-3","eu-north-1","sa-east-1"];function gn(t){var a;const{data:s,loading:n}=J(he(`
        query AccountAutoRemediationConfig($accountId: ID) {
            account(id: $accountId) {
                _id
                remediation {
                    status
                    template_version
                    external_id
                    role_arn
                    stack_id
                }
            }
        }    
    `),{variables:{accountId:t}}),o=(a=s==null?void 0:s.account)==null?void 0:a.remediation;return{config:o,enabled:!!(o!=null&&o.status),loading:n}}function fn(t){const{config:s,enabled:n,loading:o}=gn(t.accountId);return e.jsx(l,{column:!0,gap:!0,children:e.jsx(In,{icon:e.jsx(_t,{color:"action"}),title:"Auto Remediation",indicator:e.jsx(vn,{enabled:n}),action:!n&&!o&&e.jsx(wn,{accountId:t.accountId}),children:o?e.jsx(r,{color:"textSecondary",children:"Loading..."}):n?e.jsx(bn,{config:s}):e.jsx(r,{color:"textSecondary",style:{maxWidth:350},children:"Set up the necessary resources in your Cloud Account to activate Auto-Remediation capabilities."})})})}function bn(t){var s,n;return e.jsxs(l,{column:!0,gap:2,children:[e.jsxs("div",{children:[e.jsx(r,{color:"textSecondary",children:"Remediation Execution Role"}),e.jsx(r,{children:((s=t.config)==null?void 0:s.role_arn)??"N/A"})]}),e.jsxs("div",{children:[e.jsx(r,{color:"textSecondary",children:"Version"}),e.jsx(r,{children:((n=t.config)==null?void 0:n.template_version)??"N/A"})]})]})}function In({icon:t,title:s,action:n,indicator:o,children:a}){return e.jsxs(l,{column:!0,gap:!0,children:[e.jsxs(l,{row:!0,gap:2,center:!0,children:[t,e.jsx(Sn,{children:s}),o,e.jsx(l,{grow:!0}),n]}),e.jsxs(l,{row:!0,gap:2,children:[e.jsx(l,{hidden:!0,children:t}),a]})]})}function vn(t){return t.enabled?e.jsxs(Cn,{row:!0,center:!0,gap:!0,pad:!0,round:!0,children:[e.jsx(Ws,{fontSize:"small",color:"success"}),e.jsx(r,{children:"Deployed"})]}):e.jsxs(l,{row:!0,center:!0,gap:!0,round:!0,bg:!0,pad:!0,children:[e.jsx(ke,{color:"action",fontSize:"small"}),e.jsx(r,{children:"Not Deployed"})]})}const Cn=h(l).withConfig({displayName:"AutoRemediationConfig__GreenLayout",componentId:"sc-u0b7ar-0"})(({theme:t})=>({background:ee(t.palette.common.green,.25)})),Sn=h(r).withConfig({displayName:"AutoRemediationConfig__Title",componentId:"sc-u0b7ar-1"})(["font-size:","px;font-weight:",";"],t=>t.theme.typography.subtitle1.fontSize,t=>t.theme.typography.fontWeightMedium);function wn(t){const s=me();return e.jsx(ne,{size:"small",color:"primary",onClick:()=>s.open(n=>e.jsx(yn,{accountId:t.accountId,...n}),{fullWidth:!1}),children:"Create Stack"})}const fe=h(r).withConfig({displayName:"InspectIntegrationAWS__CategoryTitle",componentId:"sc-ss5b44-0"})(["font-size:13px;font-weight:500;margin-right:","px;& ~ *:not(:last-child){margin-top:","px;}"],t=>t.theme.spacing(1),t=>t.theme.spacing(1)),de=h.div.withConfig({displayName:"InspectIntegrationAWS__SpaceBetween",componentId:"sc-ss5b44-1"})(["display:flex;justify-content:space-between;align-items:center;"]),ct=h.div.withConfig({displayName:"InspectIntegrationAWS__SpaceWrapper",componentId:"sc-ss5b44-2"})(["margin-top:","px;"],t=>t.theme.spacing(t.$marTop)),_n=({integration:t,handleOptionsClick:s})=>{var c,d,u,p,y,I,x,R,v;const n=Es((c=t==null?void 0:t.cost)==null?void 0:c.last_timestamp),o=is(),a=j.useMemo(()=>zs(t),[t]);if(!t)return e.jsx(O,{children:e.jsx(r,{color:"textSecondary",children:"Nothing selected..."})});const i=k[t.status]||k.default;return e.jsxs(G,{children:[e.jsxs(g,{Icon:o.palette.type==="dark"?Hr:Gr,children:[e.jsx(V,{children:e.jsx(se,{options:a,onClickOptions:s})}),e.jsx(r,{variant:"subtitle2",color:"textSecondary",children:"Amazon Web Services"}),e.jsx(r,{variant:"h6",children:t.cloud_account_id}),t.display_name&&e.jsx(r,{noWrap:!0,variant:"body2",color:"textSecondary",children:t.display_name})]}),e.jsx(g,{Icon:A=>e.jsx("div",{...A}),children:e.jsxs(L,{...i,padding:1,InnerWrap:"div",children:[e.jsx(fe,{id:"integrationStatus",children:i.label}),i.Info&&e.jsx(i.Info,{integration:t,handleOptionsClick:s})]})}),e.jsxs(g,{Icon:i.icon||W,children:[e.jsx(fe,{children:"Account Properties"}),e.jsx(b,{variant:"body2",color:"textSecondary",children:"Collection token"}),e.jsx(At,{textToCopy:t==null?void 0:t.lightlytics_collection_token,title:"Collection token",children:e.jsx(r,{variant:"subtitle2",noWrap:!0,children:t==null?void 0:t.lightlytics_collection_token})})]}),e.jsxs(g,{Icon:De,children:[e.jsxs(de,{children:[e.jsx(fe,{children:"Cost Module"}),((d=t==null?void 0:t.cost)==null?void 0:d.status)==="success"&&((u=t==null?void 0:t.cost)==null?void 0:u.operation)!=="Delete"&&e.jsx("div",{children:n?e.jsxs(de,{children:[e.jsx(Ls,{color:"secondary"}),"  Enabled"]}):e.jsxs(de,{children:[e.jsx(qr,{color:"action"}),"  Pending"]})})]}),((p=t==null?void 0:t.cost)==null?void 0:p.status)==="success"&&((y=t==null?void 0:t.cost)==null?void 0:y.operation)!=="Delete"?e.jsxs(e.Fragment,{children:[e.jsx(et,{title:`CUR prefix path: ${(I=t==null?void 0:t.cost)==null?void 0:I.cur_prefix}`,children:e.jsx(b,{variant:"body2",color:"textSecondary",children:"CUR file location"})}),e.jsx(Tt,{id:(x=t==null?void 0:t.cost)==null?void 0:x.bucket_arn}),e.jsx(b,{variant:"body2",color:"textSecondary",children:"Last file received time-stamp"}),e.jsx(et,{title:n,children:e.jsx(r,{variant:"subtitle2",noWrap:!0,children:n||"Waiting for first CUR file"})})]}):e.jsx("div",{style:{paddingTop:6},children:e.jsx(r,{component:"a",color:"primary",onClick:()=>s({steps:mn.map(A=>({...A,optionalInfo:{...t}}))}),children:"Configure"})})]}),e.jsx(z,{}),e.jsx(fn,{accountId:t.cloud_account_id}),e.jsxs(g,{Icon:We,children:[e.jsx(ct,{$marTop:-2/3,children:e.jsxs(de,{children:[e.jsxs(de,{children:[e.jsxs(fe,{children:["Regions (",t.cloud_regions.length,")"]}),e.jsx(w,{variant:"text",onClick:()=>s({label:"Edit Regions",steps:[{optionalInfo:{...t},label:`Edit regions ${t.cloud_account_id}`,Component:Bs,Icon:We,hideSubmit:!0}],Icon:We,hideSubmit:!0,submitStepText:"Edit regions"}),size:"small",children:e.jsx(r,{variant:"body2",color:"textSecondary",children:"Edit"})})]}),e.jsxs(r,{color:"textSecondary",variant:"body2",children:[((R=t==null?void 0:t.realtime_regions)==null?void 0:R.length)||0," Real-time"]})]})}),e.jsx(ct,{$marTop:2}),e.jsx($s,{regions:t.cloud_regions,realtime_regions:(v=t==null?void 0:t.realtime_regions)==null?void 0:v.map(A=>A.region_name),templateURL:t.collection_template_url,onEnable:()=>s({steps:[ve[2]].map(A=>({...A,maxWidth:"500px",label:`${t.cloud_account_id}${t.display_name?` ${t.display_name}`:""}`,optionalInfo:{...t,_id:t._id,accountId:t.cloud_account_id,primaryRegion:t.cloud_regions[0],collection_template_url:t.collection_template_url}}))})})]})]})},Ue=h(r).withConfig({displayName:"InspectIntegrationAzure__CategoryTitle",componentId:"sc-1jomprx-0"})(["font-size:13px;font-weight:500;margin-right:","px;& ~ *:not(:last-child){margin-top:","px;}"],t=>t.theme.spacing(1),t=>t.theme.spacing(1)),kn=h.div.withConfig({displayName:"InspectIntegrationAzure__CategoryAction",componentId:"sc-1jomprx-1"})(["position:absolute;top:0;right:0;"]),Rn=({integration:t,handleOptionsClick:s})=>{const n=j.useMemo(()=>Ds(t),[t]);if(!t)return e.jsx(O,{children:e.jsx(r,{color:"textSecondary",children:"Nothing selected..."})});const o=k[t.status]||k.default;return e.jsxs(G,{children:[e.jsxs(g,{Icon:a=>e.jsx(U,{type:"Cloud",id:"Azure",...a}),children:[e.jsx(V,{children:e.jsx(se,{options:n,onClickOptions:s})}),e.jsx(r,{variant:"subtitle2",color:"textSecondary",children:"Azure"}),t.display_name&&e.jsx(r,{noWrap:!0,variant:"body2",color:"textSecondary",children:t.display_name})]}),e.jsx(g,{Icon:a=>e.jsx("div",{...a}),children:e.jsxs(L,{...o,padding:1,InnerWrap:"div",children:[e.jsx(Ue,{id:"integrationStatus",children:o.label}),o.Info&&e.jsx(o.Info,{integration:t,handleOptionsClick:s})]})}),e.jsxs(g,{Icon:W,children:[e.jsx(Ue,{children:"Application Properties"}),e.jsx(lt,{title:"API Key",value:t==null?void 0:t.account_token}),e.jsx(lt,{title:"Tenant ID",value:t==null?void 0:t.tenant_id})]}),e.jsx(An,{account:t})]})};function An({account:t}){const s=j.useMemo(()=>(t==null?void 0:t.subscriptions)||[],[t]),n=xe(),[o,a]=j.useState(!1),[i,{loading:c,error:d}]=Re(Ln,{variables:{id:t._id},onCompleted(){n("Subscriptions updated successfully","success")},onError(u){n(`Subscriptions update error ${u.message}`,"error")}});return e.jsxs(g,{Icon:Us,children:[e.jsx(Ue,{children:`${(s==null?void 0:s.length)||""} Subscriptions`}),e.jsx(kn,{children:e.jsx(ne,{variant:"text",color:"primary",onClick:()=>a(!0),children:"Add subscription"})}),(s==null?void 0:s.length)>0?e.jsx(Nn,{account:t,loading:c,subscriptions:s,onRemove:u=>i({variables:{account:{subscriptions:s.map(({id:p})=>p).filter(p=>p!==u.id)}}})}):e.jsx(r,{color:"textSecondary",children:"No subscriptions"}),e.jsx(Tn,{open:o,loading:c,error:d,onClose:()=>a(!1),onSave:u=>i({variables:{account:{subscriptions:[...(s==null?void 0:s.map(({id:p})=>p))||[],...u]}}})})]})}function Tn({open:t,loading:s,onSave:n,onClose:o}){const[a,i]=j.useState([""]),c=()=>{i([""]),o()},d=async()=>{await n(a),c()};return e.jsx(Wt,{open:t,onClose:c,children:e.jsxs(Qt,{children:[e.jsxs(oe,{gap:1,grow:[0,1,0],children:[e.jsx(U,{type:"Cloud",id:"Azure"}),e.jsx(r,{variant:"subtitle1",children:"Add Subscriptions"}),e.jsx(te,{onClick:c,children:e.jsx(ke,{})})]}),e.jsx(Os,{value:a,onChange:i}),e.jsx(L,{Icon:Ps,color:"gray",children:"Reminder to update the ARM subscriptions list (in AZURE)"}),e.jsxs(oe,{gap:1,grow:[1],children:[e.jsx("div",{}),e.jsx(ne,{variant:"text",onClick:o,children:"Cancel"}),e.jsx(ne,{variant:"text",startIcon:s&&e.jsx(ae,{size:15}),color:"primary",disabled:s||!a[0],onClick:d,children:a.length>1?"Add subscriptions":"Add subscription"})]})]})})}const Qt=h.div.withConfig({displayName:"InspectIntegrationAzure__DialogContainer",componentId:"sc-1jomprx-2"})(({theme:t})=>({display:"flex",flexDirection:"column",gap:t.spacing(2),padding:t.spacing(2)}));function Nn({account:t,subscriptions:s,loading:n,onRemove:o}){const[a,i]=j.useState(null),c=()=>{i(null)},d=async()=>{await o(a),c()};return e.jsxs(En,{children:[s.map((u,p)=>e.jsxs(zn,{children:[e.jsx(Tt,{id:`${t.cloud_account_id}_${u.id}`,disableIcon:!0,disableMenu:!0,disableTooltip:!0}),u.real_time&&e.jsx(Ms,{size:"small",color:"primary",children:"Real-time"}),e.jsx("div",{style:{flexGrow:1}}),e.jsx(Fs,{trigger:e.jsx(te,{size:"small",children:e.jsx(Et,{fontSize:"small"})}),menu:({handleMenuClose:y,...I})=>e.jsx(Gs,{...I,children:e.jsxs(Rt,{onClick:()=>{y(),i(u)},children:[e.jsx(Hs,{children:e.jsx(Ks,{})}),e.jsx(Vs,{primary:"Delete"})]})})})]},p)),e.jsx(Wt,{open:!!a,onClose:()=>i(null),children:e.jsxs(Qt,{style:{maxWidth:400},children:[e.jsxs(oe,{gap:1,grow:[0,1,0],children:[e.jsx(U,{type:"Cloud",id:"Azure"}),e.jsx(r,{variant:"subtitle1",children:"Remove subscription"}),e.jsx(te,{onClick:c,children:e.jsx(ke,{})})]}),e.jsx(r,{children:"Continue with this action will remove all subscription data and settings from this Application."}),e.jsx(r,{children:"Would you like to to continue?"}),e.jsxs(oe,{gap:1,grow:[1],children:[e.jsx("div",{}),e.jsx(ne,{variant:"text",onClick:c,children:"Cancel"}),e.jsx(Wn,{variant:"outlined",startIcon:n&&e.jsx(ae,{size:15}),disabled:n,onClick:d,children:"Yes, Remove"})]})]})})]})}const Wn=h(ne).withConfig({displayName:"InspectIntegrationAzure__RedButton",componentId:"sc-1jomprx-3"})(({theme:t})=>({color:t.palette.common.red,borderColor:t.palette.common.red})),En=h.div.withConfig({displayName:"InspectIntegrationAzure__SubscriptionsListContainer",componentId:"sc-1jomprx-4"})(({theme:t})=>({display:"flex",flexDirection:"column",border:`solid 1px ${t.palette.dividerLight}`,padding:t.spacing(1),borderRadius:t.shape.borderRadius,marginTop:t.spacing(2)})),zn=h.div.withConfig({displayName:"InspectIntegrationAzure__Subscription",componentId:"sc-1jomprx-5"})(({theme:t})=>({display:"flex",flexDirection:"row",alignItems:"center",padding:t.spacing(1),borderRadius:t.shape.borderRadius/2,"&:nth-child(even)":{background:ee(t.palette.background.default,.5)}})),Ln=Nt(`
  mutation UpdateSubscriptions($id: ID!, $account: AccountUpdateInput) {
    updateAccount(id: $id, account: $account) {
      _id
      subscriptions {
        id
      }
    }
  }
`);function lt({value:t,title:s}){const n=jt();return t?e.jsxs(e.Fragment,{children:[e.jsx(b,{variant:"body2",color:"textSecondary",children:s}),e.jsxs(oe,{gap:1,grow:[1,0],className:"hover-me",children:[e.jsx(Ce,{children:e.jsx(r,{variant:"subtitle2",noWrap:!0,children:t})}),e.jsx(te,{size:"small",className:"hide-me",onClick:()=>n(t),children:e.jsx(zt,{fontSize:"small"})})]})]}):e.jsx(e.Fragment,{})}const dt=h(r).withConfig({displayName:"InspectIntegrationGCP__CategoryTitle",componentId:"sc-1dg2msl-0"})(["font-size:13px;font-weight:500;margin-right:","px;& ~ *:not(:last-child){margin-top:","px;}"],t=>t.theme.spacing(1),t=>t.theme.spacing(1)),Bn=({integration:t})=>{const s=k[t==null?void 0:t.status]||k.default;return e.jsxs(G,{children:[e.jsxs(g,{Icon:n=>e.jsx(U,{type:"Cloud",id:"GCP",...n}),children:[e.jsx(V,{children:e.jsx(Ys,{account:t})}),e.jsx(r,{variant:"subtitle2",color:"textSecondary",children:"Google Cloud Platform"}),(t==null?void 0:t.display_name)&&e.jsx(r,{noWrap:!0,variant:"body2",color:"textSecondary",children:t==null?void 0:t.display_name})]}),e.jsx(g,{Icon:n=>e.jsx("div",{...n}),children:e.jsxs(L,{...s,padding:1,InnerWrap:"div",children:[e.jsx(dt,{id:"integrationStatus",children:s.label}),s.Info&&e.jsx(s.Info,{integration:t})]})}),e.jsxs(g,{Icon:W,children:[e.jsx(dt,{children:"Integration Properties"}),(t==null?void 0:t.account_type)&&e.jsx(be,{title:{[_.Gcp]:"Google Project ID",[_.GoogleWorkspace]:"Workspace Customer ID"}[t.account_type],value:t.cloud_account_id}),e.jsx(be,{title:"Domain",value:window.location.hostname}),e.jsx(be,{title:"Client Email",value:t==null?void 0:t.client_email}),e.jsx(be,{title:"Project Token",value:t==null?void 0:t.account_token})]})]})};function be({value:t,title:s}){const n=jt();return t?e.jsxs(e.Fragment,{children:[e.jsx(b,{variant:"body2",color:"textSecondary",children:s}),e.jsxs(oe,{gap:1,grow:[1,0],className:"hover-me",children:[e.jsx(Ce,{children:e.jsx(r,{variant:"subtitle2",noWrap:!0,children:t})}),e.jsx(te,{size:"small",className:"hide-me",onClick:()=>n(t),children:e.jsx(zt,{fontSize:"small"})})]})]}):e.jsx(e.Fragment,{})}const $n=h(w).withConfig({displayName:"InspectIntegrationSlack__RemoveButton",componentId:"sc-1f2x23k-0"})(["color:",";border-color:",";"],t=>t.theme.palette.common.error,t=>t.theme.palette.common.error),Dn=({integration:t,handleOptionsClick:s})=>{const n=j.useMemo(()=>qs(t),[t]);if(!t)return e.jsx(O,{children:e.jsx(r,{color:"textSecondary",children:"Nothing selected..."})});const o=k[t.status]||k.default;return e.jsxs(G,{children:[e.jsxs(g,{Icon:yt,children:[e.jsx(V,{children:e.jsx(se,{options:n,onClickOptions:s})}),e.jsx(r,{variant:"subtitle2",color:"textSecondary",children:"Slack"}),e.jsx(r,{variant:"h6",children:t.incoming_webhook.channel})]}),e.jsx(g,{Icon:a=>e.jsx("div",{...a}),children:e.jsxs(L,{...o,padding:t.unhealthy_reason?2:1,children:[e.jsx(r,{variant:"subtitle2",children:o.label}),t.unhealthy_reason&&e.jsxs(e.Fragment,{children:[e.jsxs(r,{variant:"body2",paragraph:!0,children:["We encountered an error while trying to send messages to"," ",t.incoming_webhook.channel,". Slack webhook or workspace are either missing or invalid"]}),e.jsx($n,{variant:"outlined",type:"submit",onClick:()=>s(n[2]),children:"Remove this integration"})]})]})}),e.jsxs(g,{Icon:o.icon||W,children:[e.jsx(r,{variant:"subtitle2",children:"Account Properties"}),e.jsx(b,{variant:"body2",color:"textSecondary",children:"Slack Workspace"}),e.jsx(r,{variant:"subtitle2",children:t.team.name})]}),e.jsxs(g,{Icon:Lt,children:[e.jsx(r,{variant:"subtitle2",children:"Alerts Properties"}),e.jsx(Ke,{onClick:()=>s(n[0]),children:"Edit"}),e.jsx(Bt,{state:t.notify_settings,view:!0})]})]})},Un=h(w).withConfig({displayName:"InspectIntegrationWebhook__RemoveButton",componentId:"sc-71lri9-0"})(["color:",";border-color:",";"],t=>t.theme.palette.common.error,t=>t.theme.palette.common.error),On=({integration:t,handleOptionsClick:s})=>{const n=j.useMemo(()=>Js(t),[t]);if(!t)return e.jsx(O,{children:e.jsx(r,{color:"textSecondary",children:"Nothing selected..."})});const o=k[t.status]||k.default;return e.jsxs(G,{children:[e.jsxs(g,{Icon:gt,children:[e.jsx(V,{children:e.jsx(se,{options:n,onClickOptions:s})}),e.jsx(r,{variant:"subtitle2",color:"textSecondary",children:"Webhook"})]}),e.jsx(g,{Icon:a=>e.jsx("div",{...a}),children:e.jsxs(L,{...o,padding:t.unhealthy_reason?2:1,children:[e.jsx(r,{variant:"subtitle2",children:o.label}),t.unhealthy_reason&&e.jsxs(e.Fragment,{children:[e.jsx(r,{variant:"body2",paragraph:!0,children:"We encountered an error while trying to send messages to the URL. Webhook URL not valid or invalid response."}),e.jsx(Un,{variant:"outlined",type:"submit",onClick:()=>s(n[2]),children:"Remove this integration"})]})]})}),e.jsxs(g,{Icon:o.icon||W,children:[e.jsx(r,{variant:"subtitle2",children:"Webhook Properties"}),e.jsx(b,{variant:"body2",color:"textSecondary",children:"Webhook Url"}),e.jsx(Ce,{children:e.jsx(r,{variant:"subtitle2",noWrap:!0,children:t.webhook_url})}),e.jsx(b,{variant:"body2",color:"textSecondary",children:"Webhook Name"}),e.jsx(r,{variant:"subtitle2",children:t.app_name}),e.jsx(b,{variant:"body2",color:"textSecondary",children:"Webhook Description"}),e.jsx(r,{variant:"subtitle2",children:t.app_description}),e.jsx(b,{variant:"body2",color:"textSecondary",children:"Webhook Header"}),e.jsx(r,{variant:"subtitle2",children:t.webhook_header}),e.jsx(b,{variant:"body2",color:"textSecondary",children:"Webhook JSON"}),e.jsx(Ce,{children:e.jsx(r,{variant:"subtitle2",noWrap:!0,children:t.webhook_json})}),e.jsx(Be,{control:e.jsx(Qs,{disabled:!0,size:"small",checked:t.tls_enabled}),label:"TLS Enabled"})]}),e.jsxs(g,{Icon:Lt,children:[e.jsx(r,{variant:"subtitle2",children:"Alerts Properties"}),e.jsx(Ke,{onClick:()=>s(n[0]),children:"Edit"}),e.jsx(Bt,{state:t.notify_settings,view:!0})]})]})},Pn=ie(t=>({container:{display:"flex",flexDirection:"column",width:"100%","& > *:not(:last-child)":{marginBottom:t.spacing(1.5)}},spacer:{marginBottom:"15% !important"},removeButtom:{color:t.palette.common.error,borderColor:t.palette.common.error,fontWeight:600},submitButtons:{display:"flex",justifyContent:"flex-end","& > *:not(:last-child)":{marginRight:t.spacing(1)}},menuItem:{padding:t.spacing(2),"&:hover":{backgroundColor:t.palette.action.hover}},clusterContent:{display:"grid",gridTemplateColumns:"40px 1fr auto",gap:t.spacing(2),alignItems:"center",width:"100%"},clusterIcon:{width:32,height:32,color:"#326CE5"},middleColumn:{display:"flex",flexDirection:"column",gap:t.spacing(.5),minWidth:0},rightColumn:{display:"flex",flexDirection:"column",gap:t.spacing(.5),alignItems:"flex-start",minWidth:"200px"},clusterName:{fontSize:"1rem",fontWeight:500,color:t.palette.text.primary,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},arnText:{fontSize:"0.875rem",color:t.palette.text.secondary,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},infoRow:{display:"flex",alignItems:"center",gap:t.spacing(1),color:t.palette.text.secondary,fontSize:"0.875rem"},accountRow:{display:"flex",alignItems:"center",gap:t.spacing(1),color:t.palette.text.secondary,fontSize:"0.875rem"},accountIcon:{width:16,height:16},clusterHeader:{display:"flex",alignItems:"center",gap:t.spacing(1)},clusterDetails:{paddingLeft:t.spacing(4),color:t.palette.text.secondary,fontSize:"0.875rem"},accountName:{display:"flex",alignItems:"center",gap:t.spacing(1)}})),Mn=({stepsState:t,updateStep:s,setLoading:n,loading:o,handleNext:a,onClose:i})=>{const c=J(Zs),{data:{notIntegratedClusters:d=[]}={},loading:u}=c,[p]=Re(Xs),y=()=>{t.confirmClose||s({confirmClose:!0})},I=xe(),[x,R]=$t("",y),[v,A]=j.useState({}),T=j.useMemo(()=>u?null:d.find(C=>x===C.id),[d,x,u]),H=Pn(),f=()=>{let C=null;return T||(C={...C,cluster_id:"This is a required field"}),C},Y=async C=>{C.preventDefault();const K=f();if(K){A(K);return}n(!0);try{const P=await p({variables:{kubernetes:{display_name:T.display_name,cluster_type:T.type,...T.type==="eks"&&{eks_arn:x},...T.type==="azure_kubernetes_service"&&{aks_resource_id:x},...T.type==="gcp_gke_cluster"&&{gke_resource_id:x}}}});s({_id:P.data.createKubernetes._id,collection_token:P.data.createKubernetes.collection_token,clusterName:T.display_name,clusterType:T.type}),a()}catch(P){I(P.message,"error"),n(!1)}},re=j.useMemo(()=>v.cluster_id?v.cluster_id:!d.length&&!u?"No clusters available":null,[v.cluster_id,d]);return e.jsxs("form",{className:H.container,onSubmit:Y,id:"wizard-form",noValidate:!0,children:[e.jsx(ue,{children:e.jsx(U,{type:"kubernetes"})}),e.jsx("div",{children:e.jsx(r,{variant:"body2",color:"textSecondary",children:"This integration enables to sync with Kubernetes resources configuration from your clusters."})}),e.jsx("div",{children:e.jsx(r,{variant:"body1",gutterBottom:!0,children:"Select the Cluster for this integration"})}),e.jsxs(Fe,{variant:"outlined",children:[e.jsx(Ge,{children:"Select Cluster"}),e.jsx(_e,{label:u?"Loading clusters...":"Select Cluster",fullWidth:!0,variant:"outlined",...R,disabled:o||u||!d.length,startAdornment:(o||u)&&e.jsx(ae,{size:20}),error:!!v.cluster_id,children:(d||[]).map((C,K)=>e.jsx(pe,{value:C.id,className:H.menuItem,disabled:o||u,children:e.jsx(Vr,{id:C.id,displayName:C.display_name,type:C.type,accountName:C.account_name})},C.id))}),re&&e.jsx(er,{error:!0,children:re})]}),e.jsx("div",{className:H.spacer}),e.jsxs("div",{className:H.submitButtons,children:[e.jsx(w,{variant:"outlined",className:H.removeButtom,onClick:i,children:"Dismiss"}),e.jsx(w,{variant:"contained",type:"submit",color:"primary",disabled:o||u||!T,startIcon:o&&e.jsx(ae,{size:20}),children:"Next"})]})]})},Fn=ie(t=>({container:{display:"flex",flexDirection:"column",width:"100%","& > *:not(:last-child)":{marginBottom:t.spacing(2)}},removeButtom:{color:t.palette.common.error,borderColor:t.palette.common.error,fontWeight:600},submitButtons:{display:"flex",justifyContent:"flex-end","& > *:not(:last-child)":{marginRight:t.spacing(1)}}})),Gn=({stepsState:t,optionalInfo:s,handleNext:n})=>{var c,d;const o=JSON.stringify(t)!=="{}"?t:s,a=Fn(),i=u=>{u.preventDefault(),n()};return e.jsxs("form",{className:a.container,onSubmit:i,id:"wizard-form",noValidate:!0,children:[e.jsxs("div",{children:[e.jsx(r,{variant:"subtitle1",gutterBottom:!0,children:"Cluster API key"}),e.jsx(tt,{text:o.collection_token})]}),e.jsxs("div",{children:[e.jsx(r,{variant:"subtitle1",gutterBottom:!0,children:"Install with Helm™"}),e.jsx(r,{variant:"body2",gutterBottom:!0,children:"1. Run the following commands in your Kubernetes environment:"}),e.jsx(tt,{text:(d=(c={eks:Hn,azure_kubernetes_service:ut,gcp_gke_cluster:ut})[o.clusterType])==null?void 0:d.call(c,o)})]}),e.jsxs(L,{color:"gray",padding:3,Icon:tr,children:[e.jsx(r,{variant:"body2",gutterBottom:!0,children:"This command will add the required chart repository and install the agent with its default configuration"}),e.jsxs(r,{variant:"body2",children:["Visit the"," ",e.jsx(wt,{color:"secondary",href:"https://github.com/lightlytics/helm-charts",target:"_blank",children:"Helm chart repository"})," ","to view the full list of configurable chart’s parameters and their default values"]})]}),e.jsx(z,{light:!0}),e.jsx(r,{variant:"body2",gutterBottom:!0,children:"2. Once the agent is up and running in your cluster: close this wizard and verify that the integration status changed to “Connected”."}),e.jsx("div",{className:a.submitButtons,children:e.jsx(w,{variant:"contained",type:"submit",color:"primary",children:"Done"})})]})},Hn=t=>`helm repo add streamsec https://lightlytics.github.io/helm-charts
helm repo update
helm install streamsec-agent --set streamsec.apiToken=${t.collection_token} --set streamsec.apiUrl=${window.location.hostname} -n streamsec-agent --create-namespace streamsec/streamsec-agent`,ut=t=>`helm repo add streamsec https://lightlytics.github.io/helm-charts
helm repo update
helm install streamsec-agent --set streamsec.apiToken=${t.collection_token} --set streamsec.apiUrl=${window.location.hostname} -n streamsec-agent --create-namespace streamsec/streamsec-agent`,Kn=ie(t=>({container:{display:"flex",flexDirection:"column","& > *:not(:last-child)":{marginBottom:t.spacing(3)}}})),Vn=({optionalInfo:{_id:t,display_name:s},stepsState:n,updateStep:o,setLoading:a,handleNext:i})=>{const[c]=Re(sr),d=()=>{n.confirmClose||o({confirmClose:!0})},u=Kn(),p=xe(),[y,I]=$t(s,d),x=async R=>{R.preventDefault(),a(!0);try{await c({variables:{id:t,kubernetes:{display_name:y}}}),i()}catch(v){p(v.message,"error"),a(!1)}};return e.jsx("form",{className:u.container,onSubmit:x,id:"wizard-form",noValidate:!0,children:e.jsx($e,{id:"displayName-input",label:"Display Name (optional)",fullWidth:!0,variant:"outlined",...I,required:!0,inputProps:{maxLength:50}})})},Yn=ie(t=>({container:{display:"flex",flexDirection:"column",width:"100%","& > *:not(:last-child)":{marginBottom:t.spacing(1.5)}},removeButtom:{marginTop:t.spacing(2),color:t.palette.common.error,borderColor:t.palette.common.error,fontWeight:600,height:44},submitButtons:{display:"flex",justifyContent:"flex-end","& > *:not(:last-child)":{marginRight:t.spacing(1)}}})),qn=({optionalInfo:t,setLoading:s,loading:n,handleNext:o,onClose:a})=>{const[i]=Re(rr),c=xe(),d=Yn(),u=async p=>{p.preventDefault(),s(!0);try{await i({variables:{id:t._id}}),o()}catch(y){c(y.message,"error"),s(!1)}};return e.jsxs("form",{className:d.container,onSubmit:u,id:"wizard-form",noValidate:!0,children:[e.jsx(r,{variant:"body2",paragraph:!0,children:"Continue with this action will remove all integrations data and settings from this workspace."}),e.jsx(w,{variant:"outlined",className:d.removeButtom,type:"submit",startIcon:n&&e.jsx(ae,{size:20}),disabled:n,children:"Delete Integration"}),e.jsx(w,{variant:"text",onClick:a,size:"large",children:e.jsx(r,{variant:"subtitle1",children:"Cancel"})})]})},Jn=[{label:"Add kubernetes Integration",Component:Mn,maxWidth:"700px",hideSubmit:!0,Icon:t=>e.jsx(Se,{...t,alt:"Kubernetes"})},{label:"Install with Helm",Component:Gn,maxWidth:"700px",hideSubmit:!0,Icon:t=>e.jsx(Se,{...t,alt:"Kubernetes"})}],Qn=[{label:"Edit Name",steps:[Vn],Icon:Dt,submitStepText:"Save settings"},{divider:!0},{label:"Remove Integration",steps:[qn],Icon:Ut,hideSubmit:!0}],Zn=t=>Qn.map(s=>{var n;return{...s,steps:(n=s.steps)==null?void 0:n.map(o=>({...s,label:`${s.label} - ${t.display_name}`,optionalInfo:{...t},Component:o,hideSteper:!0}))}}),Xn="https://docs.streamsec.io/docs/kubernetes-integration",eo=({integration:t,handleOptionsClick:s})=>{const[n]=nr(),o=j.useMemo(()=>Zn(t),[t]),a=j.useMemo(()=>Jn.slice(1),[]);if(!t)return e.jsx(O,{children:e.jsx(r,{color:"textSecondary",children:"Nothing selected..."})});const i=k[t.status]||k.default;return e.jsxs(G,{children:[e.jsxs(g,{Icon:Se,children:[e.jsxs(V,{children:[e.jsx(Pe,{onClick:()=>window.open(Xn,"_blank"),children:e.jsx(Ot,{fontSize:"small"})}),e.jsx(se,{options:o,onClickOptions:s})]}),e.jsx(r,{variant:"subtitle2",color:"textSecondary",children:"Kubernetes"}),e.jsx(r,{variant:"h6",children:t.display_name})]}),e.jsx(g,{Icon:c=>e.jsx("div",{...c}),children:e.jsx(L,{...i,padding:t.unhealthy_reason?2:1,children:e.jsxs(Pt,{children:[e.jsx(r,{variant:"subtitle2",gutterBottom:!0,children:i.label}),t.status==="UNINITIALIZED"&&e.jsxs(e.Fragment,{children:[e.jsx(r,{color:"textSecondary",variant:"body2",paragraph:!0,children:"Pending agent confirmation of successful installation within your Kubernetes cluster. If the agent failed to install click below to return the integration wizard."}),e.jsx(w,{variant:"outlined",color:"primary",endIcon:e.jsx(or,{color:"action"}),onClick:()=>s({steps:a.map(c=>({...c,maxWidth:"600px",optionalInfo:{...t,_id:t._id,collection_token:t.collection_token,clusterType:t.cluster_type}}))}),children:"Install with Helm"})]})]})})}),e.jsxs(g,{Icon:i.icon||W,children:[e.jsx(r,{variant:"subtitle2",children:"Cluster Properties"}),e.jsx(b,{variant:"body2",color:"textSecondary",children:"Cluster API key"}),e.jsx(At,{textToCopy:t.collection_token,title:"Collection token",children:e.jsx(r,{variant:"subtitle2",children:t.collection_token})}),e.jsx(b,{variant:"body2",color:"textSecondary",children:"Date added"}),e.jsx(r,{variant:"subtitle2",children:cs(t.creation_date,"long",n.is24h)})]})]})},ht=h(r).withConfig({displayName:"InspectIntegrationJira__CategoryTitle",componentId:"sc-13tah9s-0"})(["font-size:13px;font-weight:500;margin-right:","px;& ~ *:not(:last-child){margin-top:","px;}"],t=>t.theme.spacing(1),t=>t.theme.spacing(1)),to=({integration:t,handleOptionsClick:s})=>{if(!t)return e.jsx(O,{children:e.jsx(r,{color:"textSecondary",children:"Nothing selected..."})});const n=k[t.status]||k.default;return e.jsxs(G,{children:[e.jsxs(g,{Icon:ft,children:[e.jsx(V,{children:e.jsx(se,{options:ar,onClickOptions:s})}),e.jsx(r,{variant:"subtitle2",color:"textSecondary",children:"Jira"}),t.name&&e.jsx(r,{noWrap:!0,variant:"body2",color:"textSecondary",children:t.name})]}),e.jsx(g,{Icon:o=>e.jsx("div",{...o}),children:e.jsxs(L,{...n,padding:1,InnerWrap:"div",children:[e.jsx(ht,{id:"integrationStatus",children:n.label}),n.Info&&e.jsx(n.Info,{integration:t,handleOptionsClick:s})]})}),e.jsxs(g,{Icon:n.icon||W,children:[e.jsx(ht,{children:"Integration Properties"}),(t==null?void 0:t.description)&&e.jsxs(e.Fragment,{children:[e.jsx(b,{variant:"body2",color:"textSecondary",children:"Description"}),e.jsx(r,{variant:"subtitle2",noWrap:!0,children:t.description})]}),(t==null?void 0:t.atlassian_cloud_url)&&e.jsxs(e.Fragment,{children:[e.jsx(b,{variant:"body2",color:"textSecondary",children:"Atlassian Cloud URL"}),e.jsx(r,{variant:"subtitle2",noWrap:!0,children:t.atlassian_cloud_url})]}),(t==null?void 0:t.email)&&e.jsxs(e.Fragment,{children:[e.jsx(b,{variant:"body2",color:"textSecondary",children:"API Creator Email"}),e.jsx(r,{variant:"subtitle2",noWrap:!0,children:t.email})]})]})]})},pt=h(r).withConfig({displayName:"InspectIntegrationCVE__CategoryTitle",componentId:"sc-185dzp-0"})(["font-size:13px;font-weight:500;margin-right:","px;& ~ *:not(:last-child){margin-top:","px;}"],t=>t.theme.spacing(1),t=>t.theme.spacing(1)),so=/https:\/\/([a-zA-Z0-9]+)\.api\.insight\.rapid7\.com/,ro=({integration:t,handleOptionsClick:s})=>{var a,i,c,d,u;if(!t)return e.jsx(O,{children:e.jsx(r,{color:"textSecondary",children:"Nothing selected..."})});const n=k[t.status]||k.default,o=((u=(d=(c=(i=(a=t==null?void 0:t.platform_url)==null?void 0:a.match)==null?void 0:i.call(a,so))==null?void 0:c[1])==null?void 0:d.toUpperCase)==null?void 0:u.call(d))||"";return e.jsxs(G,{children:[e.jsxs(g,{Icon:p=>e.jsx(ir,{source:t.type,...p}),children:[e.jsx(V,{children:e.jsx(se,{options:cr(t),onClickOptions:s})}),e.jsx(r,{variant:"subtitle2",color:"textSecondary"}),t.display_name&&e.jsx(r,{noWrap:!0,variant:"body2",color:"textSecondary",children:t.display_name})]}),e.jsx(g,{Icon:p=>e.jsx("div",{...p}),children:e.jsxs(L,{...n,padding:1,InnerWrap:"div",children:[e.jsx(pt,{id:"integrationStatus",children:n.label}),n.Info&&e.jsx(n.Info,{integration:t,handleOptionsClick:s})]})}),e.jsxs(g,{Icon:n.icon||W,children:[e.jsx(pt,{children:"Integration Properties"}),(t==null?void 0:t.description)&&e.jsxs(e.Fragment,{children:[e.jsx(b,{variant:"body2",color:"textSecondary",children:"Description"}),e.jsx(r,{variant:"subtitle2",noWrap:!0,children:t.description})]}),(t==null?void 0:t.organization_id)&&e.jsxs(e.Fragment,{children:[e.jsx(b,{variant:"body2",color:"textSecondary",children:"Organization ID"}),e.jsx(r,{variant:"subtitle2",noWrap:!0,children:t.organization_id})]}),(t==null?void 0:t.username)&&e.jsxs(e.Fragment,{children:[e.jsx(b,{variant:"body2",color:"textSecondary",children:"Username"}),e.jsx(r,{variant:"subtitle2",noWrap:!0,children:t.username})]}),(t==null?void 0:t.url)&&e.jsxs(e.Fragment,{children:[e.jsx(b,{variant:"body2",color:"textSecondary",children:"Server URL"}),e.jsx(r,{variant:"subtitle2",noWrap:!0,children:t.url})]}),(t==null?void 0:t.port)&&e.jsxs(e.Fragment,{children:[e.jsx(b,{variant:"body2",color:"textSecondary",children:"Port"}),e.jsx(r,{variant:"subtitle2",noWrap:!0,children:t.port})]}),(t==null?void 0:t.platform)&&e.jsxs(e.Fragment,{children:[e.jsx(b,{variant:"body2",color:"textSecondary",children:"Platform"}),e.jsx(r,{variant:"subtitle2",noWrap:!0,children:t.platform})]}),(t==null?void 0:t.platform_url)&&e.jsxs(e.Fragment,{children:[e.jsx(b,{variant:"body2",color:"textSecondary",children:"Platform URL"}),e.jsx(r,{variant:"subtitle2",noWrap:!0,children:t.platform_url})]}),o&&e.jsxs(e.Fragment,{children:[e.jsx(b,{variant:"body2",color:"textSecondary",children:"Region"}),e.jsx(r,{variant:"subtitle2",noWrap:!0,children:o})]})]})]})},no=lr(w)(({theme:t})=>({padding:"0px","&:hover":{background:"none"},"& .MuiButton-startIcon.MuiButton-iconSizeSmall":{marginLeft:0,marginRight:"5px"}})),ce=({integration:t,editHandler:s,removeHandler:n})=>{const[o,a]=j.useState(null),i=p=>{a(p.currentTarget)},c=()=>{a(null)},d=()=>{n(t),c()},u=()=>{s(t),c()};return e.jsxs(e.Fragment,{children:[e.jsx(no,{variant:"text",onClick:i,size:"small",startIcon:e.jsx(Et,{color:"action",fontSize:"small"})}),e.jsxs(dr,{anchorEl:o,keepMounted:!0,open:!!o,onClose:c,children:[e.jsxs(pe,{onClick:u,style:{padding:"8px 16px"},children:[e.jsx(st,{children:e.jsx(Dt,{fontSize:"small"})}),"Edit Integration"]}),e.jsx(z,{component:"li",light:!0,variant:"middle"}),e.jsxs(pe,{onClick:d,style:{padding:"8px 16px"},children:[e.jsx(st,{children:e.jsx(Ut,{fontSize:"small"})}),"Remove Integration"]})]})]})},oo={[D.Ready]:"Connected"},ao=t=>{switch(t){case D.Deleting:case D.Unhealthy:case D.AccessDenied:case D.UnmatchAccounts:case"ERROR":return"red";case D.Ready:return"green";default:return"gray"}},Q=({status:t})=>{const s=ls(),n=ao(t);return e.jsxs(e.Fragment,{children:[t===D.Ready?e.jsx(ur,{style:{color:s.palette.common[n],fontSize:"26px"}}):e.jsx(hr,{style:{color:s.palette.common[n],fontSize:"18x"}}),oo[t]||ds(t==null?void 0:t.toLowerCase())]})},io=({integration:t})=>{const{start:s,remove:n}=qt(),{name:o,organization_name:a,ll_user:i,status:c}=t,d=u=>{n(u._id)};return e.jsxs(l,{column:!0,gap:2,pad:2,fullHeight:!0,children:[e.jsxs(l,{row:!0,gap:2,children:[e.jsx(l,{children:e.jsx(Mt,{width:24,height:24})}),e.jsxs(l,{column:!0,grow:!0,children:[e.jsx(r,{variant:"h6",color:"textSecondary",children:"Azure Boards"}),e.jsx(r,{variant:"body2",color:"textSecondary",children:o})]}),e.jsx(ce,{integration:t,editHandler:s,removeHandler:d})]}),e.jsx(z,{}),e.jsx(l,{row:!0,center:!0,gap:!0,style:{paddingLeft:35},children:e.jsx(Q,{status:c})}),e.jsx(z,{}),e.jsx(l,{column:!0,pad:2,gap:!0,children:e.jsxs(l,{row:!0,children:[e.jsx(l,{column:!0,style:{paddingRight:8,paddingTop:3},children:e.jsx(W,{fontSize:"small",color:"action"})}),e.jsxs(l,{column:!0,children:[e.jsx(r,{variant:"subtitle1",children:"Integration Properties:"}),e.jsxs(l,{column:!0,children:[e.jsx(r,{variant:"body2",color:"textSecondary",children:"Organization Name"}),e.jsx(r,{variant:"subtitle2",children:a}),e.jsx(r,{variant:"body2",color:"textSecondary",children:"Email"}),e.jsx(r,{variant:"subtitle2",children:i})]})]})]})})]})},xt=h(r).withConfig({displayName:"InspectIntegrationDP__CategoryTitle",componentId:"sc-1gu6d95-0"})(["font-size:13px;font-weight:500;margin-right:","px;& ~ *:not(:last-child){margin-top:","px;}"],t=>t.theme.spacing(1),t=>t.theme.spacing(1)),co=({integration:t})=>{if(!t)return e.jsx(O,{children:e.jsx(r,{color:"textSecondary",children:"Nothing selected..."})});const s=k.READY;return e.jsxs(G,{children:[e.jsxs(g,{Icon:n=>e.jsx("img",{src:bt,alt:"Cyera logo",...n}),children:[e.jsx(V,{children:e.jsx(pr,{integration:t})}),e.jsx(r,{variant:"subtitle2",color:"textSecondary"}),t.display_name&&e.jsx(r,{noWrap:!0,variant:"body2",color:"textSecondary",children:t.display_name})]}),e.jsx(g,{Icon:n=>e.jsx("div",{...n}),children:e.jsx(L,{...s,padding:1,InnerWrap:"div",children:e.jsx(xt,{id:"integrationStatus",children:s.label})})}),e.jsxs(g,{Icon:s.icon||W,children:[e.jsx(xt,{children:"Integration Properties"}),(t==null?void 0:t.description)&&e.jsxs(e.Fragment,{children:[e.jsx(b,{variant:"body2",color:"textSecondary",children:"Description"}),e.jsx(r,{variant:"subtitle2",noWrap:!0,children:t.description})]}),t.client_id&&e.jsxs(e.Fragment,{children:[e.jsx(b,{variant:"body2",color:"textSecondary",children:"Client ID"}),e.jsx(r,{variant:"subtitle2",noWrap:!0,children:t.client_id})]})]})]})},mt=h(r).withConfig({displayName:"InspectIntegrationEDR__CategoryTitle",componentId:"sc-1t4ucgc-0"})(["font-size:13px;font-weight:500;margin-right:","px;& ~ *:not(:last-child){margin-top:","px;}"],t=>t.theme.spacing(1),t=>t.theme.spacing(1));function lo(t){return e.jsx("div",{...t})}function uo({integrationType:t}){switch(t){case F.Crowdstrike:return e.jsx(It,{style:{width:"20px",height:"20px"}});case F.SentinelOne:return e.jsx(vt,{style:{width:"20px",height:"20px"}});case F.Cortex:return e.jsx(Ct,{style:{width:"20px",height:"20px"}});default:return null}}function ho({integration:t}){if(!t)return e.jsx(O,{children:e.jsx(r,{color:"textSecondary",children:"Nothing selected..."})});const s=k.READY;return e.jsxs(G,{children:[e.jsxs(l,{row:!0,center:!0,gap:2,children:[e.jsx(uo,{integrationType:t.type}),e.jsxs(l,{column:!0,children:[e.jsx(r,{variant:"subtitle2",color:"textSecondary",children:{[F.Crowdstrike]:"CrowdStrike",[F.SentinelOne]:"SentinelOne",[F.Cortex]:"Cortex"}[t.type]||""}),t.display_name&&e.jsx(r,{noWrap:!0,variant:"subtitle1",children:t.display_name})]}),e.jsx(l,{grow:!0}),{[F.Crowdstrike]:e.jsx(xr,{integration:t}),[F.SentinelOne]:e.jsx(mr,{integration:t}),[F.Cortex]:e.jsx(jr,{integration:t})}[t.type]||""]}),e.jsx(g,{Icon:lo,children:e.jsx(L,{...s,padding:1,InnerWrap:"div",children:e.jsx(mt,{id:"integrationStatus",children:s.label})})}),e.jsxs(g,{Icon:s.icon||W,children:[e.jsx(mt,{children:"Integration Properties"}),(t==null?void 0:t.description)&&e.jsxs(e.Fragment,{children:[e.jsx(b,{variant:"body2",color:"textSecondary",children:"Description"}),e.jsx(r,{variant:"subtitle2",noWrap:!0,children:t.description})]}),t.client_id&&e.jsxs(e.Fragment,{children:[e.jsx(b,{variant:"body2",color:"textSecondary",children:"Client ID"}),e.jsx(r,{variant:"subtitle2",noWrap:!0,children:t.client_id})]}),t.platform_url&&e.jsxs(e.Fragment,{children:[e.jsx(b,{variant:"body2",color:"textSecondary",children:t.type===F.Cortex?"API Base URL":"Domain URL"}),e.jsx(r,{variant:"subtitle2",noWrap:!0,children:t.platform_url})]}),t.access_token&&e.jsxs(e.Fragment,{children:[e.jsx(b,{variant:"body2",color:"textSecondary",children:"SentinelOne Token"}),e.jsx(r,{variant:"subtitle2",noWrap:!0,children:t.access_token})]})]})]})}const po=({integration:t})=>{const{display_name:s,api_key:n,status:o,domain:a}=t,{start:i,remove:c}=He(),d=u=>{c(u.id)};return e.jsxs(l,{column:!0,gap:2,pad:2,fullHeight:!0,children:[e.jsxs(l,{row:!0,gap:2,children:[e.jsx(l,{children:e.jsx(Ft,{width:24,height:24})}),e.jsxs(l,{column:!0,grow:!0,children:[e.jsx(r,{variant:"h6",color:"textSecondary",children:"Okta"}),e.jsx(r,{variant:"body2",color:"textSecondary",children:s})]}),e.jsx(ce,{integration:t,editHandler:i,removeHandler:d})]}),e.jsx(z,{}),e.jsx(l,{row:!0,center:!0,gap:!0,style:{paddingLeft:35},children:e.jsx(Q,{status:o})}),e.jsx(z,{}),e.jsx(l,{column:!0,pad:2,gap:!0,children:e.jsxs(l,{row:!0,children:[e.jsx(l,{column:!0,style:{paddingRight:8,paddingTop:3},children:e.jsx(W,{fontSize:"small",color:"action"})}),e.jsxs(l,{column:!0,children:[e.jsx(r,{variant:"subtitle1",children:"Integration Properties:"}),e.jsxs(l,{column:!0,children:[e.jsx(r,{variant:"body2",color:"textSecondary",children:"API Key"}),e.jsx(r,{variant:"subtitle2",children:n}),e.jsx(r,{variant:"body2",color:"textSecondary",children:"Domain"}),e.jsx(r,{variant:"subtitle2",children:a})]})]})]})})]})};function xo({integration:t}){const{name:s,cloud_url:n,status:o}=t;return e.jsxs(l,{column:!0,gap:2,pad:2,fullHeight:!0,children:[e.jsxs(l,{row:!0,gap:2,children:[e.jsx(l,{children:e.jsx(Gt,{width:24,height:24})}),e.jsxs(l,{column:!0,grow:!0,children:[e.jsx(r,{variant:"h6",color:"textSecondary",children:"JetBrains YouTrack"}),e.jsx(r,{variant:"body2",color:"textSecondary",children:s})]})]}),e.jsx(z,{}),e.jsx(l,{row:!0,center:!0,gap:!0,style:{paddingLeft:35},children:e.jsx(Q,{status:o})}),e.jsx(z,{}),e.jsx(l,{column:!0,pad:2,gap:!0,children:e.jsxs(l,{row:!0,children:[e.jsx(l,{column:!0,style:{paddingRight:8,paddingTop:3},children:e.jsx(W,{fontSize:"small",color:"action"})}),e.jsxs(l,{column:!0,children:[e.jsx(r,{variant:"subtitle1",children:"Integration Properties:"}),e.jsxs(l,{column:!0,children:[e.jsx(r,{variant:"body2",color:"textSecondary",children:"Service URL"}),e.jsx(r,{variant:"subtitle2",children:n})]})]})]})})]})}function mo({integration:t}){const{name:s,instance_name:n,status:o,username:a}=t;return e.jsxs(l,{column:!0,gap:2,pad:2,fullHeight:!0,children:[e.jsxs(l,{row:!0,gap:2,children:[e.jsx(l,{children:e.jsx(Ht,{width:24,height:24})}),e.jsxs(l,{column:!0,grow:!0,children:[e.jsx(r,{variant:"h6",color:"textSecondary",children:"ServiceNow"}),e.jsx(r,{variant:"body2",color:"textSecondary",children:s})]})]}),e.jsx(z,{}),e.jsx(l,{row:!0,center:!0,gap:!0,style:{paddingLeft:35},children:e.jsx(Q,{status:o})}),e.jsx(z,{}),e.jsx(l,{column:!0,pad:2,gap:!0,children:e.jsxs(l,{row:!0,children:[e.jsx(l,{column:!0,style:{paddingRight:8,paddingTop:3},children:e.jsx(W,{fontSize:"small",color:"action"})}),e.jsxs(l,{column:!0,children:[e.jsx(r,{variant:"subtitle1",children:"Integration Properties:"}),e.jsxs(l,{column:!0,children:[e.jsx(r,{variant:"body2",color:"textSecondary",children:"Instance Name"}),e.jsx(r,{variant:"subtitle2",children:n}),e.jsx(r,{variant:"body2",color:"textSecondary",children:"Username"}),e.jsx(r,{variant:"subtitle2",children:a})]})]})]})})]})}const jo={[_.Aws]:_n,[_.Azure]:Rn,[_.Gcp]:Bn,slack:Dn,webhook:On,kubernetes:eo,jira:to,cve:ro,azureBoards:io,dp:co,edr:ho,okta:po,youtrack:xo,service_now:mo},G=h.div.withConfig({displayName:"InspectIntegration__Layout",componentId:"sc-nxaeib-0"})(["position:relative;display:flex;flex-direction:column;padding:","px;& > *:not(:last-child){margin-bottom:","px;}"],t=>t.theme.spacing(3),t=>t.theme.spacing(2)),V=h.div.withConfig({displayName:"InspectIntegration__IconWrapper",componentId:"sc-nxaeib-1"})(["position:absolute;right:0;top:0;"]),b=h(r).withConfig({displayName:"InspectIntegration__Subtitle",componentId:"sc-nxaeib-2"})(["display:flex;align-items:center;margin-top:","px;& > *{margin-left:","px;}"],t=>t.theme.spacing(2),t=>t.theme.spacing(1)),Ke=h(w).withConfig({displayName:"InspectIntegration__EditLink",componentId:"sc-nxaeib-3"})(["position:absolute;top:","px;right:0;"],t=>t.theme.spacing(1.5));Ke.defaultProps={variant:"text"};const yo=t=>{if(!t.integration)return e.jsx(O,{children:e.jsx(r,{color:"textSecondary",children:"Nothing selected..."})});const s=jo[t.type||t.integration.type];return e.jsx(s,{...t})},go=484,fo=(t={})=>{const{workspaceId:s}=we(),n=us(),{error:o,loading:a}=J(Nt`
      query Permissions($user_id: ID, $workspace_id: ID) {
        permissions(user_id: $user_id, workspace_id: $workspace_id) {
          _id
        }
      }
    `,{fetchPolicy:"cache-and-network",...t,variables:{workspace_id:s,user_id:n==null?void 0:n._id}}),i=j.useMemo(()=>{var c,d,u;return!((c=o==null?void 0:o.graphQLErrors)!=null&&c.length&&((u=(d=o==null?void 0:o.graphQLErrors[0])==null?void 0:d.extensions)==null?void 0:u.status)===go)},[o]);return{loading:a,isUserHasPermission:i}},Ae=h("div").withConfig({displayName:"IntegrationsBadge",componentId:"sc-sldkfw-0"})(({theme:t,isActive:s,color:n="green"})=>({display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:s?t.palette.common[n]:t.palette.common.gray,width:8,height:28,borderRadius:t.shape.borderRadius})),Te=h(l).withConfig({displayName:"IntegrationsStyles__InnerContainer",componentId:"sc-1if8jlb-0"})(({theme:t,isSelected:s})=>({cursor:s?"default":"pointer",backgroundColor:s?ee(t.palette.primary.main,.12):t.palette.background.paper,border:"1px solid",borderColor:ee(t.palette.common.gray,.1),height:"42px","&:hover":{backgroundColor:s?void 0:t.palette.action.hover}})),B=h("div").withConfig({displayName:"IntegrationsStyles__ColumnItem",componentId:"sc-1if8jlb-1"})(({theme:t})=>({padding:"6px",minWidth:"250px"})),bo=({integration:t,selected:s,setSelected:n})=>{const o=(s&&(s==null?void 0:s.id)===(t==null?void 0:t.id))??!1,{start:a,remove:i}=He(),c=d=>{i(d.id),n(null)};return e.jsxs(Te,{row:!0,center:!0,grow:!0,gap:!0,onClick:()=>n(t),isSelected:o,children:[e.jsx(B,{children:e.jsxs(l,{row:!0,grow:!0,gap:4,center:!0,children:[e.jsx(Ae,{isActive:(t==null?void 0:t.status)===D.Ready}),e.jsx("span",{children:t==null?void 0:t.display_name})]})}),e.jsx(B,{style:{paddingLeft:30},children:t==null?void 0:t.domain}),e.jsx(B,{}),e.jsx(l,{row:!0,center:!0,grow:!0,gap:2,pad:3,children:e.jsx(Q,{status:t.status})}),e.jsx(ce,{integration:t,editHandler:a,removeHandler:c})]})},Io=h.div.withConfig({displayName:"IntegrationsList__StyledContainer",componentId:"sc-vgrp7o-0"})(({theme:t})=>({background:t.palette.background.paper,padding:t.spacing(1),boxShadow:"0px 3px 6px #00000029",borderRadius:t.shape.borderRadius,"& > :nth-child(odd)":{background:ee(t.palette.common.gray,.06)},"& > :first-child":{borderTopLeftRadius:t.shape.borderRadius,borderTopRightRadius:t.shape.borderRadius,"& > :first-of-type":{borderTopLeftRadius:t.shape.borderRadius,borderTopRightRadius:t.shape.borderRadius}},"& > :last-child":{borderBottomLeftRadius:t.shape.borderRadius,borderBottomRightRadius:t.shape.borderRadius,"& > :first-of-type":{borderBottomLeftRadius:t.shape.borderRadius,borderBottomRightRadius:t.shape.borderRadius}},"& > :not(:first-child):not(:last-child)":{borderRadius:0}})),Ie=({title:t,integrations:s,addIntegrationCB:n,render:o,Icon:a})=>s!=null&&s.length?e.jsxs(le,{container:!0,direction:"column",spacing:1,style:{marginBottom:12},children:[e.jsxs(le,{item:!0,container:!0,direction:"row",spacing:1,children:[e.jsx(le,{item:!0,children:a}),e.jsx(le,{item:!0,children:e.jsx(r,{variant:"h5",children:t})}),e.jsx(l,{row:!0,grow:!0}),n&&e.jsx(le,{item:!0,style:{paddingRight:5},children:e.jsx(te,{onClick:()=>n(null),children:e.jsx(yr,{color:"action"})})})]}),e.jsx(Io,{children:s.map((i,c)=>o(i))})]}):e.jsx(e.Fragment,{}),vo=({integration:t,selected:s,setSelected:n})=>{const{start:o,remove:a}=qt(),i=!!(s&&s._id===t._id),c=d=>{a(d._id),n(null)};return e.jsxs(Te,{row:!0,center:!0,grow:!0,onClick:()=>n(t),isSelected:i,gap:!0,children:[e.jsx(B,{children:e.jsxs(l,{row:!0,grow:!0,gap:4,center:!0,children:[e.jsx(Ae,{isActive:t.status===D.Ready}),e.jsx("span",{children:t.name})]})}),e.jsx(B,{style:{paddingLeft:30},children:t.organization_name}),e.jsx(B,{}),e.jsx(l,{row:!0,center:!0,grow:!0,gap:2,pad:3,children:e.jsx(Q,{status:t.status})}),e.jsx(ce,{integration:t,editHandler:o,removeHandler:c})]})},Co=({integration:t,selected:s,setSelected:n})=>{const o=s&&s._id===t._id;return e.jsxs(Te,{row:!0,center:!0,grow:!0,onClick:()=>n(t),isSelected:o,gap:!0,children:[e.jsx(B,{children:e.jsxs(l,{row:!0,grow:!0,gap:4,center:!0,children:[e.jsx(Ae,{isActive:t.status===D.Ready}),e.jsx("span",{children:t.name})]})}),e.jsx(B,{style:{paddingLeft:30}}),e.jsx(B,{}),e.jsx(l,{row:!0,center:!0,grow:!0,gap:2,pad:3,children:e.jsx(Q,{status:t.status})}),e.jsx(So,{integration:t,onDelete:()=>n(null)})]})};function So({integration:t,onDelete:s}){const n=Me(),o=me(),a=()=>{o.confirm({title:"Delete JetBrains YouTrack Integration",text:"Are you sure you want to delete this integration?",confirmText:"Delete",declineText:"Cancel",actionsLayout:"row",confirmRed:!0,inputText:{disabled:!0}}).then(()=>{n.mutate({mutation:he(`
          mutation DeleteYoutrackIntegration($id: ID!) {
            ticket_system_delete_integration(integration_id: $id)
          }
        `),variables:{id:t._id},update(c){c.evict({fieldName:"ticket_system_integrations"})}}),s()})},i=()=>{o.open(c=>e.jsx($r,{...c,id:t._id}),{fullWidth:!1})};return e.jsx(ce,{integration:t,editHandler:i,removeHandler:a})}const wo=({integration:t,selected:s,setSelected:n})=>{const o=s&&s._id===t._id;return e.jsxs(Te,{row:!0,center:!0,grow:!0,onClick:()=>n(t),isSelected:o,gap:!0,children:[e.jsx(B,{children:e.jsxs(l,{row:!0,grow:!0,gap:4,center:!0,children:[e.jsx(Ae,{isActive:t.status===D.Ready}),e.jsx("span",{children:t.name})]})}),e.jsx(B,{style:{paddingLeft:30}}),e.jsx(B,{}),e.jsx(l,{row:!0,center:!0,grow:!0,gap:2,pad:3,children:e.jsx(Q,{status:t.status})}),e.jsx(_o,{integration:t,onDelete:()=>n(null)})]})};function _o({integration:t,onDelete:s}){const n=Me(),o=me(),a=()=>{o.confirm({title:"Delete ServiceNow Integration",text:"Are you sure you want to delete this integration?",confirmText:"Delete",declineText:"Cancel",actionsLayout:"row",confirmRed:!0,inputText:{disabled:!0}}).then(()=>{n.mutate({mutation:he(`
          mutation DeleteServiceNowIntegration($id: ID!) {
            ticket_system_delete_integration(integration_id: $id)
          }
        `),variables:{id:t._id},update(c){c.evict({fieldName:"ticket_system_integrations"})}}),s()})},i=()=>{o.open(c=>e.jsx(Dr,{...c,id:t._id}),{fullWidth:!1})};return e.jsx(ce,{integration:t,editHandler:i,removeHandler:a})}const ko=h.div.withConfig({displayName:"IntegrationsMain__Container",componentId:"sc-1y25330-0"})(["display:flex;justify-content:space-between;flex-wrap:wrap;margin-top:",";margin-bottom:",";margin-left:","px;height:100%;overflow:auto;"],t=>`${t.theme.spacing(4)}px`,t=>`${t.theme.spacing(.5)}px`,t=>t.theme.spacing(3)),Ro=h.div.withConfig({displayName:"IntegrationsMain__MainIntegrations",componentId:"sc-1y25330-1"})(["flex-basis:65%;border-radius:","px;margin-right:","px;flex-grow:9999;"],t=>t.theme.shape.borderRadius,t=>t.theme.spacing(2)),Ao=h(Oe).withConfig({displayName:"IntegrationsMain__SideSettings",componentId:"sc-1y25330-2"})(["position:sticky;top:0;flex-basis:calc(35% - ","px);max-width:500px;height:calc(100% - ","px);border-radius:","px;border:1px solid ",";margin-right:","px;overflow-x:hidden;flex-grow:1;"],t=>t.theme.spacing(5),t=>t.theme.spacing(4),t=>t.theme.shape.borderRadius,t=>ee(t.theme.palette.common.gray,.1),t=>t.theme.spacing(3));function To({accounts:t,slacks:s,webhooks:n,cve_integrations:o,dp_integrations:a,edr_integrations:i,jira_integrations:c,azureIntegrations:d,ytIntegrations:u,snIntegrations:p,oktaIntegrations:y,addAwsModal:I,addAzureModal:x,addSlackModal:R,addWebhookModal:v,addSnykModal:A}){const T=j.useMemo(()=>[...t,...s,...n,...o,...c,...a,...i,...d,...y,...u,...p],[t,o,a,i,c,s,n,d,y,u,p]),H=me(),[f,Y]=j.useState(),[re,C]=j.useState(),[K,P]=j.useState(),{isUserHasPermission:q}=fo(),{start:je}=He();j.useEffect(()=>{f&&Y(T.find(m=>m._id===f._id))},[Y,f,T]);const N=(m,M)=>{var Z;console.log("handleOptionsClick",M),M.steps&&(M={stepsInfo:M.steps}),P({...M,stepsInfo:(Z=M.stepsInfo)==null?void 0:Z.map(ye=>({...ye,optionalInfo:{integration:m,...ye.optionalInfo}}))})},S=m=>M=>{C(m),Y(M)};return j.useEffect(()=>{f&&!T.find(m=>f.id===m.id)&&Y(null)},[T,f]),e.jsxs(ko,{children:[e.jsxs(Ro,{children:[e.jsx($,{id:"AWS",type:_.Aws,title:"Amazon web services",integrations:j.useMemo(()=>t.filter(m=>m.account_type===_.Aws),[t]),selected:f,setSelected:S(_.Aws),handleOptionsClick:N,addModal:q&&I}),e.jsx($,{id:"Azure",type:_.Azure,title:"Azure",integrations:j.useMemo(()=>t.filter(m=>m.account_type===_.Azure),[t]),selected:f,setSelected:S(_.Azure),handleOptionsClick:N,addModal:q&&x}),e.jsx($,{id:"GCP",type:_.Gcp,title:"Google Cloud Platform",integrations:j.useMemo(()=>t.filter(m=>m.account_type===_.Gcp||m.account_type===_.GoogleWorkspace),[t]),selected:f,setSelected:S(_.Gcp),addModal:()=>H.open(Kt,{fullWidth:!0,size:"md"})}),e.jsx($,{id:"Slack",type:"slack",title:"Slack",integrations:s,selected:f,setSelected:S("slack"),handleOptionsClick:N,addModal:R}),e.jsx($,{id:"Webhook",type:"webhook",title:"Webhook",integrations:n,selected:f,setSelected:S("webhook"),handleOptionsClick:N,addModal:v}),e.jsx($,{id:"CVE",type:"cve",title:"Vulnerabilities",integrations:o,selected:f,setSelected:S("cve"),handleOptionsClick:N,addModal:q&&A}),e.jsx($,{id:"Jira",type:"jira",title:"Jira",integrations:c,selected:f,setSelected:S("jira"),handleOptionsClick:N}),e.jsx($,{id:"dp",type:"dp",title:"Cyera",integrations:a,selected:f,setSelected:S("dp"),handleOptionsClick:N}),e.jsx($,{id:"CrowdStrike",type:"edr",title:"CrowdStrike",integrations:j.useMemo(()=>i==null?void 0:i.filter(m=>m.type==="Crowdstrike"),[i]),selected:f,setSelected:S("edr"),handleOptionsClick:N}),e.jsx($,{id:"SentinelOne",type:"edr",title:"SentinelOne",integrations:j.useMemo(()=>i==null?void 0:i.filter(m=>m.type==="SentinelOne"),[i]),selected:f,setSelected:S("edr"),handleOptionsClick:N}),e.jsx($,{id:"Cortex",type:"edr",title:"Cortex",integrations:j.useMemo(()=>i==null?void 0:i.filter(m=>m.type==="Cortex"),[i]),selected:f,setSelected:S("edr"),handleOptionsClick:N}),e.jsx(Ie,{title:"Azure",integrations:d,render:m=>e.jsx(vo,{integration:m,selected:f,setSelected:S("azureBoards")},m._id),Icon:e.jsx(Mt,{width:18,height:18})}),e.jsx(Ie,{title:"JetBrains YouTrack",integrations:u,render:m=>e.jsx(Co,{integration:m,selected:f,setSelected:S("youtrack")},m._id),Icon:e.jsx(Gt,{width:18,height:18})}),e.jsx(Ie,{title:"ServiceNow",integrations:p,render:m=>e.jsx(wo,{integration:m,selected:f,setSelected:S("service_now")},m._id),Icon:e.jsx(Ht,{width:18,height:18})}),e.jsx(Ie,{title:"Okta",integrations:y,addIntegrationCB:je,render:m=>e.jsx(bo,{integration:m,selected:f,setSelected:S("okta")},m.id),Icon:e.jsx(Ft,{width:18,height:18})})]}),e.jsx(Ao,{children:e.jsx(gr,{children:e.jsx(yo,{integration:f,type:re,handleOptionsClick:m=>N(f,m)})},(f==null?void 0:f._id)??"none")}),!!K&&e.jsx(Vt,{closeDialog:()=>P(!1),dialogOpen:!0,...K})]})}const No="/stream/assets/empty-header-DGiavIoQ.png",Wo=h.div.withConfig({displayName:"NoAccountsView__Content",componentId:"sc-znhm10-0"})(["display:flex;flex-direction:column;align-items:flex-start;padding:","px;& > *:not(:last-child){margin-bottom:","px;}"],t=>t.theme.spacing(4),t=>t.theme.spacing(2)),Eo=({addAwsModal:t,addAzureModal:s})=>{const n=fr(),o=br(),a=me();return e.jsxs(zo,{children:[e.jsx("img",{alt:"Header",src:No}),e.jsxs(Wo,{children:[e.jsx(r,{variant:"subtitle1",color:"textSecondary",children:n==null?void 0:n.display_name}),e.jsxs("div",{children:[e.jsxs(r,{variant:"h6",children:["Hello ",o==null?void 0:o.full_name,","]}),e.jsx(r,{variant:"subtitle1",color:"textSecondary",children:"Your new workspace is ready! Let’s start by adding a cloud account"})]}),e.jsx(w,{startIcon:e.jsx(U,{id:"AWS",type:"Cloud",size:"medium"}),variant:"text",color:"default",fullWidth:!1,onClick:t,children:e.jsx(r,{variant:"subtitle2",children:"Add AWS Cloud account"})}),e.jsx(w,{startIcon:e.jsx(U,{id:"Azure",type:"Cloud",size:"medium"}),variant:"text",color:"default",fullWidth:!1,onClick:s,children:e.jsx(r,{variant:"subtitle2",children:"Add Azure Cloud account"})}),e.jsx(w,{startIcon:e.jsx(U,{id:"GCP",type:"Cloud",size:"medium"}),variant:"text",color:"default",fullWidth:!1,onClick:()=>{a.open(Kt,{fullWidth:!0,size:"md"})},children:e.jsx(r,{variant:"subtitle2",children:"Add Google Cloud account"})}),e.jsx(z,{light:!0,style:{width:"100%"}}),e.jsx(r,{variant:"subtitle2",color:"textSecondary",children:"You might be interested in"}),e.jsx(w,{component:"a",href:"https://docs.streamsec.io/",target:"_blank",variant:"text",color:"default",startIcon:e.jsx(Ot,{color:"action"}),children:e.jsx(r,{variant:"subtitle2",children:"Help center"})})]})]})},zo=hs(t=>({root:{position:"relative",alignSelf:"center",paddingTop:0,borderRadius:t.shape.borderRadius*2,display:"flex",marginRight:"10%",flexDirection:"column",maxWidth:"370px",marginTop:"8%"}}))(Oe),Lo=()=>e.jsx(Bo,{children:e.jsxs($o,{gap:1,children:[e.jsx(Ir,{fontSize:"large",color:"primary"}),e.jsx(r,{variant:"h6",color:"primary",children:"No Access"}),e.jsx(r,{children:"Contact your workspace administrator"})]})}),Bo=h.div.withConfig({displayName:"NoGroupsView__Container",componentId:"sc-1q65cng-0"})(["display:flex;height:100%;"]),$o=h(Pt).withConfig({displayName:"NoGroupsView__MainContent",componentId:"sc-1q65cng-1"})(["margin:0 auto;align-items:center;align-self:center;"]),Vo=()=>{var qe;const{workspaceId:t}=we(),s=vr(t),n=ps(),{data:{cloudAccounts:o=[]}={},error:a,loading:i}=Ee(Ar,Rr),{data:{slacks:c=[]}={},error:d,loading:u}=Ee(Nr,Tr),{data:{webhooks:p=[]}={},error:y,loading:I}=Ee(Er,Wr),{data:{cve_integrations:x=[]}={},error:R,loading:v}=J(zr),{data:{dp_integrations:A=[]}={},error:T,loading:H}=J(Lr),{data:{edr_integrations:f=[]}={},error:Y,loading:re}=J(Br),{integrations:C=[],error:K,loading:P}=Cr(),{integrations:q=[],error:je,loading:N}=Sr(),{data:{ticket_system_integrations:S=[]}={ticket_system_integrations:[]},error:m,loading:M}=J(Mr),{data:{ticket_system_integrations:Z=[]}={ticket_system_integrations:[]},error:ye,loading:Zt}=J(Fr),{integrations:ge=[],error:Xt,loading:es}=Ur(),[Ne,E]=j.useState(!1),ts=(c==null?void 0:c.length)+(p==null?void 0:p.length)+(o==null?void 0:o.length)+(x==null?void 0:x.length)+(C==null?void 0:C.length)+(q==null?void 0:q.length)+(ge==null?void 0:ge.length)+(A==null?void 0:A.length)+(f==null?void 0:f.length)+(S==null?void 0:S.length)+(Z==null?void 0:Z.length),Ve=i||u||I||v||P||N||H||re||P||N||es||M||Zt,Ye=a||d||y||R||K||je||T||Y||K||je||Xt||m||ye;j.useEffect(()=>{var Qe;if(new URLSearchParams(window.location.search).get("code")){const ns=ze.slice(1);E(ns)}(Qe=n.state)!=null&&Qe.addIntegration&&(n.state.addIntegration==="AWS"?E(ve):n.state.addIntegration==="slack"?E(ze):n.state.addIntegration==="webhook"&&E(rt))},[n]);const ss=xs();return e.jsxs(wr,{display:"flex",flexDirection:"column",height:"100%",children:[e.jsx(Yr,{Icon:_r,title:"Settings",selector:e.jsxs(kr,{onChange:(rs,Je)=>{ss.push(Je)},value:ms(),children:[e.jsx(Le,{value:"/integrations",label:"Integrations"}),e.jsx(Le,{value:"/k8s",label:"K8s Integrations"}),e.jsx(Le,{value:"/collection",label:"Log Collection Status"})]}),actions:!s&&e.jsx(Or,{setIntegrationSteps:E,initialOpened:((qe=n.state)==null?void 0:qe.addIntegration)==="openTooltip"})}),ts>0?e.jsx(To,{accounts:o,slacks:c,webhooks:p,azureIntegrations:q,ytIntegrations:S,snIntegrations:Z,cve_integrations:x,dp_integrations:A,edr_integrations:f,jira_integrations:C,oktaIntegrations:ge,addAwsModal:()=>E(ve),addAzureModal:()=>E(nt),addSlackModal:()=>E(ze),addWebhookModal:()=>E(rt),addSnykModal:()=>E(Pr)}):Ve||Ye?e.jsx(O,{children:Ve?e.jsx(ae,{}):e.jsx(kt,{error:Ye})}):s?e.jsx(Lo,{}):!Ne&&e.jsx(Eo,{addAwsModal:()=>E(ve),addAzureModal:()=>E(nt)}),Ne&&e.jsx(Vt,{closeDialog:()=>E(!1),dialogOpen:!0,stepsInfo:Ne})," "]})};export{Vo as default};

import{u as v,j as s,c as p,d as h}from"./index-BgJRjf8M.js";import{k,m as C,i as w,j as x,v as b,W as g,d as r,n as m,t as S,p as y,C as F,z as T,o as I,G as R}from"./App-BghU7kAw.js";import{T as W}from"./TextInput-CZVzklyx.js";const j=C(a=>({passwordValidText:{color:a.palette.success.main},link:{display:"flex",justifyContent:"center"},mainTextClass:{marginBottom:a.spacing(2)}})),V=()=>{const[a]=v();return a.token?s.jsx($,{token:a.token}):s.jsx(z,{})};function $({token:a}){const[t,o]=k(""),l=p(),d=h(),c=j(),[u,{loading:n,error:i}]=w(x`
    mutation ResetPassword($input: ResetPasswordInput) {
      resetPassword(input: $input)
    }
  `),e=b(t);async function f(){u({variables:{input:{forgot_password_token:a,password:t}}}).then(()=>{l.replace("/login"),d("Your password has been changed successfully","success")}).catch(()=>{})}return s.jsxs(g,{children:[s.jsxs("div",{children:[s.jsx(r,{variant:"h6",className:c.mainTextClass,children:"Forgot Password?"}),s.jsx(m,{})]}),s.jsx(r,{variant:"body1",children:"Set your new password"}),s.jsx("div",{children:s.jsx(S,{autoFocus:!0,name:"newPassword",variant:"outlined",fullWidth:!0,label:"Set Password",required:!0,...o})}),s.jsx("div",{children:e&&e.map(P=>s.jsx(r,{variant:"body2",children:P}))}),s.jsx(m,{}),s.jsx(y,{startIcon:n&&s.jsx(F,{size:20}),variant:"contained",size:"large",color:"primary",fullWidth:!0,onClick:f,disabled:n||!!e,children:"Set new password"}),i&&s.jsx(r,{color:"error",children:i.message})]})}function z(){const a=p(),t=h(),o=j(),{register:l,getValues:d,formState:{isValid:c}}=T({mode:"onChange"}),[u,{loading:n}]=w(x`
    mutation ForgotPassword($input: ForgotPasswordInput) {
      forgotPassword(input: $input)
    }
  `);async function i(){u({variables:{input:{email:d("email")}}}).then(()=>{a.replace("/login"),t("Check your email for password reset instructions",!1)}).catch(e=>t(e.message,"error"))}return s.jsxs(g,{children:[s.jsxs("div",{children:[s.jsx(r,{variant:"h6",className:o.mainTextClass,children:"Forgot Password?"}),s.jsx(m,{})]}),s.jsx(r,{variant:"body1",children:"Enter your work email address and we'll send you an email with instructions how to reset your password."}),s.jsx(W,{name:"email",fullWidth:!0,variant:"outlined",label:"Email address",...l("email",{validate:e=>e&&/\S+@\S+\.\S+/.test(e)})}),s.jsx(y,{variant:"contained",size:"large",color:"primary",disabled:n||!c,onClick:i,fullWidth:!0,children:"Reset Password"}),s.jsx(I,{color:"textPrimary",variant:"subtitle2",component:R,to:"/login",className:o.link,children:"Cancel"})]})}export{V as default};

import{m as E,H,R as O,a as R,f as q,d as v,e as L,s as W,j as t,q as S,c as M,J as f,r as $}from"./index-lG--m1G-.js";import{a7 as D,p as I,k as C,m as N,W as T,d as w,n as B,T as b,I as K,bg as U,t as V,o as z,G as A,C as F}from"./App-DEb2AZmf.js";import{u as G}from"./login-CNKdjA-N.js";var _={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var l=s(D);function s(o){return o&&o.__esModule?o:{default:o}}var i=(0,l.default)("M12.67 13.67C12.2 14.13 11.63 14.5 11 14.73V23H8V21H5V18H8V14.72C6.26 14.1 5 12.46 5 10.5C5 8 7 6 9.5 6C9.54 6 9.57 6 9.6 6C9.13 6.95 8.92 8 9.03 9.08C8.44 9.28 8 9.84 8 10.5C8 11.33 8.67 12 9.5 12C9.73 12 9.95 11.94 10.15 11.85C10.79 12.69 11.67 13.32 12.67 13.67M20.73 19.44L17.97 20.6L17.19 18.76L14.43 19.93L13.26 17.16L16.03 16L14.76 13C12.91 13.08 11.11 12.05 10.35 10.25C9.39 7.96 10.47 5.32 12.76 4.35C13 4.25 13.26 4.18 13.5 4.12C12.84 2.87 11.5 2 10 2C7.79 2 6 3.79 6 6C6 6.08 6 6.16 6 6.24C5.7 6.5 5.4 6.82 5.15 7.15C5.06 6.78 5 6.4 5 6C5 3.24 7.24 1 10 1S15 3.24 15 6C15 7.42 14.4 8.67 13.45 9.57C13.87 10 14.5 10.13 15.08 9.88C15.85 9.56 16.2 8.68 15.88 7.92C15.85 7.83 15.8 7.74 15.74 7.66C15.9 7.13 16 6.58 16 6C16 5.37 15.9 4.76 15.72 4.19C17 4.55 18.1 5.44 18.65 6.76C19.41 8.56 18.89 10.57 17.5 11.81L20.73 19.44M13 8.6C13.37 8.19 13.65 7.71 13.82 7.18C13.28 7.45 12.97 8 13 8.6Z");e.default=i})(_);const J=E(_);function P(){const{search:e}=H();return O.useMemo(()=>new URLSearchParams(e),[e])}const Q=S.div.withConfig({displayName:"LoginSSO__Or",componentId:"sc-dijush-0"})(["color:",";display:flex;align-items:center;text-align:center;&::before,&::after{content:'';flex:1;border-bottom:1px solid ",";}&:not(:empty)::before{margin-right:0.25em;}&:not(:empty)::after{margin-left:0.25em;}"],e=>e.theme.palette.common.gray,e=>e.theme.palette.divider),Z=S(I).withConfig({displayName:"LoginSSO__LoginButton",componentId:"sc-dijush-1"})(["margin-top:","px;height:44px;font-weight:500;"],e=>e.theme.spacing(4)),X=()=>{var d,m;const{data:e,loading:l}=R(q(`
      query isSsoEnabled($org: String) {
        isSsoEnabled(org: $org)
      }
    `),{variables:{org:((m=(d=window.location.host)==null?void 0:d.split("."))==null?void 0:m[0])||""}}),s=v(),i=P(),{onUserChange:o,onSessionChange:r}=L(),a=i.get("next"),c=i.get("s"),g=i.get("err");if(g&&s(atob(decodeURIComponent(g)),"error"),c)try{const{access_token:h,refresh_token:p,user:u}=JSON.parse(atob(decodeURIComponent(c)));r==null||r({access_token:h,refresh_token:p}),o==null||o(u),W(u),window.location.replace(a||"/")}catch{s("Login failed","error")}return e!=null&&e.isSsoEnabled?t.jsxs("div",{children:[t.jsx(Q,{children:"OR"}),t.jsx(Z,{size:"large",component:"a",href:`${window.location.protocol}//${window.location.host}/sso/login${a?"?next="+encodeURIComponent(a):""}`,variant:"outlined",color:"primary",fullWidth:!0,disabled:l,startIcon:t.jsx(J,{}),children:"Sign in using SSO"})]}):null},Y=N(e=>({mainTextClass:{marginBottom:e.spacing(2)}})),ne=()=>{const[e,l]=C(""),[s,i]=C(""),o=M(),r=P(),{host:a}=L(),[c,g,d]=C(a,f.host,!0);$.useEffect(()=>f.on("CHANGE_HOST",n=>{d(n.detail.host)}),[d]);const m=v(),[h,{loading:p}]=G(),u=e.length>0&&s.length>0&&!p;async function x(){u&&h({variables:{credentials:{email:e,password:s}}}).then(({data:n})=>{var j;(j=n==null?void 0:n.login)!=null&&j.two_factor_state||o.replace(r.get("next")||"/")}).catch(n=>{m(n.message,"error")})}function y(n){n.keyCode===13&&x()}const{mainTextClass:k}=Y();return t.jsxs(T,{children:[t.jsxs("div",{children:[t.jsx(w,{variant:"h6",className:k,children:"Welcome back!"}),t.jsx(B,{light:!0})]}),t.jsx(w,{variant:"body1",children:"Sign in to get started:"}),(r.get("demo")||c||a!==c)&&t.jsx(b,{label:"Host",variant:"outlined",fullWidth:!0,InputProps:{endAdornment:t.jsx(K,{onClick:()=>{f.host("")},children:t.jsx(U,{})})},...g}),t.jsx(b,{label:"Work Email",id:"email-input",fullWidth:!0,variant:"outlined",...l,onKeyDown:y,required:!0}),t.jsx(V,{label:"Password",id:"password-input",fullWidth:!0,variant:"outlined",...i,onKeyDown:y,required:!0}),t.jsx("div",{children:t.jsx(z,{id:"forgot-password-link",color:"primary",variant:"subtitle2",component:A,to:"/reset",children:"Forgot Password?"})}),t.jsx("div",{children:t.jsx(I,{id:"login-button",size:"large",startIcon:p&&t.jsx(F,{size:20}),variant:"contained",color:"primary",fullWidth:!0,onClick:x,disabled:!u,children:"Log in"})}),t.jsx(X,{})]})};export{ne as LoginPage,ne as default};

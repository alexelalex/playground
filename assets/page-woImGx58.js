import{aF as xe,R as J,F as Jn,j as e,q as f,ag as Kn,a9 as Qt,n as de,l as S,r as d,a4 as B,C as ae,a8 as q,aU as Ie,aV as Lt,d as U,t as X,w as Zn,aW as nt,aX as Z,a as M,V as lt,e as Yt,o as Xn,I as Jt,X as es,H as ct,$ as ts,B as ns,g as ss,f as A,aY as I,p as je,ah as is,a2 as ke,aZ as zt,h as dt,v as Kt,c as Zt,a_ as os,x as Xt,a$ as st,S as ut,i as le}from"./index-Ba6YVotX.js";import{L as _,b as k,d as m,eT as en,a6 as Ee,c0 as De,hQ as it,cZ as V,T as L,cX as Ye,gk as Ne,di as Te,hR as as,bY as Ae,hS as we,bj as Fe,dZ as rs,f3 as ls,fr as cs,aw as b,gC as pt,F as ds,c_ as us,c$ as Je,d0 as re,U as te,n as E,N as Oe,O as ce,hT as mt,d3 as tn,i as ye,hU as ot,j as ue,z as nn,hV as ht,hW as ps,hX as sn,I as H,C as se,hY as ms,B as w,cd as be,bN as xt,fq as $e,h as ie,bg as pe,hZ as hs,aZ as Mt,A as on,ap as an,bo as xs,dx as gs,aR as Le,h_ as js,h$ as fs,bt as rn,bu as gt,M as T,bO as O,bP as Se,bv as $,bQ as ys,bR as jt,bS as bs,i0 as _s,i1 as ft,bA as yt,i2 as vs,i3 as ln,i4 as Cs,u as me,bD as cn,g as W,dI as dn,V as bt,aL as _t,aT as un,cA as Rs,ca as ze,dS as Me,cc as Pe,i5 as Ve,i6 as ws,i7 as Ss,i8 as Is,cJ as ks,K as h,ai as ne,i9 as pn,d_ as Es,c2 as mn,b6 as vt,fQ as Ds,ia as Ns,fR as Ts,fh as As,c9 as Ct,fI as Fs,gy as hn,fJ as Os,fW as $s,by as xn,bd as Ls,ib as zs,q as ge,r as Rt,s as wt,ic as gn,dA as Ms,id as Pt,ie as Ps,gx as Vs,cL as Vt,cN as Bs,cO as Ws,d4 as qs,hG as Gs,dj as Us,dk as Hs,dl as Qs,dm as Ys,as as St,R as jn,cF as Js,ig as Ks,g8 as Zs,g5 as Xs,ih as Be,bL as ei,bM as ti,w as ni,S as fn,dL as We,cK as yn,a as Bt,cR as si,at as bn,ah as Ke,bJ as ii,a4 as oi,ii as ai,ij as ri,ik as _n,il as li,im as ci,io as di,eF as ui,ac as vn,af as pi,bU as mi,ip as hi,ag as xi,ae as F,bV as gi,iq as ji,a1 as fi,dC as yi,bX as bi,aY as ee,g6 as _i,bK as vi,g_ as Ci}from"./App-CM6DQiPl.js";import{R as Cn,b as Ri,u as wi,E as Si,c as Ii,d as ki}from"./ExcludeConditions-B_a-5gRA.js";import{C as Rn}from"./CreatedByAvatar-YQVhMxPo.js";import{H as Ei}from"./Header-GcB7EjiI.js";import{u as Di}from"./useRuleFilterValues-B1HM72N0.js";import"./PortsInput-DgwKjCEH.js";const wn=[xe.Security,xe.Cost,xe.Availability,xe.Sustainability,xe.Other];function Sn({form:t}){const{control:n,formState:{errors:s}}=t,o=it("labels"),i=it("compliance");return e.jsxs(_,{gap:3,style:{overflow:"visible"},children:[e.jsxs(_,{gap:2,style:{overflow:"visible"},children:[e.jsx(V,{name:"name",defaultValue:"",control:n,rules:{required:!0},render:({field:a})=>e.jsx(L,{...a,error:!!s.name,helperText:s.name&&"Required",label:"Name",variant:"outlined",required:!0})}),e.jsx(V,{name:"category",defaultValue:"",control:n,rules:{required:!0},render:({field:a})=>e.jsx(L,{...a,error:!!s.category,helperText:s.category&&"Required",label:"Category",variant:"outlined",select:!0,required:!0,children:wn.map(r=>e.jsx(Ye,{value:r,children:e.jsxs(k,{style:{alignItems:"center"},gap:1,children:[e.jsx(Ne,{category:r,fontSize:"small"}),e.jsx(m,{variant:"body2",children:r})]})},r))})}),e.jsx(V,{name:"severity",defaultValue:"",control:n,rules:{required:!0},render:({field:a})=>e.jsx(In,{error:!!s.severity,helperText:s.severity&&"Required",required:!0,...a})}),e.jsx(V,{name:"description",defaultValue:"",control:n,render:({field:a})=>e.jsx(L,{...a,value:a.value||"",label:"Description",variant:"outlined",maxRows:8,multiline:!0})}),e.jsx(V,{name:"finding_type",control:n,render:({field:a})=>e.jsxs(L,{...a,select:!0,InputLabelProps:{shrink:!!a.value},SelectProps:{displayEmpty:!0},value:a.value||"",label:"Finding Type",variant:"outlined",children:[a.value&&e.jsx(Ye,{value:null,children:"None"}),Object.values(Qt).map(r=>e.jsx(Ye,{value:r,children:e.jsx(Te,{findingType:r})},r))]})}),e.jsx(V,{name:"remediation",defaultValue:"",control:n,render:({field:a})=>e.jsx(L,{...a,value:a.value||"",label:"Remediation",variant:"outlined",maxRows:8,multiline:!0})})]}),e.jsxs(_,{gap:1,children:[e.jsx(Ze,{Icon:as,title:"Properties"}),e.jsx(V,{name:"fail_simulation",control:n,defaultValue:!1,render:({field:{onChange:a,value:r}})=>e.jsx(kn,{value:r,onChange:a})})]}),e.jsxs(_,{children:[e.jsx(Ze,{variant:"subtitle2",Icon:Ae,title:"Labels"}),e.jsx(V,{name:"labels",control:n,render:({field:a})=>e.jsx(we,{...a,options:o,placeholder:"Type here (optional)"})})]}),e.jsxs(_,{children:[e.jsx(Ze,{variant:"subtitle2",Icon:Fe,title:"Compliance"}),e.jsx(V,{name:"compliance",control:n,render:({field:a})=>e.jsx(we,{...a,options:i,placeholder:"Type here (optional)"})})]})]})}const In=J.forwardRef(({value:t,onChange:n,helperText:s},o)=>{const i=Jn();return e.jsxs(_,{children:[e.jsxs(k,{gap:2,style:{alignItems:"center"},children:[e.jsx(m,{variant:"caption",color:"textSecondary",children:"Severity"}),e.jsx(k,{gap:1,children:en((a,r)=>e.jsx(Kn,{onClick:()=>n(r),value:r,style:{border:`solid 1px ${t===r?i.palette.action.selected:i.palette.dividerLight}`,borderRadius:i.shape.borderRadius,background:t===r?i.palette.action.selected:i.palette.background.default,padding:i.spacing(1)},children:e.jsxs(k,{style:{alignItems:"center"},gap:1,children:[e.jsx(Ee,{severity:r}),e.jsx(m,{variant:"body2",children:a})]})},r))})]}),s&&e.jsx(Ni,{children:s})]})}),Ni=f(m).withConfig({displayName:"RuleMetadataForm__ErrorMessage",componentId:"sc-1ypwxla-0"})(({theme:t})=>({color:t.palette.common.red,marginLeft:t.spacing(2)}));function kn({value:t,onChange:n}){return e.jsxs(k,{gap:2,children:[e.jsx(De,{checked:t,onChange:()=>n(!t),size:"small"}),e.jsx(m,{children:"Force fail violating simulation"})]})}const Ze=({Icon:t,title:n,variant:s="subtitle1",actions:o})=>e.jsxs(Ti,{$spacing:s==="subtitle1"?3:2,children:[e.jsx(t,{color:"action"}),e.jsx(m,{variant:s,children:n}),e.jsx("div",{style:{flexGrow:1}}),o]}),Ti=f(k).withConfig({displayName:"RuleMetadataForm__SubtitleBox",componentId:"sc-1ypwxla-1"})(({theme:t,$spacing:n})=>({marginBottom:t.spacing(n),alignItems:"center"})),En=({form:t})=>{const{watch:n,control:s,formState:{errors:o},setValue:i}=t,a=n("path_intermediate_predicates"),r=n("subject"),c=S.some(a,({resource_id:l,resource_type:p})=>l===void 0&&p===void 0);return d.useEffect(()=>{c&&r===B.Intermediate&&i("subject","")},[c,r,i]),e.jsx(Fi,{className:cs({error:o.subject}),children:e.jsxs(k,{style:{alignItems:"center"},gap:1,children:[e.jsx(b,{icon:e.jsx(pt,{color:"primary",fontSize:"small"}),label:"Apply violation on :"}),e.jsx(V,{name:"subject",defaultValue:"",control:s,rules:{required:!0},render:({field:l})=>e.jsx(ds,{component:"fieldset",children:e.jsxs(us,{...l,"aria-label":"options",style:{flexDirection:"row"},name:"options",children:[e.jsx(Je,{value:B.Source,control:e.jsx(re,{color:"primary"}),label:ae(B.Source)}),e.jsx(te,{placement:"top",title:c&&"Intermediate cannot be Any and marked as violated",children:e.jsx(Je,{value:B.Intermediate,control:e.jsx(re,{color:"primary"}),disabled:c,label:ae(B.Intermediate)})}),e.jsx(Je,{value:B.Destination,control:e.jsx(re,{color:"primary"}),label:ae(B.Destination)})]})})}),e.jsx(te,{title:"Select the resource that will trigger a violation if the rule’s criteria are met.",children:e.jsx($i,{color:"action"})}),!!o.subject&&e.jsxs(k,{gap:1,style:{marginLeft:"auto",alignItems:"center"},children:[e.jsx(Ai,{}),e.jsx(Oi,{children:"This field is required"})]})]})})},Ai=f(rs).withConfig({displayName:"RuleSubjectSelection__ErrorMessageIcon",componentId:"sc-12lm3i7-0"})(["color:",";"],t=>t.theme.palette.error.main),Fi=f.div.withConfig({displayName:"RuleSubjectSelection__StyledRuleSubjectSelection",componentId:"sc-12lm3i7-1"})(["padding:","px;border-top:1px solid ",";&.error{border-top:none;background-color:",";}"],t=>t.theme.spacing(2),t=>t.theme.palette.divider,t=>de(t.theme.palette.primary.light,.2)),Oi=f(m).withConfig({displayName:"RuleSubjectSelection__ErrorMessage",componentId:"sc-12lm3i7-2"})(["color:",";"],t=>t.theme.palette.error.main),$i=f(ls).withConfig({displayName:"RuleSubjectSelection__HelpIconWrapper",componentId:"sc-12lm3i7-3"})(["margin-left:","px;cursor:pointer;"],t=>t.theme.spacing(1));function Li({form:t}){const{watch:n}=t,[s,o]=d.useState("conditions"),i=n("rule_type");return e.jsxs(zi,{children:[e.jsx(Wi,{children:e.jsx(Sn,{form:t})}),e.jsx(E,{orientation:"vertical",flexItem:!0}),e.jsxs(Vi,{children:[e.jsxs(Mi,{children:[e.jsxs(Oe,{value:s,onChange:(a,r)=>o(r),children:[e.jsx(ce,{value:"conditions",label:"Rule Conditions",icon:e.jsx(mt,{color:"action",fontSize:"small"})}),e.jsx(ce,{value:"exclusions",label:"Exclude Conditions",icon:e.jsx(tn,{color:"action",fontSize:"small"})})]}),e.jsx(E,{light:!0}),e.jsxs(Pi,{children:[s==="conditions"&&e.jsx(Cn,{form:t}),s==="exclusions"&&e.jsx(Ri,{form:t})]})]}),s==="conditions"&&q.Path===i&&e.jsx(Bi,{children:e.jsx(En,{form:t})})]})]})}const zi=f.div.withConfig({displayName:"RuleForm__Container",componentId:"sc-14bxo4s-0"})(({theme:t})=>({display:"flex",flexDirection:"row",gap:t.spacing(2),height:"100%"})),Mi=f.div.withConfig({displayName:"RuleForm__Content",componentId:"sc-14bxo4s-1"})({overflow:"auto",position:"relative",flexGrow:1}),Pi=f.div.withConfig({displayName:"RuleForm__ContentWrapper",componentId:"sc-14bxo4s-2"})(({theme:t})=>({padding:t.spacing(2,0)})),Vi=f.div.withConfig({displayName:"RuleForm__MainColumn",componentId:"sc-14bxo4s-3"})({display:"flex",flexDirection:"column",overflow:"auto",position:"relative",height:"100%",flexGrow:1}),Bi=f.div.withConfig({displayName:"RuleForm__Footer",componentId:"sc-14bxo4s-4"})({position:"sticky",bottom:0}),Wi=f.div.withConfig({displayName:"RuleForm__LeftColumn",componentId:"sc-14bxo4s-5"})(({theme:t})=>({maxWidth:400,overflow:"auto",paddingTop:t.spacing(1),flexGrow:1}));function qi(){return ye(ue`
      mutation CreateRule($rule: RuleInput!) {
        createRule(rule: $rule) {
          ...RuleFields
        }
      }
      ${ot}
    `,{update(t,{data:{createRule:n}}){t.modify({fields:{rules(s={}){const o=t.writeFragment({data:n,fragment:ot,fragmentName:"RuleFields"});return{...s,results:[...s.results||[],o]}}}})}})}function It(t,n={rule_type:q.Path,state:Ie.Enabled,fail_simulation:!1}){return nn({mode:"onChange",defaultValues:S.omit(S.defaults(t,n),ht)})}function Gi(t){const{systemMessage:n,onResponse:s,onError:o}=t,[i,a]=d.useState([]),[r,c]=d.useState(!1),l=ps();return{messages:i,loading:r,clearMessages:()=>{a([])},sendPrompt:async p=>{console.log("sendPrompt",p),c(!0);const u=[...i,{content:Array.isArray(p)?p.map(x=>typeof x=="string"?x:JSON.stringify(x)).join(`
`):p,role:Lt.User}];a(u);try{const x=await l("chat",{method:"POST",body:JSON.stringify({messages:u,systemMessage:n})}),j=await Ui(x);return s==null||s(j),console.log("sendPromptResult",j),a(g=>[...g,{content:j,role:Lt.Assistant}]),j}catch(x){console.error(x),o==null||o(x)}finally{c(!1)}}}}async function Ui(t){const n=Hi(t);let s="";for await(const o of n)s+=o;return s}async function*Hi(t){const n=new TextDecoder("utf-8");if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);if(!t.body)throw new Error("ReadableStream not supported in this browser.");const s=t.body.getReader();let o="";for(;;){const{done:i,value:a}=await s.read();if(i)break;const r=n.decode(a,{stream:!0});o+=r,yield r}return o}function Qi(t){const{placeholder:n="Type your prompt here",systemMessage:s="ONLY respond with valid JSON (string, array or object), e.g., 'option' or ['option1','option2'] or {'key': 'value'}",onPrompt:o,trigger:i}=t,a=U(),[r,c]=d.useState(""),[l,p]=d.useState(!1),{loading:u,sendPrompt:x,clearMessages:j}=Gi({systemMessage:s});Yi("keydown",R=>{R.key==="a"&&R.ctrlKey&&p(!0)});async function g(R){await(o==null?void 0:o({prompt:R,notify:a,decide:async(C,...D)=>Array.isArray(C)?Wt(await x([{pick_an_option:C,user_input:R,hint:D.join(`
`),guideline:"Pick an option from the list"}])):Wt(await x([{user_input:R,hint:D.join(`
`),guideline:"Provide a valid JSON response",...C}]))})),c("")}function v(){j(),p(!1),c("")}return!i||l?e.jsx(L,{value:r,onChange:R=>c(R.target.value),variant:"outlined",placeholder:n,size:"small",fullWidth:!0,disabled:u,InputProps:{startAdornment:e.jsxs(e.Fragment,{children:[e.jsx(sn,{color:r?"action":"primary",fontSize:"small"})," "]}),endAdornment:e.jsx(H,{size:"small",color:r?"primary":"default",disabled:!r||u,onClick:()=>{g(r)},children:u?e.jsx(se,{size:15}):e.jsx(ms,{fontSize:"small",color:r?"primary":"action"})})},autoFocus:!0,onKeyDown:R=>{R.key==="Enter"&&g(r),R.key==="Escape"&&(v(),R.stopPropagation())}}):J.cloneElement(i,{onClick:()=>p(!0)})}function Wt(t){try{return JSON.parse(t)}catch{try{return JSON.parse(t.substring(t.indexOf("{"),t.lastIndexOf("}")+1))}catch{throw new Error(`Invalid JSON: ${t}`)}}}function Yi(t,n){d.useEffect(()=>(document.addEventListener(t,n),()=>{document.removeEventListener(t,n)}),[t])}function Ji(t){return e.jsx(Qi,{placeholder:"Suggest a rule that will...",trigger:e.jsx(te,{title:"Suggest a rule using AI",children:e.jsx(w,{startIcon:e.jsx(sn,{}),size:"small",variant:"text",children:"AI Suggestion"})}),onPrompt:async({prompt:n,decide:s,notify:o})=>{try{const i=await s(Object.values(q),"What type of rule best suits this prompt?"),a=i===q.Resource?Zi:Ki,r=await s(Object.keys(X),"What type of resources this rule should apply to?"),c=S.pick(S.mapValues(X,u=>u.attributes),Array.isArray(r)?r:[r]),l=i===q.Resource?"resource_predicates":"source_predicates, intermediate_predicates, destination_predicates",p=await s({prompt:`Create or modify a rule that will ${n}`,current_values:t.form.getValues(),mandatory_fields:l,example_rule:a,attributes:c});return t.form.reset(p),p}catch(i){console.error(i),o==null||o(`Failed to suggest a rule: ${i.message}`,"error")}}})}const Ki={name:"Ensure there is no unrestricted inbound access to TCP port 1434 (MSSQL)",category:"Security",severity:4,description:"Ensure your security groups don’t allow inbound rules on TCP port 1434 (MSSQL) for unrestricted resources.",rule_type:q.Path,subject:"destination",path_source_predicate_equals_match:!0,path_intermediate_predicate_equals_match:!0,path_destination_predicate_equals_match:!0,path_intermediate_predicate_operand:"OR",path_source_predicates:[{resource_type:"Internet"}],path_intermediate_predicates:[{resource_type:"security_group",attributes:{operand:"AND",attributes_list:[{name:"security_ingress_rule",operand:"AND",__typename:"ConditionAttribute",attributes_list:[{name:"IngressCidrIp",value:["0.0.0.0/0"],match_type:"equals"},{name:"IngressFromPort",value:[1435],match_type:"less_than"},{name:"IngressToPort",value:[1433],match_type:"greater_than"},{name:"IngressIpProtocol",value:["tcp"],match_type:"equals"}]},{name:"security_ingress_rule",operand:"AND",attributes_list:[{name:"IngressCidrIp",value:["0.0.0.0/0"],match_type:"equals"},{name:"IngressFromPort",value:[-1],match_type:"not_equals"},{name:"IngressToPort",value:[-1],match_type:"not_equals"}]},{name:"security_ingress_rule",operand:"AND",attributes_list:[{name:"IngressCidrIp",value:["0.0.0.0/0"],match_type:"equals"},{name:"IngressFromPort",value:[0],match_type:"not_equals"},{name:"IngressToPort",value:[65535],match_type:"not_equals"}]}]}}],path_destination_predicates:[],ports:[{start:1434,end:1434,protocol:"TCP"}]},Zi={name:"Unused IAM Roles for more than 90 days",category:"Security",severity:3,description:"IAM roles are considered unused if there has been no usage/activity for these roles in the past 90 days.",rule_type:q.Resource,resource_predicates:[{resource_type:"iam_role",attributes:{operand:"AND",attributes_list:[{name:"WeeksSinceLastUsedDate",value:[12],match_type:"greater_than"}]}}]};function Xi({rule:t}){const n=xt(),s=U(),[o,i]=d.useState(!1),a=It(t),r=$e(),[c,{loading:l}]=qi(),p=d.useCallback(async({isDraft:x}={})=>{const j=a.getValues();x&&(j.state=Ie.Draft),j.rule_type===q.Resource&&delete j.subject;const g=await c({variables:{rule:S.omit(j,["exclusions"])}});r({ruleId:g.data.createRule.id,tab:"conditions"})},[c,a,r]),u=d.useCallback(async({isDraft:x}={})=>{i(x??!1),await a.trigger(),a.formState.isValid&&p({isDraft:x}).then(()=>{s("Rule updated successfully","success"),n.close()}).catch(j=>{s(j.message,"error")})},[n,a,s,p]);return e.jsxs(eo,{children:[e.jsx(ie,{title:e.jsx(m,{variant:"subtitle1",children:"Create New Rule"}),actions:e.jsx(H,{onClick:n.close,children:e.jsx(pe,{})})}),e.jsx(io,{children:e.jsx(Li,{form:a})}),e.jsxs(no,{children:[e.jsx(hs,{children:e.jsx(Ji,{form:a})}),e.jsx("div",{style:{flexGrow:1}}),e.jsx(to,{variant:"outlined",onClick:n.close,children:"Discard"}),e.jsx(w,{startIcon:l&&o&&e.jsx(Mt,{}),variant:"text",onClick:()=>u({isDraft:!0}),disabled:l,children:"Save as draft"}),e.jsx(so,{startIcon:l&&!o&&e.jsx(Mt,{}),variant:"contained",color:"primary",onClick:()=>u(),disabled:l,children:"Publish"})]})]})}const eo=f(_).withConfig({displayName:"RuleDialog__Container",componentId:"sc-1un052n-0"})({height:"100%"}),to=f(w).withConfig({displayName:"RuleDialog__DiscardButton",componentId:"sc-1un052n-1"})(({theme:t})=>({color:t.palette.common.red,borderColor:t.palette.common.red})),no=f(be).withConfig({displayName:"RuleDialog__Footer",componentId:"sc-1un052n-2"})(({theme:t})=>({padding:t.spacing(2)})),so=Zn(t=>({root:{...t.palette.type==="dark"?{background:t.palette.primary.main,color:t.palette.primary.contrastText}:{background:t.palette.common.black,color:t.palette.primary.contrastText}}}))(w),io=f.div.withConfig({displayName:"RuleDialog__Content",componentId:"sc-1un052n-3"})(({theme:t})=>({overflow:"auto",flexGrow:1,flexBasis:0,padding:t.spacing(2),borderBottom:`solid 1px ${t.palette.dividerLight}`}));function kt(){const t=xt(),n=d.useCallback(s=>t.open(()=>e.jsx(Xi,{rule:s}),{size:"xl"}),[t]);return d.useMemo(()=>({createRule(){return n()},createRuleFromTemplate(s){return n(S.omit(s,ht))}}),[n])}function oo({allRules:t,hasFilters:n,filterOnlyViolations:s,onClick:o}){const i=kt();return e.jsx(ro,{children:n?s?e.jsxs(_,{style:{alignItems:"center"},children:[e.jsx(m,{color:"textSecondary",children:"There are no actively violated rules"}),e.jsxs(w,{size:"small",variant:"text",onClick:o,children:["Show available rules (",t.length,")"]})]}):e.jsxs(_,{style:{alignItems:"center"},children:[e.jsx(m,{color:"textSecondary",children:"No rules matched"}),e.jsx(w,{size:"small",variant:"text",onClick:o,children:"Clear filters"})]}):e.jsx(ao,{variant:"outlined",startIcon:e.jsx(on,{color:"action"}),onClick:i.createRule,children:"New Rule"})})}const ao=f(w).withConfig({displayName:"RulesEmpty__CustomButton",componentId:"sc-kiet4k-0"})(({theme:t})=>({background:t.palette.background.paper})),ro=f.div.withConfig({displayName:"RulesEmpty__EmptyContainer",componentId:"sc-kiet4k-1"})(({theme:t})=>({maxHeight:400,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flexGrow:1})),Dn=J.createContext();function lo({allRules:t,rules:n,values:s,loadingAccountsData:o,onChange:i,isEventView:a,hideAccounts:r,...c}){return e.jsx(Dn.Provider,{value:{onChange:i,values:s},children:e.jsxs(ho,{...c,children:[!a&&e.jsx(mo,{}),e.jsx(an,{filterValues:s,filters:co({allRules:t,rules:n,isEventView:a,hideAccounts:r}),onChange:i})]})})}function co({allRules:t,rules:n,isEventView:s,hideAccounts:o}){const i=d.useMemo(()=>S.chain(["labels","compliance","created_by"]).keyBy().mapValues(g=>S.chain(t).map(g).flatten().uniq().compact().sort().value()).value(),[t]),a=(g,v)=>{switch(v){case"account_ids":case"compliance":case"labels":return S.chain(g).map(({id:R,[v]:C})=>C==null?void 0:C.map(D=>({rule_id:R,[v]:D}))).flatten().groupBy(v).value();default:return S.groupBy(g,v)}},r=d.useMemo(()=>S.chain(["severity","category","compliance","created_by","labels","status","state","rule_type","account_ids"]).keyBy().mapValues(g=>a(n,g)).value(),[n]),c=d.useMemo(()=>S.chain(["severity","category","compliance","created_by","labels","status","state","rule_type","account_ids"]).keyBy().mapValues(g=>a(t,g)).value(),[t]),[l,{loading:p,error:u}]=xs(),x=gs(),j=d.useMemo(()=>({attr:g,value:v})=>{var D,G,oe,Q;const R=((G=(D=r[g])==null?void 0:D[v])==null?void 0:G.length)||0,C=((Q=(oe=c[g])==null?void 0:oe[v])==null?void 0:Q.length)||0;return e.jsxs(m,{color:"textSecondary",children:["(",C!==R?`${R}/${C}`:R,")"]})},[c,r]);return d.useMemo(()=>[...o?[]:[{key:"account_ids",defaultOpen:!0,displayName:"Account",loading:p,error:u,renderOption:g=>e.jsx(b,{label:x(g),action:e.jsx(j,{attr:"account_ids",value:g}),actionVisible:!0}),searchableOptions:!0,options:l==null?void 0:l.map(g=>({value:g.cloud_account_id,filterBy:g.display_name}))}],{key:"severity",displayName:"Severity",renderOption:g=>e.jsx(b,{label:Le(g),icon:e.jsx(Ee,{severity:g}),action:e.jsx(j,{attr:"severity",value:g}),actionVisible:!0}),options:en((g,v)=>v)},{key:"labels",displayName:"Labels",options:i.labels||[],searchableOptions:!0,renderOption:g=>e.jsx(b,{label:g,action:e.jsx(j,{attr:"labels",value:g}),actionVisible:!0})},{key:"compliance",displayName:"Compliance",options:i.compliance||[],searchableOptions:!0,renderOption:g=>e.jsx(b,{label:g,action:e.jsx(j,{attr:"compliance",value:g}),actionVisible:!0})},{key:"finding_type",displayName:"Finding Type",options:Object.values(Qt),searchableOptions:!0,renderOption:g=>e.jsx(Te,{findingType:g})},{key:"created_by",displayName:"Creators",options:i.created_by||[],searchableOptions:!0,renderOption:g=>e.jsx(b,{label:g,action:e.jsx(j,{attr:"created_by",value:g}),actionVisible:!0})},{key:"category",defaultOpen:!0,displayName:"Category",options:wn,renderOption:g=>e.jsx(b,{label:g,icon:e.jsx(Ne,{category:g,fontSize:"small",color:"action"}),action:e.jsx(j,{attr:"category",value:g}),actionVisible:!0})},{key:"rule_type",displayName:"Rule Type",options:uo,renderOption:g=>e.jsx(b,{label:ae(g),action:e.jsx(j,{attr:"rule_type",value:g}),actionVisible:!0})},...s?[]:[{key:"status",displayName:"Status",options:po,renderOption:g=>e.jsx(b,{label:ae(g),action:e.jsx(j,{attr:"status",value:g}),actionVisible:!0})}]].sort((g,v)=>g.displayName>v.displayName?1:-1),[l,u,p,x,o,s,i.compliance,i.created_by,i.labels])}const uo=["path","resource"],po=["pending","processing","active","invalid"];function mo(){return e.jsxs(e.Fragment,{children:[e.jsx(b,{icon:e.jsx(Xe,{defaultOn:!0,attr:"only_violations"}),label:"Violated rules"}),e.jsx(b,{icon:e.jsx(Xe,{attr:"archived"}),label:"Archived rules"}),e.jsx(b,{icon:e.jsx(Xe,{attr:"fail_simulation"}),label:"Fail simulation"})]})}const ho=f.div.withConfig({displayName:"RulesFilters__Container",componentId:"sc-1q1lns5-0"})(({theme:t})=>({overflow:"auto","& > *":{marginBottom:t.spacing(1)}})),Xe=({attr:t,defaultOn:n=!1})=>{const{onChange:s,values:o}=d.useContext(Dn),i=nt(o==null?void 0:o[t],n),a=d.useCallback(()=>{s({...o,[t]:!i})},[t,s,o,i]);return e.jsx(De,{checked:i,onChange:a,size:"small"})},Nn=["resource_predicates","path_source_predicates","path_intermediate_predicates","path_destination_predicates","exclusion_predicates"];function Et(){const[t,n]=ye(ue`
      mutation EditRule($id: ID!, $rule: RuleInput!) {
        editRule(id: $id, rule: $rule) {
          ...RuleFields
        }
      }
      ${ot}
    `);return[d.useCallback((o,i)=>(i=S.mapValues(i,(a,r)=>Nn.includes(r)?xo(a):a),t({variables:{id:o,rule:i}}).then(({data:a})=>S.omit(a==null?void 0:a.editRule,ht))),[t]),n]}function xo(t){return S.compact(t==null?void 0:t.map(n=>{var s,o;return n=S.omitBy(n,S.isNil),delete n.__typename,n.tags&&!((o=(s=n==null?void 0:n.tags)==null?void 0:s.attributes_list)!=null&&o.length)&&delete n.tags,Object.keys(n).length===0?null:n}))}function go({rule:t}){const{triggerProps:n,menuProps:s}=js({stopPropagation:!0}),{onClose:o}=s,[i]=Et(),a=$e(),r=kt(),c=fs(),l=U(),p=d.useCallback(async(C,D)=>{C.stopPropagation(),D&&await D(),o()},[o]),u=d.useCallback(async C=>i(t.id,{state:C}).then(()=>l("Rule updated successfully","success")).catch(D=>l(D.message,"error")),[i,l,t.id]),x=d.useCallback(()=>u("disabled"),[u]),j=d.useCallback(()=>u("enabled"),[u]),g=d.useCallback(()=>u("archived"),[u]),v=d.useCallback(()=>a({ruleId:t.id,state:{editMode:!0}}),[a,t.id]),R=d.useCallback(async()=>{r.createRuleFromTemplate(await c(t.id))},[c,t.id,r]);return e.jsxs(e.Fragment,{children:[e.jsx(H,{size:"small",...n,children:e.jsx(rn,{fontSize:"small"})}),e.jsxs(gt,{...s,children:[t.state==="enabled"&&e.jsxs(T,{onClick:C=>p(C,x),children:[e.jsx(O,{children:e.jsx(Se,{fontSize:"small"})}),e.jsx($,{primary:"Disable"})]}),t.state==="disabled"&&e.jsxs(T,{onClick:C=>p(C,j),children:[e.jsx(O,{children:e.jsx(ys,{fontSize:"small"})}),e.jsx($,{primary:"Enable"})]}),t.state!=="archived"&&e.jsxs(T,{onClick:C=>p(C,v),children:[e.jsx(O,{children:e.jsx(jt,{fontSize:"small"})}),e.jsx($,{primary:"Edit details"})]}),t.state!=="draft"&&e.jsxs(T,{onClick:C=>p(C,R),children:[e.jsx(O,{children:e.jsx(bs,{fontSize:"small"})}),e.jsx($,{primary:"Copy as template"})]}),t.state==="draft"&&e.jsxs(T,{onClick:C=>p(C,j),children:[e.jsx(O,{children:e.jsx(_s,{fontSize:"small"})}),e.jsx($,{primary:"Publish"})]}),t.state!=="archived"&&t.state!=="draft"&&e.jsxs(T,{onClick:C=>p(C,g),children:[e.jsx(O,{children:e.jsx(ft,{fontSize:"small"})}),e.jsx($,{primary:"Archive"})]})]})]})}function Dt({rule:t}){return t.status===Z.Invalid?e.jsx(yo,{icon:e.jsx(yt,{fontSize:"small",color:"error"}),label:"Invalid",labelColor:"error"}):t.state===Z.Error?e.jsx(qt,{icon:e.jsx(Se,{fontSize:"small",color:"error"}),label:"Error",labelColor:"error"}):t.state===Z.Disabled?e.jsx(qt,{icon:e.jsx(Se,{fontSize:"small",color:"action"}),label:"Disabled"}):t.state===Z.Archived?e.jsx(b,{icon:e.jsx(ft,{fontSize:"small",color:"action"}),label:"Archived"}):t.state===Z.Draft?e.jsx(fo,{icon:e.jsx(vs,{fontSize:"small",color:"action"}),label:"Draft"}):t.status===Z.Pending?e.jsx(b,{icon:e.jsx(ln,{fontSize:"small",color:"action"}),label:"Pending"}):t.status==="processing"?e.jsx(jo,{icon:e.jsx(Cs,{fontSize:"small",color:"primary"}),label:"Processing",labelColor:"primary"}):e.jsx(b,{labelColor:"textSecondary",label:t.status===Z.Inactive?"Inactive":"Active"})}const qe=f(b).withConfig({displayName:"RuleStatus__Tag",componentId:"sc-185ln2d-0"})(({theme:t})=>({borderRadius:t.shape.borderRadius/2,maxWidth:"fit-content",padding:t.spacing(.5,1,.5,.5)})),jo=f(qe).withConfig({displayName:"RuleStatus__ProcessingTag",componentId:"sc-185ln2d-1"})(({theme:t})=>({background:de(t.palette.primary.main,.25)})),qt=f(qe).withConfig({displayName:"RuleStatus__DisabledTag",componentId:"sc-185ln2d-2"})(({theme:t})=>({background:de(t.palette.common.gray,.25)})),fo=f(qe).withConfig({displayName:"RuleStatus__DraftTag",componentId:"sc-185ln2d-3"})(({theme:t})=>({border:`solid 1px ${t.palette.divider}`})),yo=f(qe).withConfig({displayName:"RuleStatus__InvalidTag",componentId:"sc-185ln2d-4"})(({theme:t})=>({background:de(t.palette.error.main,.15)}));function bo(t,{filters:n,...s}={}){var r,c;const{data:o,...i}=M(ue`
      query RulesCostQuery($ids: [String!], $filters: RulesCostFilters) {
        rules_cost(rules_ids: $ids, filters: $filters) {
          rule_id
          predicted_cost
        }
      }
    `,{...s,variables:{ids:[t],filters:n}});return[(c=(r=o==null?void 0:o.rules_cost)==null?void 0:r[0])==null?void 0:c.predicted_cost,i]}function _o({rule:t,filters:n,...s}){const[o,{loading:i}]=bo(t.id,{skip:t.category!=="Cost",filters:n});return e.jsx("div",{...s,children:i?e.jsx(se,{size:15}):o>0?e.jsx(m,{children:`$${Number(o).toLocaleString(void 0,{maximumFractionDigits:2})}`}):e.jsx(m,{color:"textSecondary",children:"—"})})}function vo({rules:t,selected:n,filtersValues:s,setSelected:o,focusRuleId:i,...a}){const r=d.useRef(null),c=$e(),l=d.useCallback(u=>{s&&s.account_ids?c({ruleId:u.id,filters:{account:s.account_ids}}):c({ruleId:u.id})},[s,c]);d.useEffect(()=>{if(i){const u=t.findIndex(x=>x.id===i);u>-1&&setTimeout(()=>{var x;return(x=r.current)==null?void 0:x.scrollToItem(u)})}},[i,t]);const p=d.useCallback(()=>{n.size>0?o(new Set):o(new Set(t.map(u=>u.id)))},[t,n.size,o]);return e.jsxs(Co,{...a,children:[e.jsxs(ko,{children:[e.jsxs(k,{gap:1,className:"cell name-cell",style:{alignItems:"center"},children:[e.jsx(cn,{size:"small",checked:n.size>0,indeterminate:n.size>0&&n.size!==(t==null?void 0:t.length),onClick:p}),e.jsx(Tn,{style:{visibility:"hidden"}}),e.jsx(m,{children:"Name"})]}),e.jsx(m,{className:"cell category-cell",children:"Category"}),e.jsx(m,{className:"cell status-cell",children:"Status"}),e.jsx(m,{className:"cell violations-cell",children:"Violations"}),e.jsx(m,{className:"cell exclude-cell",children:"Excluded"}),e.jsx(m,{className:"cell labels-cell",children:"Labels"}),e.jsx(m,{className:"cell time-cell",children:"Created"}),e.jsx(m,{className:"cell compliance-cell",children:"Compliance"}),e.jsx(m,{className:"cell finding-type-cell",children:"Finding Type"}),e.jsx(m,{className:"cell cost-cell",children:"Predicted Saving"}),e.jsx("span",{className:"cell actions-cell"})]}),e.jsx(Io,{children:e.jsx(Rs,{ref:r,data:t,itemData:{selected:n,setSelected:o},itemCount:(t==null?void 0:t.length)||0,itemSize:55,ItemComponent:Ro,onItemClick:l})})]})}const Co=f.div.withConfig({displayName:"RulesList__Container",componentId:"sc-1iiyukw-0"})({display:"flex",minWidth:1300,flexDirection:"column",flexGrow:1}),Ro=J.forwardRef(({item:t,itemData:{selected:n,setSelected:s}},o)=>{var l,p,u,x,j;const[i]=me("f"),a=t==null?void 0:t.violationsCount,r=d.useCallback(g=>{g.stopPropagation();const v=new Set(n);n.has((t==null?void 0:t.id)??"")?v.delete((t==null?void 0:t.id)??""):v.add((t==null?void 0:t.id)??""),s(v)},[t,n,s]),c=d.useMemo(()=>({account:i==null?void 0:i.account_ids}),[i]);return e.jsx(wo,{ref:o,children:e.jsxs(So,{children:[e.jsxs(k,{gap:1,className:"cell name-cell",children:[e.jsx("div",{children:e.jsx(cn,{size:"small",checked:n.has((t==null?void 0:t.id)??""),onClick:r})}),e.jsx(Tn,{severity:t==null?void 0:t.severity,violationsCount:a}),e.jsxs(_,{children:[e.jsx(W,{children:e.jsx(m,{variant:"subtitle2",noWrap:!0,children:t.name})}),e.jsx(W,{children:e.jsx(m,{color:"textSecondary",noWrap:!0,children:t.description})})]})]}),e.jsx("div",{className:"cell category-cell",children:e.jsx(b,{icon:e.jsx(Ne,{fontSize:"small",color:"action",category:t.category}),label:t.category})}),e.jsx("div",{className:"cell status-cell",children:e.jsx(Dt,{rule:t})}),e.jsx(b,{className:"cell violations-cell",style:{opacity:a>0?1:.4},icon:e.jsx(Ee,{severity:t.severity}),label:a>0?a:"—"}),e.jsx(b,{className:"cell exclude-cell",icon:t.exclusions_count?e.jsx(dn,{color:"action",fontSize:"small"}):null,label:t.exclusions_count?t.exclusions_count:""}),e.jsx(b,{className:"cell labels-cell",style:{opacity:(l=t.labels)!=null&&l.length?1:.4},icon:(p=t.labels)!=null&&p.length?e.jsx(bt,{title:"Labels",content:e.jsx(Eo,{labels:t.labels}),children:e.jsx(Ae,{fontSize:"small",color:"action"})}):null,label:((u=t.labels)==null?void 0:u.length)||""}),e.jsx(b,{className:"cell time-cell",icon:e.jsx(Rn,{name:t.created_by}),label:_t(t.creation_date,"short_date")}),(x=t.compliance)!=null&&x.length?e.jsx(b,{className:"cell compliance-cell",icon:e.jsx(Fe,{fontSize:"small",color:"action"}),label:(j=t.compliance)==null?void 0:j.join(", ")}):e.jsx(m,{className:"cell compliance-cell",color:"textSecondary",children:"—"}),e.jsx("div",{className:"cell finding-type-cell",color:"textSecondary",children:t.finding_type?e.jsx(Te,{findingType:t.finding_type}):e.jsx(m,{color:"textSecondary",children:"—"})}),e.jsx(_o,{rule:t,filters:c,className:"cell cost-cell"}),e.jsx("span",{className:"cell actions-cell",children:e.jsx(go,{rule:t})})]})})}),wo=f.div.withConfig({displayName:"RulesList__RuleRowBoxWrapper",componentId:"sc-1iiyukw-1"})(({theme:t})=>({paddingBottom:t.spacing(1)})),Tn=f.div.withConfig({displayName:"RulesList__SeverityBar",componentId:"sc-1iiyukw-2"})(({theme:t,severity:n,violationsCount:s})=>({minWidth:5,height:35,borderRadius:t.shape.borderRadius,backgroundColor:s?un(t,n)||t.palette.divider:t.palette.common.green})),Nt=f(k).withConfig({displayName:"RulesList__RowBox",componentId:"sc-1iiyukw-3"})(({theme:t})=>({alignItems:"center",padding:t.spacing(1,1,1,2),borderRadius:t.shape.borderRadius,overflow:"visible","& .cell":{flexGrow:1,flexBasis:0},"& .name-cell":{flexGrow:4,minWidth:150,maxWidth:800},"& .category-cell":{minWidth:100,maxWidth:120},"& .status-cell":{minWidth:100,maxWidth:120},"& .state-cell":{minWidth:100,maxWidth:120},"& .violations-cell, & .labels-cell, & .exclude-cell":{minWidth:50,maxWidth:70},"& .time-cell":{minWidth:80},"& .compliance-cell":{minWidth:100},"& .finding-type-cell":{display:"flex",overflow:"hidden",minWidth:100},"& .cost-cell":{minWidth:80},"& .actions-cell":{maxWidth:50,display:"flex",justifyContent:"flex-end"}}));Nt.defaultProps={gap:2};const So=f(Nt).withConfig({displayName:"RulesList__RuleRowBox",componentId:"sc-1iiyukw-4"})(({theme:t})=>({minHeight:50,backgroundColor:t.palette.background.paper,"&:hover":{backgroundColor:t.palette.action.hover,cursor:"pointer"}})),Io=f.div.withConfig({displayName:"RulesList__Content",componentId:"sc-1iiyukw-5"})(({theme:t})=>({overflow:"hidden",flexGrow:1,flexBasis:0,padding:t.spacing(2)})),ko=f(Nt).withConfig({displayName:"RulesList__GroupHeader",componentId:"sc-1iiyukw-6"})(({theme:t})=>({position:"sticky",background:t.palette.background.paper,borderRadius:0,margin:-t.spacing(2,1,0,1),padding:t.spacing(1,4),top:-t.spacing(1),zIndex:100,alignItems:"center","& .cell":{color:t.palette.text.secondary}})),Eo=({labels:t})=>(t==null?void 0:t.length)>0?t.map((n,s)=>e.jsx(Do,{children:n},s)):e.jsx(m,{variant:"caption",color:"textSecondary",children:"None"}),Do=f.span.withConfig({displayName:"RulesList__LabelBox",componentId:"sc-1iiyukw-7"})(({theme:t})=>({padding:t.spacing(.5,1),background:t.palette.background.paper,color:t.palette.text.primary,margin:t.spacing(0,.5,.5,0),borderRadius:t.shape.borderRadius/2}));function No({allRules:t,rules:n,selectedRuleIds:s,actions:o,loading:i,startAdornment:a}){return e.jsx(ie,{paper:!0,actions:o,title:e.jsxs(e.Fragment,{children:[a,i?e.jsxs(k,{gap:1,style:{alignItems:"center"},children:[e.jsx(se,{size:15}),e.jsx(m,{children:"Loading..."})]}):n&&t&&e.jsxs(e.Fragment,{children:[e.jsx(To,{variant:"subtitle1",children:`${t.length===n.length?n.length:`${n.length}/${t.length}`} rules available`}),s.size>0&&e.jsx(m,{color:"primary",children:`${s.size} selected`})]})]})})}const To=f(m).withConfig({displayName:"RulesListHeader__TitleTypography",componentId:"sc-107p9ec-0"})(({theme:t})=>({paddingLeft:t.spacing(1)}));function Ao({open:t,onClose:n,onEdit:s,selectedRuleIds:o}){const[i,a]=d.useState(!1),[r,c]=d.useState(!1),l=d.useCallback(()=>{s(r),c(!1)},[r,s]);return e.jsxs(ze,{open:t,onClose:n,children:[e.jsxs(Me,{disableTypography:!0,children:[e.jsxs(m,{variant:"subtitle1",children:["Edit force fail simulation (",o.size," rules)"]}),e.jsx("div",{style:{flexGrow:1}}),e.jsx(H,{edge:"end",onClick:n,children:e.jsx(pe,{})})]}),e.jsx(Pe,{children:e.jsxs(_,{gap:2,children:[e.jsx(kn,{value:r,onChange:c}),e.jsx(Ve,{checked:i,onChange:a})]})}),e.jsxs(be,{children:[e.jsx(w,{variant:"text",onClick:n,children:"Cancel"}),e.jsx(w,{color:"primary",onClick:l,children:"Submit"})]})]})}function Fo({open:t,onClose:n,selectedRuleIds:s,onEdit:o}){const[i,a]=d.useState(!1),[r,c]=d.useState(new Set),[l,p]=d.useState(new Set),u=d.useCallback(()=>{c(new Set),p(new Set),o({addCompliance:Array.from(r),removeCompliance:Array.from(l)})},[r,o,l]),x=$o(),j=Oo(s),g=d.useCallback(R=>{p(C=>new Set([...S.difference(j,R),...C]))},[j]),v=d.useCallback(()=>{c(new Set),p(new Set),n(),a(!1)},[n]);return e.jsxs(ze,{open:t,onClose:v,children:[e.jsxs(Me,{disableTypography:!0,children:[e.jsxs(m,{variant:"subtitle1",children:["Edit compliance (",s.size," rules)"]}),e.jsx("div",{style:{flexGrow:1}}),e.jsx(H,{edge:"end",onClick:n,children:e.jsx(pe,{})})]}),e.jsx(Pe,{children:e.jsxs(_,{gap:2,style:{overflow:"visible",minWidth:300},children:[e.jsxs(_,{gap:1,children:[e.jsx(m,{variant:"caption",children:"Compliance to add"}),e.jsx(we,{value:r,options:x,onChange:c,placeholder:"Type here",useSet:!0})]}),e.jsxs(_,{gap:1,children:[e.jsxs(_,{children:[e.jsx(m,{variant:"caption",children:"Common Compliance"}),e.jsx(m,{color:"textSecondary",variant:"caption",children:"You can delete existing labels here"})]}),e.jsx(we,{value:j,onChange:g,disabledLabels:l,placeholder:j.length===0?"No common compliance":"",removeOnly:!0})]}),e.jsx(Ve,{checked:i,onChange:a})]})}),e.jsxs(be,{children:[e.jsx(w,{variant:"text",onClick:v,children:"Cancel"}),e.jsx(w,{color:"primary",onClick:u,disabled:!i||r.size===0&&l.size===0,children:"Submit"})]})]})}function Oo(t){return ws(t,"compliance")}function $o(){return it("compliance")}function Lo({open:t,onClose:n,onEdit:s,selectedRuleIds:o}){const[i,a]=d.useState(!1),[r,c]=d.useState(""),l=d.useCallback(()=>{s(r),c("")},[s,r]);return e.jsxs(ze,{open:t,onClose:n,children:[e.jsxs(Me,{disableTypography:!0,children:[e.jsxs(m,{variant:"subtitle1",children:["Change severity (",o.size," rules)"]}),e.jsx("div",{style:{flexGrow:1}}),e.jsx(H,{edge:"end",onClick:n,children:e.jsx(pe,{})})]}),e.jsx(Pe,{children:e.jsxs(_,{gap:2,children:[e.jsx(In,{value:r,onChange:c}),e.jsx(Ve,{checked:i,onChange:a})]})}),e.jsxs(be,{children:[e.jsx(w,{variant:"text",onClick:n,children:"Cancel"}),e.jsx(w,{color:"primary",disabled:!i||!r,onClick:l,children:"Change Severity"})]})]})}function zo(){const t=lt();return d.useCallback((n,s)=>t.mutate({mutation:Mo,variables:{ids:n,rule:s},update:o=>{for(const i of n)o.writeFragment({id:o.identify({id:i,__typename:"Rule"}),fragment:ue`
              fragment UpdatedRule on Rule {
                ${"state"in s?"state":""}
                ${"severity"in s?"severity":""}
                ${"fail_simulation"in s?"fail_simulation":""}
                ${"labels"in s?"labels":""}
              }
            `,data:s})}}),[t])}const Mo=ue`
  mutation EditRulesBulk($ids: [ID!]!, $rule: RuleInput!) {
    editRules(ids: $ids, rule: $rule) 
  }
`;function Po({selectedRuleIds:t,onComplete:n=null}){const s=d.useRef(),[o,i]=d.useState(!1),[a,r]=d.useState(!1),[c,l,p,u,x]=Go(d.useCallback(()=>i(!1),[])),j=Wo({selectedRuleIds:t,waitConfirm:l,onComplete:n,confirmState:{action:"disable"}}),g=qo({selectedRuleIds:t,waitConfirm:l,onComplete:n,confirmState:{action:"archive"}}),[v,R,C]=Uo({selectedRuleIds:t,onComplete:n}),[D,G,oe]=Ho({selectedRuleIds:t,onComplete:n}),[Q,Ue,_e]=Qo({selectedRuleIds:t,onComplete:n}),[ve,He,P]=Yo({selectedRuleIds:t,onComplete:n}),N=d.useCallback(Ce=>()=>{Ce(),r(!1)},[]);return e.jsxs(e.Fragment,{children:[e.jsx(w,{ref:s,color:t.size===0?"default":"primary",variant:"outlined",size:"small",disabled:t.size===0,startIcon:e.jsx(rn,{fontSize:"small",color:t.size===0?"disabled":"primary"}),onClick:()=>r(!a),children:"Actions"}),e.jsxs(gt,{open:a,anchorEl:s.current,anchorOrigin:{horizontal:"left",vertical:"bottom"},onClose:()=>r(!1),PaperProps:{style:{maxHeight:300,width:200}},children:[e.jsxs(T,{onClick:N(j),children:[e.jsx(O,{children:e.jsx(Se,{})}),e.jsx($,{primary:"Disable"})]}),e.jsxs(T,{onClick:N(g),children:[e.jsx(O,{children:e.jsx(ft,{})}),e.jsx($,{primary:"Archive"})]}),e.jsxs(T,{onClick:N(v),children:[e.jsx(O,{children:e.jsx(jt,{})}),e.jsx($,{primary:"Edit severity"})]}),e.jsxs(T,{onClick:N(D),children:[e.jsx(O,{children:e.jsx(Ss,{})}),e.jsx($,{primary:"Force fail simulation"})]}),e.jsxs(T,{onClick:N(Q),children:[e.jsx(O,{children:e.jsx(Ae,{})}),e.jsx($,{primary:"Edit labels"})]}),e.jsxs(T,{onClick:N(ve),children:[e.jsx(O,{children:e.jsx(Fe,{})}),e.jsx($,{primary:"Edit compliance"})]})]}),e.jsx(Lo,{selectedRuleIds:t,open:R,onClose:()=>C(!1),onEdit:v}),e.jsx(Ao,{selectedRuleIds:t,open:G,onClose:()=>oe(!1),onEdit:D}),e.jsx(Is,{selectedRuleIds:t,open:Ue,onClose:()=>_e(!1),onEdit:Q}),e.jsx(Fo,{selectedRuleIds:t,open:He,onClose:()=>P(!1),onEdit:ve}),e.jsxs(ze,{open:p,onClose:()=>u(!1),children:[e.jsxs(Me,{disableTypography:!0,children:[e.jsxs(m,{variant:"subtitle1",children:[{disable:"Disable Rules",archive:"Archive Rules"}[x==null?void 0:x.action]||"Confirm bulk action"," ","(",t.size,")"]}),e.jsx("div",{style:{flexGrow:1}}),e.jsx(H,{edge:"end",onClick:()=>u(!1),children:e.jsx(pe,{})})]}),e.jsx(Pe,{children:e.jsxs(_,{gap:2,children:[e.jsx(m,{children:"Are you sure you want to perform this operation?"}),e.jsx(Ve,{checked:o,onChange:i})]})}),e.jsxs(be,{children:[e.jsx(w,{variant:"text",onClick:()=>u(!1),children:"Cancel"}),e.jsx(w,{color:"primary",onClick:c,disabled:!o,children:{disable:"Disable",archive:"Archive"}[x==null?void 0:x.action]||"Yes"})]})]})]})}const Vo=(t,n)=>{const{workspaceId:s,session:o,user:i}=Yt();return{downloadRules:d.useCallback(async()=>{const r="/api/standards/rules/report";try{const c=await fetch(r,{method:"POST",headers:{customer:s,authorization:`Bearer ${o==null?void 0:o.access_token}`,"content-type":"application/json"},body:JSON.stringify({export_by:i.email,filters:{rule_ids:t,account_ids:n}})});if(!c.ok)throw new Error(await c.text());const l=await c.blob(),p=window.URL.createObjectURL(l),u=document.createElement("a"),j="stream_rules_report-"+Xn().format("DD_MM_YYYY-HH:mm:ss")+".csv";u.href=p,u.download=j,document.body.appendChild(u),u.click(),u.remove()}catch(c){console.log(c)}},[s,o,i,t,n])}},Bo=({rules:t,filterValues:n})=>{const[s,o]=J.useState(null),i=wi({rule_ids:t.map(l=>l.id),account_ids:n.account_ids}),{downloadRules:a}=Vo(t.map(l=>l.id),n.account_ids),r=()=>{o(null)},c=l=>{o(l.currentTarget)};return e.jsxs(e.Fragment,{children:[e.jsx(w,{variant:"outlined",startIcon:e.jsx(ks,{style:{fontSize:"14px"}}),onClick:c,size:"small",style:{padding:"0px 12px"},children:"Export to CSV"}),e.jsxs(gt,{anchorEl:s,keepMounted:!0,open:!!s,onClose:r,anchorOrigin:{vertical:"bottom",horizontal:"left"},style:{marginTop:"6px"},children:[e.jsxs(T,{onClick:a,children:[e.jsx($,{primary:"Rules Summary"}),e.jsx(O,{children:e.jsx(te,{placement:"top",title:e.jsxs(h,{column:!0,fullHeight:!0,children:[e.jsx(m,{variant:"body2",color:"textSecondary",children:"Rules Summary"}),e.jsx(m,{variant:"body2",children:"Export a high-level rules overview, capturing essential details like rule names, violations count, severity levels, and statuses."})]}),children:e.jsx(ne,{style:{fontSize:"12px"}})})})]}),e.jsxs(T,{onClick:i,children:[e.jsx($,{primary:"Detailed Violations Summary"}),e.jsx(O,{children:e.jsx(te,{placement:"top",title:e.jsxs(h,{column:!0,fullHeight:!0,children:[e.jsx(m,{variant:"body2",color:"textSecondary",children:"Detailed Violations Report"}),e.jsx(m,{variant:"body2",children:"Export an in-depth report of all rule violations, containing detailed information for each incident. Depending on the number of findings, this report may take longer to generate and download."})]}),children:e.jsx(ne,{style:{fontSize:"12px",marginLeft:"14px"}})})})]})]})]})};function Wo({selectedRuleIds:t,waitConfirm:n,onComplete:s,confirmState:o}){const i=Ge({selectedRuleIds:t,onComplete:s});return d.useCallback(()=>{n(()=>{i({data:{state:"disabled"},loadingMessage:"Disabling rules in progress...",successMessage:"Disabled rules successfully",errorMessage:"Something went wrong while trying to disable rules"})},o)},[i,n,o])}function qo({selectedRuleIds:t,waitConfirm:n,onComplete:s,confirmState:o}){const i=Ge({selectedRuleIds:t,onComplete:s});return d.useCallback(()=>{n(()=>{i({data:{state:"archived"},loadingMessage:"Archiving rules in progress...",successMessage:"Archived rules successfully",errorMessage:"Something went wrong while trying to archive rules"})},o)},[i,n,o])}function Go(t){const n=d.useRef(),[s,o]=d.useState(),[i,a]=d.useState(!1),r=d.useCallback((l,p)=>{new Promise(u=>{n.current=u,a(!0),o(p)}).then(l)},[]);return[d.useCallback(()=>{a(!1),n.current(),t==null||t()},[t]),r,i,a,s]}function Ge({selectedRuleIds:t,onComplete:n}){const s=U(),o=d.useMemo(()=>Array.from(t),[t]),i=zo();return d.useCallback(({data:a,loadingMessage:r,successMessage:c,errorMessage:l})=>{s(r,"info",null),i(o,a).then(()=>{s(c,"success"),n==null||n()}).catch(p=>{console.error(p),s(l,"error",null)})},[i,o,s,n])}function Uo({selectedRuleIds:t,onComplete:n}){const s=Ge({selectedRuleIds:t,onComplete:n}),[o,i]=d.useState(!1);return[d.useCallback(a=>{typeof a<"u"?(s({data:{severity:a},loadingMessage:"Editing severity for selected rules...",errorMessage:"Something went wrong while editing severity",successMessage:"Edited severity successfully"}),i(!1)):i(!0)},[s]),o,i]}function Ho({selectedRuleIds:t,onComplete:n}){const s=Ge({selectedRuleIds:t,onComplete:n}),[o,i]=d.useState(!1);return[d.useCallback(a=>{typeof a<"u"?(s({data:{fail_simulation:a},loadingMessage:"Editing force fail simulation for selected rules...",errorMessage:"Something went wrong while editing force fail simulation",successMessage:"Edited force fail simulation successfully",onComplete:n}),i(!1)):i(!0)},[s,n]),o,i]}function Qo({selectedRuleIds:t,onComplete:n}){const s=U(),[o,i]=d.useState(!1),a=pn({selectedRuleIds:t,field:"labels"});return[d.useCallback(r=>{if(typeof r<"u"){i(!1);const{addLabels:c,removeLabels:l}=r;s("Editing labels for selected rules...","info",null),Promise.all([a(c,!1),a(l,!0)]).then(()=>{s("Edited labels successfully","success"),n==null||n()}).catch(p=>{console.error(p),s("Something went wrong while editing labels","error",null)})}else i(!0)},[a,s,n]),o,i]}function Yo({selectedRuleIds:t,onComplete:n}){const s=U(),[o,i]=d.useState(!1),a=pn({selectedRuleIds:t,field:"compliance"});return[d.useCallback(r=>{if(typeof r<"u"){i(!1);const{addCompliance:c,removeCompliance:l}=r;s("Editing compliance for selected rules...","info",null),Promise.all([a(c,!1),a(l,!0)]).then(()=>{s("Edited compliance successfully","success"),n==null||n()}).catch(p=>{console.error(p),s("Something went wrong while editing compliance","error",null)})}else i(!0)},[a,s,n]),o,i]}const Jo=({extendedWidth:t,...n})=>{const[s,o]=d.useState(!1),[i,a]=d.useState(!1),r=d.useRef(null),c=()=>{o(u=>(!u&&r.current&&r.current.focus(),!u))},l=()=>{i||o(!1)},p=()=>{a(!0),setTimeout(()=>{a(!1)},0)};return e.jsx(h,{row:!0,gap:2,children:e.jsx(Ko,{expanded:s,extendedWidth:t,variant:"outlined",size:"small",onFocus:()=>o(!0),onBlur:l,inputRef:r,InputProps:{endAdornment:e.jsx(Es,{position:"end",children:e.jsx(Jt,{onClick:c,onMouseDown:p,children:e.jsx(mn,{fontSize:"small",color:"action"})})})},...n})})},Ko=f(L).withConfig({displayName:"ExpandableSearch__StyledTextField",componentId:"sc-8v3imc-0"})(({expanded:t,extendedWidth:n})=>({background:"transparent",".MuiInputBase-root":{width:t?n:32.5,transition:"width 0.3s ease",overflow:"hidden",paddingRight:t?8:0,paddingLeft:t?8:0},".MuiInputBase-input":{...!t&&{paddingLeft:0,paddingRight:0,opacity:0},pointerEvents:t?"auto":"none",transition:"opacity 0.3s ease"},...!t&&{".MuiOutlinedInput-notchedOutline":{display:"none"},".MuiInputAdornment-root":{margin:0}}}));function Zo(){const t=es(),[n,s]=vt("rules-page-chart-visible",!0),{state:o}=ct(),i=kt(),[a,r,c]=Di(),{selectedRuleIds:l,setSelectedRuleIds:p}=d.useContext(Gn),{filtersValues:u,filterOnlyViolations:x,showArchived:j}=d.useMemo(()=>({filtersValues:{...S.omitBy(S.omit(a,["only_violations","archived"]),y=>Array.isArray(y)&&y.length===0)},filterOnlyViolations:nt(a==null?void 0:a.only_violations,!0),showArchived:nt(a==null?void 0:a.archived)}),[a]),[g,v]=d.useState(a==null?void 0:a.name),R=d.useMemo(()=>x||j||Object.keys(u).length>0,[x,u,j]),[C,D]=d.useState(!0),[G,{loading:oe,loadingAccountsData:Q,error:Ue}]=Ds(),[_e,{loading:ve,error:He}]=Ns(),P=d.useMemo(()=>G==null?void 0:G.filter(y=>j?y.state==="archived":y.state!=="archived").map(y=>{var z;return{...y,violationsCount:(z=_e[y.id])==null?void 0:z.count}}),[G,j,_e]),N=Ts(P,u,x),Ce=oe||ve||Q,Ot=Ue||He,$t=ts((y,z)=>r({...z,name:y}),500),Un=d.useCallback(y=>{v(y),$t(y,a)},[$t,a]),Hn=d.useCallback(y=>{y&&Object.keys(y).length>0?r({...y,...(y==null?void 0:y.archived)&&x&&{only_violations:!1}}):r(null)},[x,r]),Qn=d.useCallback(()=>{r(x?{...a,only_violations:!1}:null)},[x,a,r]),Yn=N.reduce((y,z)=>{const Qe=Le(z.severity)??"";return y[Qe]||(y[Qe]={value:0,color:un(t,z.severity)}),y[Qe].value+=z.violationsCount??0,y},{});return e.jsx(As,{screen:ns.Rules,body:{filters:a},updateBody:y=>{var z;Hn(y==null?void 0:y.filters),v(((z=y==null?void 0:y.filters)==null?void 0:z.name)||"")},getLink:c,children:e.jsxs(_,{grow:[0,1],style:{height:"100%"},children:[e.jsx("div",{}),e.jsxs(k,{grow:!0,children:[e.jsx(Ct,{open:C,children:e.jsxs(Xo,{grow:[0,1],children:[e.jsx(ie,{dense:!0,title:e.jsx(Fs,{}),actions:e.jsx(k,{gap:1,style:{alignItems:"center"},children:e.jsx(hn,{open:!0,onClick:()=>D(!1)})})}),e.jsx(Os,{Filters:y=>e.jsx(lo,{allRules:P,rules:N,loadingAccountsData:Q,...y})})]})}),e.jsxs(_,{grow:[0,0,1],children:[e.jsx(No,{loading:Ce,allRules:N,rules:N,selectedRuleIds:l,startAdornment:e.jsx(e.Fragment,{children:e.jsx($s,{})}),actions:e.jsxs(h,{row:!0,gap:2,children:[e.jsx(Jo,{placeholder:"Search by rule name",variant:"outlined",value:g,size:"small",extendedWidth:260,onChange:y=>Un(y.target.value)}),e.jsx(w,{variant:"outlined",size:"small",active:C,disabled:!(P!=null&&P.length),startIcon:e.jsx(xn,{}),onClick:()=>D(!C),children:"Filters"}),e.jsx(Po,{selectedRuleIds:l}),e.jsx(Bo,{rules:N,filterValues:u}),e.jsx(w,{size:"small",startIcon:e.jsx(on,{fontSize:"small"}),variant:"outlined",onClick:i.createRule,children:"New Rule"}),e.jsx(E,{variant:"middle",orientation:"vertical",flexItem:!0}),e.jsx(H,{selected:n,onClick:()=>{s(!n)},children:e.jsx(Ls,{fontSize:"small"})})]})}),n&&P&&e.jsx(zs,{filters:u,severities:Yn}),Ce?e.jsx(ge,{children:e.jsx(Rt,{})}):!P&&Ot?e.jsx(wt,{error:Ot}):(N==null?void 0:N.length)===0?e.jsx(oo,{allRules:P,hasFilters:R,filterOnlyViolations:x,onClick:Qn}):e.jsx(ea,{children:e.jsx(vo,{selected:l,setSelected:p,rules:N,focusRuleId:o==null?void 0:o.focusRuleId,filtersValues:u})})]})]})]})})}const Xo=f(_).withConfig({displayName:"RulesPage__FiltersContainers",componentId:"sc-ht7nnt-0"})(({theme:t})=>({maxWidth:300})),ea=f(_).withConfig({displayName:"RulesPage__Content",componentId:"sc-ht7nnt-1"})(({theme:t})=>({overflow:"auto"}));function ta({rule:t,headerActions:n,...s}){var o,i;return e.jsxs(oa,{...s,children:[e.jsx(ie,{actions:n,title:e.jsxs(e.Fragment,{children:[e.jsx(ne,{color:"action"}),e.jsx(m,{variant:"subtitle1",children:"Details"})]})}),e.jsx(aa,{children:e.jsxs(_,{gap:2,style:{overflow:"visible"},children:[(t==null?void 0:t.status)==="invalid"&&e.jsx(na,{rule:t}),e.jsx(b,{icon:e.jsx(Ne,{category:t==null?void 0:t.category,fontSize:"small",color:"action"}),label:t==null?void 0:t.category}),e.jsx(b,{icon:e.jsx(Rn,{name:t==null?void 0:t.created_by}),label:_t(t==null?void 0:t.creation_date)}),e.jsx(E,{light:!0}),e.jsx(b,{icon:e.jsx(pt,{fontSize:"small",color:"action"}),label:"Violations",labelVariant:"subtitle2"}),e.jsxs(k,{gap:1,children:[e.jsx(b,{icon:e.jsx(Ee,{severity:t==null?void 0:t.severity}),label:Le(t==null?void 0:t.severity)}),(t==null?void 0:t.rule_type)===q.Path&&e.jsx(ra,{subject:t.subject})]}),(t==null?void 0:t.fail_simulation)&&e.jsx(b,{icon:e.jsx(ia,{fontSize:"small"}),label:"Fail violating simulations"}),(t==null?void 0:t.description)&&e.jsxs(e.Fragment,{children:[e.jsx(E,{light:!0}),e.jsxs(_,{gap:1,children:[e.jsx(b,{icon:e.jsx(Ms,{fontSize:"small",color:"action"}),label:"Description",labelVariant:"subtitle2"}),e.jsx(Pt,{color:"textSecondary",children:t==null?void 0:t.description})]})]}),(t==null?void 0:t.remediation)&&e.jsxs(e.Fragment,{children:[e.jsx(E,{light:!0}),e.jsxs(_,{gap:1,children:[e.jsx(b,{icon:e.jsx(Ps,{fontSize:"small",color:"action"}),label:"Remediation",labelVariant:"subtitle2"}),e.jsx(Pt,{color:"textSecondary",children:t==null?void 0:t.remediation})]})]}),(t==null?void 0:t.finding_type)&&e.jsxs(e.Fragment,{children:[e.jsx(E,{light:!0}),e.jsxs(_,{gap:1,children:[e.jsx(b,{icon:e.jsx(Vs,{fontSize:"small",color:"action"}),label:"Finding Type",labelVariant:"subtitle2"}),e.jsx(Te,{findingType:t==null?void 0:t.finding_type})]})]}),((o=t==null?void 0:t.labels)==null?void 0:o.length)>0&&e.jsxs(e.Fragment,{children:[e.jsx(E,{light:!0}),e.jsxs(_,{gap:2,style:{overflow:"visible"},children:[e.jsx(b,{icon:e.jsx(Ae,{fontSize:"small",color:"action"}),label:"Labels",labelVariant:"subtitle2"}),e.jsx(Gt,{children:t.labels.map((a,r)=>e.jsx(Ut,{children:a},r))})]})]}),((i=t==null?void 0:t.compliance)==null?void 0:i.length)>0&&e.jsxs(e.Fragment,{children:[e.jsx(E,{light:!0}),e.jsxs(_,{gap:2,style:{overflow:"visible"},children:[e.jsx(b,{icon:e.jsx(Fe,{fontSize:"small",color:"action"}),label:"Compliance",labelVariant:"subtitle2"}),e.jsx(Gt,{children:t.compliance.map((a,r)=>e.jsx(Ut,{children:a},r))})]})]})]})})]})}const Gt=f.div.withConfig({displayName:"RuleDetails__LabelsWrapper",componentId:"sc-1exz6by-0"})({display:"flex",flexWrap:"wrap"});function na(){return e.jsxs(sa,{gap:1,children:[e.jsxs(k,{style:{alignItems:"center"},gap:1,children:[e.jsx(yt,{fontSize:"small",color:"error"}),e.jsx(m,{variant:"subtitle1",children:"Rule criteria is no longer valid"})]}),e.jsx(E,{light:!0}),e.jsx(m,{children:"One of the resources included in this rule has been removed. No violations are collected."})]})}const sa=f(_).withConfig({displayName:"RuleDetails__InvlidBox",componentId:"sc-1exz6by-1"})(({theme:t})=>({background:de(t.palette.error.main,.25),padding:t.spacing(2),borderRadius:t.shape.borderRadius})),Ut=f.span.withConfig({displayName:"RuleDetails__Label",componentId:"sc-1exz6by-2"})(({theme:t})=>({borderRadius:t.shape.borderRadius/2,border:`solid 1px ${t.palette.divider}`,padding:t.spacing(.5,1),margin:t.spacing(0,.5,.5,0)})),ia=f(gn).withConfig({displayName:"RuleDetails__GreenCheckIcon",componentId:"sc-1exz6by-3"})(({theme:t})=>({color:t.palette.common.green})),oa=f(_).withConfig({displayName:"RuleDetails__Container",componentId:"sc-1exz6by-4"})(({theme:t})=>({background:t.palette.background.default,maxWidth:350})),aa=f.div.withConfig({displayName:"RuleDetails__Content",componentId:"sc-1exz6by-5"})(({theme:t})=>({flexGrow:1,overflow:"auto",padding:t.spacing(2)})),ra=({subject:t})=>{const s={[B.Source]:Vt,[B.Intermediate]:Bs,[B.Destination]:Ws}[t]||Vt;return e.jsxs(e.Fragment,{children:[e.jsx(E,{light:!0,flexItem:!0,orientation:"vertical",variant:"middle"}),e.jsx(te,{placement:"top",title:"This resource is set to trigger a violation when the rule’s criteria are met.",children:e.jsx(b,{icon:e.jsx(s,{color:"action"}),label:ae(t)})})]})};function la({form:t,rule:n,onClose:s,...o}){const[i,{loading:a}]=Et(),r=U(),c=d.useCallback(async()=>{let l=t.getValues();n.state!=="draft"&&(l=S.omit(l,["rule_type","ports","allowed_actions","subject","action","path_destination_predicate_equals_match","path_intermediate_predicate_equals_match","path_intermediate_predicate_operand","path_source_predicate_equals_match",...Nn])),i(n.id,l).then(p=>{r("Rule updated successfully","success"),s(),t.reset(p)}).catch(p=>r(p.message,"error"))},[i,t,r,s,n]);return e.jsxs(da,{...o,children:[e.jsx(ie,{title:e.jsxs(e.Fragment,{children:[e.jsx(ne,{color:"action"}),e.jsx(m,{variant:"subtitle1",children:"Details"})]}),actions:e.jsxs(k,{gap:1,children:[e.jsx(w,{variant:"text",size:"small",disabled:a,onClick:s,children:"Discard"}),e.jsx(w,{disabled:a||!t.formState.isDirty,startIcon:a?e.jsx(se,{size:10}):e.jsx(qs,{fontSize:"small"}),size:"small",color:"primary",onClick:c,children:"Save"})]})}),e.jsx(ca,{children:e.jsx(Sn,{form:t})})]})}const ca=f.div.withConfig({displayName:"RuleDetailsEdit__Content",componentId:"sc-1l3m3u8-0"})(({theme:t})=>({flexGrow:1,overflow:"auto",padding:t.spacing(2)})),da=f(_).withConfig({displayName:"RuleDetailsEdit__Container",componentId:"sc-1l3m3u8-1"})(({theme:t})=>({background:t.palette.background.default,maxWidth:350}));function ua({form:t,...n}){const{watch:s}=t,o=s("rule_type");return e.jsxs(pa,{...n,children:[e.jsx("div",{style:{flexGrow:1},children:e.jsxs(_,{gap:1,children:[e.jsx(b,{icon:e.jsx(mt,{color:"action"}),label:"Conditions",labelVariant:"subtitle1"}),e.jsx(Cn,{form:t})]})}),q.Path===o&&e.jsx("div",{children:e.jsx(En,{form:t})})]})}const pa=f.div.withConfig({displayName:"RuleEditForm__Container",componentId:"sc-6yf624-0"})(({theme:t})=>({padding:t.spacing(2),overflow:"auto",height:"100%",display:"flex",flexDirection:"column"}));function ma({rule:t}){const n=t==null?void 0:t.exclusion_predicates,s=U(),[o,{loading:i}]=Et(),a=It(d.useMemo(()=>({exclusion_predicates:n}),[n]),null),r=async()=>{try{const c=a.getValues();await o(t.id,c),a.reset(c),s("Saved successfully","success")}catch(c){s(c.message,"error")}};return e.jsx(Si,{form:a,submitting:i,onSubmit:r})}function An({field:t,filters:n}){const s=lt();return d.useCallback(({phrase:o,skip:i,limit:a})=>s.query({query:ha,variables:{field:t,filters:n,phrase:o,skip:i,limit:a}}).then(({data:r})=>r==null?void 0:r.ruleViolations_facet),[s,t,n])}const ha=ue`
  query RuleViolationsFacetQuery(
    $field: RuleViolationFacetField
    $filters: RuleViolationFilters
    $phrase: String
    $skip: Int
    $limit: Int
  ) {
    ruleViolations_facet(
      field: $field
      filters: $filters
      phrase: $phrase
      skip: $skip
      limit: $limit
    )
  }
`;function xa(){const{integrations:t}=Gs();return(t==null?void 0:t.length)>0}function ga({rule:t,values:n,onChange:s}){return e.jsx(an,{filters:ja({rule_id:t==null?void 0:t.id}),filterValues:n,onChange:s})}function ja(t){const n={resourceId:Y({field:"resource_id",displayName:"Resource ID",filters:t}),resourceAccount:Y({field:"account",displayName:"Account",filters:t}),resourceType:fa({field:"resource_type",displayName:"Resource Type",filters:t}),resourceVpc:Y({field:"vpc",displayName:"VPC",filters:t}),region:ya({field:"region",displayName:"Region",filters:t}),availabilityZones:fe({field:"availability_zones",displayName:"Availability Zone",filters:t}),subnet:Y({field:"subnet",displayName:"Subnet",filters:t}),cluster:Y({field:"cluster",displayName:"Cluster",filters:t}),autoScalingGroup:Y({field:"auto_scaling_group",displayName:"Auto Scaling Group",filters:t}),namespace:Y({field:"namespace",displayName:"Namespace",filters:t}),deployment:Y({field:"deployment",displayName:"Deployment",filters:t}),ticketIds:s()};function s(){const i=An({field:"ticket_ids",filters:t});return fe({field:"ticket_ids",displayName:"Ticket ID",getAllOptions:d.useCallback(()=>i({}),[i]),filters:t})}const o=xa();return d.useMemo(()=>[n.resourceId,n.resourceAccount,{key:"resource_tag",displayName:"Resource Tag",type:({value:i,onChange:a})=>e.jsx(Us,{value:i,onChange:a,renderTag:Hs,renderKeyInput:r=>e.jsx(Qs,{...r}),renderValueInput:r=>e.jsx(Ys,{...r})})},n.resourceVpc,n.resourceType,n.region,n.availabilityZones,n.subnet,n.cluster,n.autoScalingGroup,n.namespace,n.deployment,...o?[n.ticketIds]:[]].sort((i,a)=>i.displayName>a.displayName?1:-1),[n.resourceId,n.resourceAccount,n.resourceVpc,n.resourceType,n.region,n.availabilityZones,n.subnet,n.cluster,n.autoScalingGroup,n.namespace,n.deployment,n.ticketIds,o])}function fe({field:t,filters:n,...s}){const o=An({field:t,filters:n});return d.useMemo(()=>({key:t,limit:200,searchableOptions:!0,getOptions:async({phrase:i,skip:a,limit:r})=>await o({phrase:i,skip:a,limit:r}),...s}),[s,o,t])}function Y(t){const n=fe(t);return d.useMemo(()=>({...n,renderOption:s=>s.includes(" ")?s:e.jsx(St,{id:s})}),[n])}function fa(t){const n=fe(t);return d.useMemo(()=>({...n,renderOption:s=>e.jsx(b,{icon:e.jsx(jn,{type:s,size:"small"}),label:ss(s)})}),[n])}function ya(t){const n=fe(t);return d.useMemo(()=>({...n,renderOption:s=>e.jsxs(k,{gap:1,children:[e.jsx(jn,{size:"small",type:"Region"}),e.jsx(m,{children:s})]})}),[n])}function ba({filtersValues:t,onFiltersChange:n,rule:s,sortOptions:o,onSortChange:i}){const[a,r]=vt("rule-violations-filters",!0);return e.jsx(Js,{children:e.jsxs(Ra,{grow:!0,children:[e.jsx(_a,{rule:s,open:a,values:t,onChange:n,onClose:()=>r(!1)}),e.jsx(Ks,{rule:s,filtersValues:t,filtersOpen:a,setFiltersOpen:r,sortOptions:o,onSortChange:i})]})})}function _a({rule:t,open:n,onClose:s,values:o,onChange:i,...a}){const r=d.useMemo(()=>o?Object.keys(o).length:0,[o]);return e.jsx(Ct,{open:n,...a,children:e.jsxs(Ca,{grow:[0,1],children:[e.jsx(ie,{icon:e.jsx(xn,{fontSize:"small",color:"action"}),title:e.jsxs(m,{variant:"subtitle1",noWrap:!0,children:["Filter by"," ",r>0?`(${r})`:""]}),actions:e.jsx(H,{onClick:s,children:e.jsx(pe,{})})}),e.jsx(va,{children:e.jsx(ga,{rule:t,values:o,onChange:i})})]})})}const va=f.div.withConfig({displayName:"RuleViolations__Content",componentId:"sc-1f9jfnz-0"})({overflow:"auto"}),Ca=f(_).withConfig({displayName:"RuleViolations__FiltersBox",componentId:"sc-1f9jfnz-1"})(({theme:t})=>({maxWidth:300,borderRight:`solid 1px ${t.palette.dividerLight}`,background:de(t.palette.background.default,.25)})),Ra=f(k).withConfig({displayName:"RuleViolations__Container",componentId:"sc-1f9jfnz-2"})(({theme:t})=>({flexGrow:1}));function wa(t){return d.useMemo(()=>({rule_id:t==null?void 0:t.id}),[t==null?void 0:t.id])}function Fn(t,n){const s=xt();return[d.useCallback(async(...i)=>{if(await s.confirm({actionsLayout:"row",inputText:{disabled:!0},...n}))return t[0](...i)},[s,n,t]),t[1]]}function Tt(t){return Object.keys(t||{}).filter(n=>n!=="__typename"&&n!=="preferred_action"&&n!=="remediation_config_last_updated_time"&&n!=="remediation_config_last_updated_user_id").some(n=>{var s;return((s=t==null?void 0:t[n])==null?void 0:s.length)>0})}function At(){var s;const{data:t,...n}=M(at);return{...n,enabled:!!((s=t==null?void 0:t.workspace_auto_remediation_config)!=null&&s.active_auto_remediation)}}const at=A(`
  query AutoRemediationWorkspaceEnabled {
    workspace_auto_remediation_config {
      active_auto_remediation
    }
  }
`);function Sa({ruleId:t}){return e.jsx(ka,{ruleId:t,children:e.jsxs(Ia,{children:[e.jsx(h,{paper:!0,pad:2,border:"bottom",children:e.jsxs(h,{row:!0,center:!0,gap:!0,children:[e.jsx(m,{variant:"subtitle1",children:"Auto Rule Remediation"}),e.jsx(Da,{})]})}),e.jsx(h,{grow:!0,scroll:!0,pad:2,children:e.jsxs(h,{column:!0,gap:4,children:[e.jsx(Ba,{}),e.jsx(E,{light:!0}),e.jsx(Oa,{}),e.jsx("div",{style:{height:"25vh"}})]})})]})})}function Ia({children:t}){const n=K();return e.jsx(h,{column:!0,fullHeight:!0,loading:n.formState.isLoading,children:t})}const On=d.createContext(null);function ka({ruleId:t,children:n}){const s=Ea({ruleId:t});return e.jsx(On.Provider,{value:{ruleId:t},children:e.jsx(Zs,{...s,children:n})})}function he(){const t=d.useContext(On);if(!t)throw new Error("useConfigContext must be used within a ConfigContext");return t}function K(){return Xs()}const Ft=A(`
  query AutoRemediationRuleConfig($rule_id: ID) {
    rule(id: $rule_id) {
      id
      path_destination_predicates {
        resource_type
      }
      path_intermediate_predicates {
        resource_type
      }
      path_source_predicates {
        resource_type
      }
      resource_predicates {
        resource_type
      }
      remediation_config {
        ...AutoRemediationRuleConfigFields
      }
    }
  }
`);function $n(){const{ruleId:t}=he(),{data:n}=Ln({ruleId:t});return d.useMemo(()=>{var s,o,i,a,r,c,l,p;return S.uniq([...((o=(s=n==null?void 0:n.rule)==null?void 0:s.path_destination_predicates)==null?void 0:o.map(u=>u.resource_type))||[],...((a=(i=n==null?void 0:n.rule)==null?void 0:i.path_source_predicates)==null?void 0:a.map(u=>u.resource_type))||[],...((c=(r=n==null?void 0:n.rule)==null?void 0:r.path_intermediate_predicates)==null?void 0:c.map(u=>u.resource_type))||[],...((p=(l=n==null?void 0:n.rule)==null?void 0:l.resource_predicates)==null?void 0:p.map(u=>u.resource_type))||[]].filter(Boolean))},[n])}function Ln({ruleId:t}){return M(Ft,{variables:{rule_id:t}})}function Ea({ruleId:t}){const n=lt();return nn({mode:"onChange",defaultValues:async()=>{var i;const{data:o}=await n.query({query:Ft,fetchPolicy:"network-only",variables:{rule_id:t}});return(i=o==null?void 0:o.rule)==null?void 0:i.remediation_config}})}A(`
  fragment AutoRemediationRuleConfigFields on AutoRemediationRuleConfig {
    accounts
    regions
    resource_types
    resource_ids {
      operand
      values
    }
    resource_tags {
      key
      value
      operand
    }
    source_user_agent {
      operand
      values
    }
    event_name {
      operand
      values
    }
    source_user_identity {
      operand
      values
    }
    preferred_action
  }
`);const zn={accounts:[],regions:[],resource_types:[],resource_ids:null,resource_tags:[],source_user_agent:null,event_name:null,source_user_identity:null,preferred_action:null};function Da(){var c,l;const{ruleId:t}=he(),{data:n,loading:s}=Fa({ruleId:t}),{data:o}=Ln({ruleId:t}),i=!!((c=n==null?void 0:n.rule)!=null&&c.remediation_enable),a=Tt((l=o==null?void 0:o.rule)==null?void 0:l.remediation_config),r=!a||s;return e.jsx(Na,{showTooltip:!a,disabled:r,checked:i,ruleId:t,mutationOptions:{update(p){p.writeQuery({query:Pn,variables:{rule_id:t},data:{rule:{__typename:"Rule",id:t,remediation_enable:!i}}})}}})}function Na({showTooltip:t,...n}){const{enabled:s,loading:o}=At();return t=t||!s,e.jsx(te,{disabled:!t,title:s?"Configure a remediation policy to enable auto-remediation":"Auto-remediation is disabled for the entire workspace",children:e.jsxs(h,{row:!0,center:!0,gap:2,children:[e.jsx(Mn,{...n,disabled:n.disabled||!s||o,checked:n.checked&&!n.disabled}),t&&e.jsx(ne,{fontSize:"small",color:"action"})]})})}function Ta(t){return{title:t?"Disable Rule Auto-Remediation":"Enable Rule Auto-Remediation",text:t?"Are you sure you want to disable auto remediation for this specific rule?":"Are you sure you want to enable auto remediation for this specific rule?",confirmText:t?"Disable":"Enable"}}const Mn=d.forwardRef((t,n)=>{const{checked:s,disabled:o,ruleId:i,mutationOptions:a}=t,[r,{loading:c}]=Fn(Aa(),Ta(s));return e.jsxs(h,{row:!0,gap:!0,center:!0,ref:n,children:[e.jsx(De,{checked:s,disabled:o||c,size:"small",onClick:l=>{l.stopPropagation(),r({...a,variables:{rule_id:i,enable:!s}})}}),e.jsx(m,{color:o?"textSecondary":"textPrimary",children:s?"Enabled":"Disabled"}),c&&e.jsx(se,{size:15})]})});function Aa(){return ye(A(`
    mutation AutoRemediationRuleEditEnabled($rule_id: ID!, $enable: Boolean!) {
      edit_enable_rule_auto_remediation(rule_id: $rule_id, enable: $enable) 
    }`))}function Fa({ruleId:t}){return M(Pn,{variables:{rule_id:t}})}const Pn=A(`
  query AutoRemediationRuleEnabled($rule_id: ID) {
    rule(id: $rule_id) {
      id
      remediation_enable
    }
  }
`),rt="ByEvent";function Oa(){var a,r,c;const{ruleId:t}=he(),{data:n}=Vn({ruleId:t}),s=K(),{field:o}=Be({name:"preferred_action",control:s.control}),i=s.watch("preferred_action");return e.jsxs(h,{column:!0,gap:2,children:[e.jsx(m,{variant:"subtitle1",children:"Remediation Action"}),((a=n==null?void 0:n.rule_runbooks)==null?void 0:a.allow_smart_remediation)&&e.jsxs(e.Fragment,{children:[e.jsx($a,{checked:i===rt,onSelect:()=>o.onChange(rt)}),e.jsx(m,{color:"textSecondary",children:"Or select one of the following:"})]}),(c=(r=n==null?void 0:n.rule_runbooks)==null?void 0:r.runbooks)==null?void 0:c.map(l=>e.jsx(za,{checked:l.runbook_name===i,runbook:l,onSelect:()=>o.onChange(l.runbook_name)},l.runbook_name))]})}function $a({checked:t,onSelect:n}){return e.jsx(La,{round:!0,border:!0,hover:!0,children:e.jsxs(h,{row:!0,gap:2,pad:!0,selected:t,children:[e.jsx(re,{size:"small",checked:t,onClick:()=>n()}),e.jsxs(h,{column:!0,children:[e.jsx(m,{variant:"subtitle2",children:"Smart Remediation"}),e.jsx(m,{color:"textSecondary",children:"Stream will auto apply one of the following actions based on violation context"})]})]})})}const La=f(h).withConfig({displayName:"AutoRemediationRuleSettings__SmartBox",componentId:"sc-1dekiw-0"})(["background:",";"],t=>t.theme.palette.gradients.aiOutline);function za({runbook:t,checked:n,onSelect:s}){const[o,i]=d.useState(!1);return e.jsxs(h,{round:!0,border:!0,column:!0,children:[e.jsxs(h,{row:!0,gap:2,pad:!0,selected:n,...t.runbook_content&&{hover:!0,onClick:()=>i(!o)},children:[e.jsx(re,{size:"small",checked:n,onClick:a=>{a.stopPropagation(),s()}}),e.jsxs(h,{column:!0,style:{justifyContent:"center"},children:[e.jsx(m,{variant:"subtitle2",children:t.runbook_name}),e.jsx(m,{color:"textSecondary",children:t.runbook_description})]}),e.jsx(h,{grow:!0}),t.runbook_content&&e.jsx(Jt,{children:o?e.jsx(ei,{}):e.jsx(ti,{})})]}),e.jsxs(ni,{in:o,children:[e.jsx("div",{style:{height:10}}),e.jsxs(h,{row:!0,gap:2,children:[e.jsx(re,{size:"small",style:{visibility:"hidden"}}),e.jsx(h,{bg:!0,round:!0,children:e.jsx("pre",{style:{padding:"0 12px"},children:t.runbook_content})})]})]})]})}function Vn({ruleId:t}){return M(A(`
      query Runbooks($rule_id: ID!) {
        rule_runbooks(rule_id: $rule_id) {
          allow_smart_remediation
          runbooks {
            runbook_name
            runbook_description
            runbook_content
          }
      }
    }
    `),{variables:{rule_id:t}})}function Ma(){var r,c;const{ruleId:t}=he(),n=K(),s=n.watch(),o=Object.keys(s).some(l=>{var p;return((p=s[l])==null?void 0:p.length)>0}),{data:i}=Vn({ruleId:t}),a=d.useMemo(()=>{var l,p,u,x;return{...zn,preferred_action:(l=i==null?void 0:i.rule_runbooks)!=null&&l.allow_smart_remediation?rt:(x=(u=(p=i==null?void 0:i.rule_runbooks)==null?void 0:p.runbooks)==null?void 0:u[0])==null?void 0:x.runbook_name}},[(r=i==null?void 0:i.rule_runbooks)==null?void 0:r.allow_smart_remediation,(c=i==null?void 0:i.rule_runbooks)==null?void 0:c.runbooks]);return e.jsx(w,{disabled:!o,onClick:()=>{n.reset(a,{keepDefaultValues:!0})},children:"Reset to Default"})}function Pa(){const t=U(),{ruleId:n}=he(),[s,{loading:o}]=Va(),i=K(),{isDirty:a}=ai({control:i.control});return e.jsx(w,{color:"primary",disabled:!a||o,startIcon:o&&e.jsx(se,{size:15}),onClick:()=>s({variables:{rule_id:n,config:i.getValues()},update(r){const c=S.defaults(i.getValues(),zn);r.writeQuery({query:Ft,variables:{rule_id:n},data:{rule:{__typename:"Rule",id:n,remediation_config:{...c,__typename:"AutoRemediationRuleConfig"}}}})}}).then(()=>{t("Saved successfully","success"),i.reset(i.getValues())}).catch(r=>{t(`Error: ${r.message}`,"error")}),children:"Save Changes"})}function Va(){return ye(A(`
    mutation AutoRemediationRuleEditConfig($rule_id: ID!, $config: AutoRemediationRuleConfigInput!) {
      edit_config_rule_auto_remediation(rule_id: $rule_id, config: $config) 
    }`))}function Ba(){return e.jsxs(h,{column:!0,gap:2,children:[e.jsxs(h,{row:!0,sticky:!0,children:[e.jsxs(h,{column:!0,grow:!0,gap:!0,children:[e.jsx(m,{variant:"subtitle1",children:"Remediation Scope"}),e.jsx(m,{color:"textSecondary",children:"All violations matching this policy will be automatically remediated upon detecting a violating configuration space."})]}),e.jsx(h,{grow:!0}),e.jsxs(h,{row:!0,center:!0,gap:!0,children:[e.jsx(Ma,{}),e.jsx(Pa,{})]})]}),e.jsx(E,{}),e.jsxs(h,{row:!0,gap:2,children:[e.jsxs(h,{column:!0,grow:!0,gap:!0,children:[e.jsx(m,{variant:"subtitle2",children:"Cloud Accounts"}),e.jsx(m,{color:"textSecondary",children:"Only resources from the selected cloud accounts will be remediated."})]}),e.jsx(h,{grow:2,children:e.jsx(et,{field:"accounts",...Qa()})})]}),e.jsx(E,{}),e.jsxs(h,{row:!0,gap:2,children:[e.jsxs(h,{column:!0,grow:!0,gap:!0,children:[e.jsx(m,{variant:"subtitle2",children:"Regions"}),e.jsx(m,{color:"textSecondary",children:"Only resources in the selected regions will be remediated."})]}),e.jsx(h,{grow:2,children:e.jsx(et,{field:"regions",...Ya()})})]}),e.jsx(E,{}),e.jsxs(h,{row:!0,gap:2,children:[e.jsxs(h,{column:!0,grow:!0,gap:!0,children:[e.jsx(m,{variant:"subtitle2",children:"Violated Resource Types"}),e.jsx(m,{color:"textSecondary",children:"Only resources of the selected types will be remediated."})]}),e.jsx(h,{grow:2,children:e.jsx(et,{field:"resource_types",...Ja()})})]}),e.jsx(E,{}),e.jsxs(h,{row:!0,gap:2,children:[e.jsxs(h,{column:!0,grow:!0,gap:!0,children:[e.jsx(m,{variant:"subtitle2",children:"Violated Resource IDs"}),e.jsx(m,{color:"textSecondary",children:"Only the selected resource IDs will be remediated."})]}),e.jsx(h,{grow:2,children:e.jsx(Re,{field:"resource_ids",...Ka()})})]}),e.jsx(E,{}),e.jsxs(h,{row:!0,gap:2,children:[e.jsxs(h,{column:!0,grow:!0,gap:!0,children:[e.jsx(m,{variant:"subtitle2",children:"Violated Resource Tags"}),e.jsx(m,{color:"textSecondary",children:"Only resources matching the selected tag conditions will be remediated."})]}),e.jsx(h,{grow:2,children:e.jsx(Wa,{field:"resource_tags"})})]}),e.jsx(E,{}),e.jsxs(h,{row:!0,gap:2,children:[e.jsxs(h,{column:!0,grow:!0,gap:!0,children:[e.jsx(m,{variant:"subtitle2",children:"Source User Agent"}),e.jsx(m,{color:"textSecondary",children:"Only resources where the triggering event preformed by the specified user agent will be remediated."})]}),e.jsx(h,{grow:2,children:e.jsx(Re,{field:"source_user_agent",placeholder:"Add Source User Agent",freeSolo:!0})})]}),e.jsx(E,{}),e.jsxs(h,{row:!0,gap:2,children:[e.jsxs(h,{column:!0,grow:!0,gap:!0,children:[e.jsx(m,{variant:"subtitle2",children:"Event Name"}),e.jsx(m,{color:"textSecondary",children:"Only resources where the triggering event matches the specified event name (API Call) will be remediated."})]}),e.jsx(h,{grow:2,children:e.jsx(Re,{field:"event_name",placeholder:"Add Event Name",freeSolo:!0})})]}),e.jsx(E,{}),e.jsxs(h,{row:!0,gap:2,children:[e.jsxs(h,{column:!0,grow:!0,gap:!0,children:[e.jsx(m,{variant:"subtitle2",children:"Source User Identity"}),e.jsx(m,{color:"textSecondary",children:"Only resources where the triggering event preformed by the specified user identities will be remediated."})]}),e.jsx(h,{grow:2,children:e.jsx(Re,{field:"source_user_identity",placeholder:"Add Source User Identity",freeSolo:!0})})]})]})}function Re(t){var p;const n=K(),{field:s}=Be({name:t.field,control:n.control}),o=s.value||{},i=d.useMemo(()=>o.values||[],[o.values]),a=d.useMemo(()=>t.options||[],[t.options]),r=o.operand||I.Equals,c=!o.operand||r===I.Contains||r===I.NotContains||t.freeSolo,l=c?void 0:t.renderOption;return e.jsxs(Bn,{children:[!!((p=o.values)!=null&&p.length)&&e.jsx(fn,{variant:"standard",value:r,onChange:u=>s.onChange({...o,operand:u.target.value}),children:Object.values(I).filter(u=>u!==I.Empty&&u!==I.NotEmpty).map(u=>e.jsx(T,{value:u,children:{[I.Equals]:"Is",[I.NotEquals]:"Is not",[I.NotContains]:"Not contains"}[u]||je(u)},u))}),e.jsx(We,{fullWidth:!0,options:a,freeSolo:c,autoSelect:c,multiple:!0,value:i,forcePopupIcon:a.length>0,onChange:(u,x,j)=>s.onChange(x.length?{operand:o.operand||j==="create-option"?I.Contains:I.Equals,values:x}:null),renderInput:u=>{var x;return e.jsx(L,{placeholder:t.placeholder||"Add "+je(t.field),...u,InputProps:{...u.InputProps,disableUnderline:!((x=o.values)!=null&&x.length)},fullWidth:!0})},renderTags:(u,x)=>u.map((j,g)=>e.jsx(yn,{size:"small",...x({index:g}),label:(l==null?void 0:l(j??"",{inputValue:"",selected:!1}))||j})),noOptionsText:t.noOptionsText,loading:t.loading,renderOption:t.renderOption,filterOptions:t.filterOptions,inputValue:t.inputValue,onInputChange:t.onInputChange})]})}function Wa({field:t}){var i,a;const n=K(),{field:s}=Be({name:t,control:n.control}),o=((i=s.value)==null?void 0:i.length)>0?s.value:[{}];return e.jsxs(h,{column:!0,gap:2,children:[o.map((r,c)=>e.jsx(qa,{tag:r,onChange:l=>s.onChange(l.key?Bt(o,{[c]:{$set:l}}):o.length>1?Bt(o,{$splice:[[c,1]]}):null)},c)),((a=o==null?void 0:o[o.length-1])==null?void 0:a.key)&&e.jsx(h,{children:e.jsx(w,{size:"small",variant:"text",onClick:()=>s.onChange([...o,{}]),startIcon:e.jsx(si,{}),children:"Add Another Tag"})})]})}function qa({tag:t,onChange:n}){return e.jsxs(Bn,{children:[e.jsx(We,{value:t.key||"",onChange:(s,o)=>n({...t,key:o,value:o?t.value:null,operand:o?t.operand||I.Equals:null}),style:{flexGrow:2},freeSolo:!0,autoSelect:!0,renderInput:s=>e.jsx(L,{...s,placeholder:"Add Resource Tag Key",InputProps:{...s.InputProps,disableUnderline:!t.key}}),...Ua({value:t.key})}),t.key&&e.jsx(Ga,{tag:t,onChange:n})]})}function Ga({tag:t,onChange:n}){const s=Ha({tagKey:t.key,value:t.value});return e.jsxs(e.Fragment,{children:[e.jsx(fn,{defaultValue:is.Equals,variant:"standard",style:{flexGrow:1},value:t.operand,onChange:o=>{const i=o.target.value;n({...t,operand:i,value:i===I.Empty||i===I.NotEmpty?null:t.value})},children:Object.values(I).map(o=>e.jsx(T,{value:o,children:{[I.Equals]:"Is",[I.NotEquals]:"Is not",[I.NotContains]:"Not contains",[I.Empty]:"Empty",[I.NotEmpty]:"Not empty"}[o]||je(o)},o))}),t.operand!==I.Empty&&t.operand!==I.NotEmpty&&e.jsx(We,{value:t.value||"",onChange:(o,i)=>n({...t,value:i}),freeSolo:!0,autoSelect:!0,style:{flexGrow:2},renderInput:o=>e.jsx(L,{...o,placeholder:"Values"}),renderOption:o=>e.jsx(W,{children:e.jsx(m,{noWrap:!0,children:o})}),...s})]})}function Ua({value:t}){const[n,s]=d.useState(t||""),[o]=ke(n,300),{data:i,loading:a}=M(A(`
    query ResourceTagKeys($search_keyword: String) {
      resourceTagKeys(search_keyword: $search_keyword) 
    }
  `),{variables:{search_keyword:o}});return d.useEffect(()=>{s(t||"")},[t]),{options:(i==null?void 0:i.resourceTagKeys)||[],inputValue:n,onInputChange:(r,c)=>s(c),filterOptions:(r,{inputValue:c})=>r.filter(l=>!c||l.toLowerCase().includes(c.toLowerCase())),loading:a}}function Ha({tagKey:t,value:n}){const[s,o]=d.useState(n||""),[i]=ke(s,300),{data:a,loading:r}=M(A(`
    query ResourceTagValues($key: String, $search_keyword: String) {
      resourceTagValues(key: $key, search_keyword: $search_keyword) 
    }
  `),{variables:{key:t,search_keyword:i}});return d.useEffect(()=>{o(n||"")},[n]),{options:(a==null?void 0:a.resourceTagValues)||[],inputValue:s,onInputChange:(c,l)=>o(l),filterOptions:(c,{inputValue:l})=>c.filter(p=>!l||p.toLowerCase().includes(l.toLowerCase())),loading:r}}const Bn=f(h).withConfig({displayName:"AutoRemediationRuleSettings__InputLayout",componentId:"sc-1dekiw-1"})(({theme:t})=>({background:"#D0D0D026",display:"flex",gap:t.spacing(1),padding:t.spacing(2),borderRadius:t.shape.borderRadius,border:"solid 1px #D0D0D026"}));function et(t){const n=K(),{field:s}=Be({name:t.field,control:n.control}),o=d.useMemo(()=>s.value||[],[s.value]);return e.jsx(We,{value:o,onChange:(i,a)=>s.onChange(a.length===0?[]:a),multiple:!0,renderInput:i=>e.jsx(L,{placeholder:t.placeholder||"Add "+je(t.field),variant:"outlined",...i}),renderTags:(i,a)=>i.map((r,c)=>{var l;return e.jsx(yn,{size:"small",...a({index:c}),label:((l=t.renderOption)==null?void 0:l.call(t,r,{inputValue:"",selected:!1}))||r})}),noOptionsText:t.noOptionsText,options:t.options??[],loading:t.loading,renderOption:t.renderOption,filterOptions:t.filterOptions,inputValue:t.inputValue,onInputChange:t.onInputChange})}function Qa(){const{ruleId:t}=he(),{data:n,loading:s}=M(A(`
      query RuleRemediationAccounts($ruleId: ID!) {
        rule_remediation_accounts(rule_id: $ruleId) 
      }
    `),{variables:{ruleId:t}});return{options:(n==null?void 0:n.rule_remediation_accounts)||[],renderOption:o=>e.jsx(bn,{id:o}),loading:s}}function Ya(){return{options:Object.keys(Ke),renderOption:t=>{var n;return((n=Ke[t])==null?void 0:n.name)||t},filterOptions:(t,{inputValue:n})=>t.filter(s=>{var o;return!n||((o=Ke[s])==null?void 0:o.name.toLowerCase().includes(n.toLowerCase()))})}}function Ja(){const t=$n();return{options:t!=null&&t.length?t:Object.keys(X).filter(n=>{var s,o,i;return!!((s=X[n])!=null&&s.display_name)&&!((o=X[n])!=null&&o.pseudo)&&((i=X[n])==null?void 0:i.cloud)==="aws"}),renderOption:n=>e.jsx(ii,{resource_type:n}),filterOptions:(n,{inputValue:s})=>n.filter(o=>{var i;return!s||((i=X[o])==null?void 0:i.display_name.toLowerCase().includes(s.toLowerCase()))})}}function Ka(){var p,u;const n=K().watch("resource_types"),s=$n(),[o,i,a]=ke("",1e3),{data:r,loading:c}=M(A(`
      query RuleRemediationResource($phrase: String, $filters: SearchFilters) {
        search(phrase: $phrase, filters: $filters, skip: 0, limit: 100) {
          results {
            id
            display_name
          }
        }
      }
    `),{variables:{phrase:o,...(Number(n==null?void 0:n.length)>0||(s==null?void 0:s.length)>0)&&{filters:{resource_type:Number(n==null?void 0:n.length)>0?n:s}}}}),l=oi((p=r==null?void 0:r.search)==null?void 0:p.results,"id");return{noOptionsText:o!==a?"Loading...":a?"No results found":"Search by name, ID, tags or IP",options:d.useMemo(()=>{var x,j;return((j=(x=r==null?void 0:r.search)==null?void 0:x.results)==null?void 0:j.map(g=>g.id))||[]},[(u=r==null?void 0:r.search)==null?void 0:u.results]),renderOption:x=>e.jsx(St,{disableMenu:!0,id:x}),inputValue:a,onInputChange:d.useCallback((x,j)=>i(j||""),[i]),filterOptions:(x,{inputValue:j})=>x.filter(g=>{var v,R;return!j||((R=(v=l[g])==null?void 0:v.display_name)==null?void 0:R.toLowerCase().includes(j.toLowerCase()))}),loading:c}}function Za({rule:t,toggleButton:n,...s}){const[o,i]=tr(t),[a,r]=me("t","violations"),c=wa(t),l=20,{totalCount:p}=ri({variables:{rule_id:(t==null?void 0:t.id)??""}}),{totalCount:u}=_n({filters:c,limit:l}),x=d.useMemo(()=>[{value:"conditions",Icon:mt,label:"Rule Conditions"},{value:"exclusions",Icon:tn,label:"Exclude Conditions"},{value:"violations",disabled:(t==null?void 0:t.state)!==Ie.Enabled,Icon:pt,label:`Violations ${p?`(${p})`:""}`},{value:"exclude",Icon:dn,label:`Manually Excluded ${u?`(${u})`:""}`},...t.remediation_available||a==="remediation"?[{value:"remediation",Icon:li,label:"Rule Remediation Settings"}]:[]],[t==null?void 0:t.state,t.remediation_available,p,u,a]);return e.jsxs(_,{...s,children:[e.jsxs(sr,{children:[n,e.jsx(ir,{value:a,onChange:(j,g)=>r(g),children:x.map(({value:j,label:g,Icon:v},R)=>e.jsx(ce,{value:j,label:e.jsx(b,{icon:e.jsx(v,{fontSize:"small",color:"action"}),label:g,labelVariant:a===j?"subtitle1":void 0})},R))})]}),e.jsx(nr,{children:{conditions:e.jsx(Ii,{rule:t}),exclusions:e.jsx(ma,{rule:t}),violations:e.jsx(er,{rule:t,sortOptions:o,onSortChange:i}),exclude:e.jsx(Xa,{rule:t,filters:c,limit:l}),remediation:e.jsx(Sa,{ruleId:(t==null?void 0:t.id)??""})}[a]||e.jsx(J.Fragment,{})})]})}function Xa({rule:t,filters:n,limit:s}){const{data:o,error:i,loading:a,totalCount:r,loadMore:c}=_n({filters:n,limit:s});return i&&!o&&!a?e.jsx(ge,{children:e.jsx(wt,{error:i})}):a?e.jsx(ge,{children:e.jsx(Rt,{})}):o!=null&&o.length?e.jsx(ki,{rule:t,filters:n,exclusions:o,count:r??0,limit:s,onScroll:c}):e.jsx(ge,{children:e.jsx(m,{color:"textSecondary",children:"No exclusions"})})}function er({rule:t,sortOptions:n,onSortChange:s}){const[o,i]=me("f");return e.jsx(ba,{filtersValues:o,onFiltersChange:i,rule:t,sortOptions:n,onSortChange:s})}function tr(t){const n=d.useMemo(()=>t.category==="Cost"?{sort_by:zt.PredictedMonthlyCost,sort_order:-1}:{sort_by:zt.FirstSeenTimestamp,sort_order:-1},[t.category]);return me("s",n,{sort_order:Number})}const nr=f.div.withConfig({displayName:"RuleOverview__Content",componentId:"sc-1nq5m1c-0"})(({theme:t})=>({flexGrow:1,overflow:"auto",display:"flex",flexDirection:"column"})),sr=f(ie).withConfig({displayName:"RuleOverview__Header",componentId:"sc-1nq5m1c-1"})(({theme:t})=>({alignItems:"center",padding:t.spacing(0,1)})),ir=f(Oe).withConfig({displayName:"RuleOverview__HeaderTabs",componentId:"sc-1nq5m1c-2"})({height:"100%"});function or({rule:t,...n}){var u;const[s,o]=vt("rule-details",!0),i=ct(),[a,r]=d.useState(!!((u=i.state)!=null&&u.editMode)),c=It(t),l=e.jsx(hn,{open:s,onClick:()=>o(!s),ClosedIcon:ne}),p=d.useCallback(()=>{r(!1)},[]);return e.jsx(ci,{rule:t,children:e.jsxs(k,{grow:!0,...n,children:[e.jsx(Ct,{open:s,children:a?e.jsx(la,{form:c,rule:t,onClose:p}):e.jsx(ta,{rule:t,headerActions:e.jsxs(e.Fragment,{children:[e.jsx(w,{variant:"text",startIcon:e.jsx(jt,{fontSize:"small",color:"action"}),size:"small",onClick:()=>r(!a),children:"Edit"}),l]})})}),a&&(t==null?void 0:t.state)===Ie.Draft?e.jsx(ua,{form:c}):e.jsx(Za,{rule:t,toggleButton:!s&&l})]})})}function ar(){const t=dt(),n=ct(),s=t.params.id,[o,{loading:i,error:a}]=di(s),r=Kt(),c=Zt(),l=d.useCallback(()=>{var u;const p={focusRuleId:s};(u=n.state)!=null&&u.prevLocation?c.replace({pathname:n.state.prevLocation.pathname,search:n.state.prevLocation.search,state:p}):r.replace({pathname:`${ui.path}`,state:p})},[c,s,r]);return e.jsxs(_,{grow:[0,1],style:{height:"100%"},children:[e.jsx(Ei,{Icon:vn,title:e.jsxs(k,{gap:1,style:{alignItems:"center"},children:[e.jsx(m,{variant:"inherit",children:o==null?void 0:o.name}),o&&o.status!=="active"&&e.jsx(Dt,{rule:o})]}),onBackClick:l}),e.jsxs(rr,{grow:[0,1],children:[e.jsx("div",{}),i?e.jsx(ge,{children:e.jsx(Rt,{})}):a?e.jsx(wt,{error:a}):e.jsx(or,{rule:o})]})]})}const rr=f(_).withConfig({displayName:"RulePage__Container",componentId:"sc-y1732u-0"})(({theme:t})=>({background:t.palette.background.paper}));function lr(){const{enabled:t,loading:n}=At(),{rules:s,loading:o,error:i,loadMore:a}=mr(),r=$e(),c=n||o;return e.jsx(h,{grow:!0,scroll:!0,onScrollEnd:a,error:i,children:e.jsxs(hr,{data:s,loading:c,stickyHeader:!0,onClick:l=>r({ruleId:l.id??"",tab:"remediation"}),children:[e.jsx(F,{grow:2,header:"Remediable Rule Name",render:l=>e.jsxs(h,{row:!0,gap:!0,style:{maxWidth:500},children:[e.jsx(gi,{severity:l.severity}),e.jsxs(h,{column:!0,grow:!0,children:[e.jsx(m,{noWrap:!0,children:l.name}),e.jsx(m,{color:"textSecondary",noWrap:!0,children:l.description})]})]})}),e.jsx(F,{header:"Rule Status",render:l=>e.jsx(Dt,{rule:l})}),e.jsx(F,{header:"Enable Auto-Remediation",render:l=>e.jsx(h,{row:!0,center:!0,gap:!0,children:e.jsx(Mn,{disabled:!t||!Tt(l.remediation_config),checked:!!l.remediation_enable,ruleId:l.id??"",mutationOptions:{update(p){p.writeQuery({query:Wn,data:{remediation_rules:s.map(u=>u.id===l.id?{...u,remediation_enable:!l.remediation_enable}:u)}})}}})})}),e.jsx(F,{header:"Auto-Remediation Policy",render:l=>e.jsx(dr,{config:l.remediation_config})}),e.jsx(F,{header:"Last Changed",render:l=>{var p,u;return e.jsx(cr,{userId:(p=l.remediation_config)==null?void 0:p.remediation_config_last_updated_user_id,lastUpdatedTime:(u=l.remediation_config)==null?void 0:u.remediation_config_last_updated_time})}})]})})}function cr({userId:t,lastUpdatedTime:n}){const s=_t(n),{fullName:o}=ji(t,{});return e.jsx(h,{row:!0,center:!0,gap:!0,children:e.jsx(m,{color:"textSecondary",children:`${n?s:"--"} by ${t&&o||"--"}`})})}function dr({config:t}){return Tt(t)?e.jsxs(h,{row:!0,center:!0,gap:!0,children:[e.jsx(ur,{}),e.jsx(m,{color:"textSecondary",children:"Configured"})]}):e.jsx(bt,{title:"Auto Remediation Policy",content:e.jsx(m,{style:{maxWidth:250},children:"Auto-remediation policy has not been configured for this rule."}),children:e.jsxs(h,{row:!0,center:!0,gap:!0,children:[e.jsx(pr,{}),e.jsx(m,{color:"textSecondary",children:"Not Configured"})]})})}const ur=f(gn).withConfig({displayName:"AutoRemediationRulesTable__ConfiguredIcon",componentId:"sc-1836asu-0"})(({theme:t})=>({color:t.palette.common.green})),pr=f(hi).withConfig({displayName:"AutoRemediationRulesTable__NotConfiguredIcon",componentId:"sc-1836asu-1"})(({theme:t})=>({color:t.palette.common.red})),tt=50,Wn=A(`
  query RemediationRules {
    remediation_rules {
      id
      name
      description
      severity
      status
      remediation_enable
      remediation_config {
        ...AutoRemediationRuleConfigFields
        remediation_config_last_updated_time
        remediation_config_last_updated_user_id
      }
    }
  }
`);function mr(){var c;const[t]=me("search",""),{data:n,loading:s,error:o}=M(Wn),i=d.useCallback(()=>{var l;return((l=n==null?void 0:n.remediation_rules)==null?void 0:l.filter(p=>{var u,x;return!t||((u=p.name)==null?void 0:u.toLowerCase().includes(t.toLowerCase()))||((x=p.description)==null?void 0:x.toLowerCase().includes(t.toLowerCase()))}))||[]},[n==null?void 0:n.remediation_rules,t]),[a,r]=d.useState((c=i())==null?void 0:c.slice(0,tt));return d.useEffect(()=>{var l;r((l=i())==null?void 0:l.slice(0,tt))},[i]),{rules:a,loading:s,error:o,loadMore:d.useCallback(()=>{var l,p;(a==null?void 0:a.length)<((l=i())==null?void 0:l.length)&&r((p=i())==null?void 0:p.slice(0,a.length+tt))},[i,a==null?void 0:a.length])}}const hr=f(xi).withConfig({displayName:"AutoRemediationRulesTable__StyledTable",componentId:"sc-1836asu-2"})(({theme:t})=>({padding:t.spacing(2),[pi]:{background:t.palette.background.paper,marginBottom:t.spacing(1)},[mi]:{borderRadius:0,background:t.palette.background.default}}));function xr(){return e.jsxs(h,{column:!0,fullHeight:!0,children:[e.jsx(h,{paper:!0,pad:3,border:"bottom",children:e.jsxs(h,{row:!0,center:!0,gap:!0,children:[e.jsx(m,{variant:"subtitle1",children:"Workspace Auto-Remediation"}),e.jsx(bt,{title:"Workspace Auto-remediation",content:e.jsx(m,{style:{maxWidth:250},children:"Automatically apply remediations to policy violations within this workspace."}),children:e.jsx(ne,{fontSize:"small",color:"action"})}),e.jsx(fr,{}),e.jsx(h,{grow:!0}),e.jsx(gr,{})]})}),e.jsx(lr,{})]})}function gr(){const[t,n]=me("search",""),[s,o,i]=ke(t,500);return d.useEffect(()=>{t!==s&&n(s)},[s,t,n]),e.jsx(L,{variant:"outlined",size:"small",placeholder:"Search by rule name ",value:i,onChange:a=>o(a.target.value),style:{minWidth:300},InputProps:{startAdornment:e.jsxs(e.Fragment,{children:[e.jsx(mn,{fontSize:"small",color:"action"}),"  "]})}})}function jr(t){return d.useMemo(()=>({title:t?"Disable Workspace Auto-Remediation":"Enable Workspace Auto-Remediation",text:t?"Are you sure you want to disable auto-remediation for the entire workspace?":"Are you sure you want to enable auto-remediation for the entire workspace?",confirmText:t?"Disable":"Enable"}),[t])}function fr(){const{workspaceId:t}=Yt(),{enabled:n,loading:s}=At(),[o,{loading:i}]=Fn(yr(),jr(n));return e.jsxs(h,{row:!0,center:!0,gap:!0,children:[e.jsx(De,{disabled:s||i,checked:n,size:"small",onClick:()=>{o({variables:{workspace_id:t,enable:!n}})}}),!s&&e.jsx(m,{children:n?"Enabled":"Disabled"}),(s||i)&&e.jsx(se,{size:15})]})}function yr(){return ye(A(`
    mutation AutoRemediationWorkspaceEditEnabled($workspace_id: ID!, $enable: Boolean!) {
      edit_active_auto_remediation(workspace_id: $workspace_id, active: $enable) 
    }`),{update(t){var n,s;t.writeQuery({query:at,data:{workspace_auto_remediation_config:{__typename:"WorkspaceAutoRemediationConfig",active_auto_remediation:!((s=(n=t.readQuery({query:at}))==null?void 0:n.workspace_auto_remediation_config)!=null&&s.active_auto_remediation)}}})}})}function br(){const{results:t,loading:n,loadMore:s,error:o}=fi({query:Rr,getResults:i=>(i==null?void 0:i.remediation_executions)??[],getTotalCount:()=>null,limit:100});return e.jsx(h,{paper:!0,fullHeight:!0,onScrollEnd:s,error:o,scroll:!0,children:e.jsxs(yi,{data:t,loading:n,stickyHeader:!0,children:[e.jsx(F,{style:{minWidth:160},header:"Timestamp",render:i=>e.jsx(W,{children:e.jsx(bi,{noWrap:!0,value:i.start_time})})}),e.jsx(F,{grow:2,header:"Account / Region",render:i=>e.jsx(h,{column:!0,children:e.jsx(bn,{id:i.account_id,secondaryLabel:i.region})})}),e.jsx(F,{grow:2,style:{minWidth:200},header:"Remediated Resource",render:i=>e.jsx(St,{id:i.remediated_resource_id,resourceType:i.remediated_resource_type,showType:!0})}),e.jsx(F,{header:"Severity",render:i=>e.jsx(vr,{ruleId:i.violated_rule_id})}),e.jsx(F,{grow:4,header:"Violated Rule",render:i=>e.jsx(Cr,{ruleId:i.violated_rule_id})}),e.jsx(F,{grow:2,header:"Remediation Action",render:i=>i.runbook_name&&e.jsx(h,{round:!0,bg:!0,pad:!0,style:{maxWidth:"fit-content"},children:e.jsx(W,{children:e.jsx(ee,{color:"textSecondary",noWrap:!0,children:i.runbook_name})})})}),e.jsx(F,{grow:2,header:"Status",render:i=>e.jsxs(h,{row:!0,center:!0,gap:!0,children:[{Success:e.jsx(_i,{color:"success"}),Failed:e.jsx(yt,{color:"error"}),InProgress:e.jsx(ln,{color:"primary"})}[i.status??""]||e.jsx(e.Fragment,{}),e.jsx(W,{children:e.jsx(ee,{noWrap:!0,children:je(i.status)})})]})}),e.jsx(F,{grow:2,header:"Trigerring Event",render:i=>i.event_name?e.jsx(W,{children:e.jsx(ee,{noWrap:!0,children:i.event_id?e.jsx(_r,{eventId:i.event_id,children:i.event_name}):i.event_name})}):e.jsx(ee,{color:"textSecondary",children:"--"})}),e.jsx(F,{grow:3,header:"External Remediation ID",render:i=>e.jsx(W,{children:e.jsx(ee,{noWrap:!0,children:e.jsx("a",{href:i.execution_url??"",target:"_blank",rel:"noreferrer",children:i.execution_id})})})})]})})}function _r({eventId:t,children:n}){return e.jsx("a",{href:os(`${Ci.path}/${t}`),target:"_blank",rel:"noreferrer",children:n})}function vr({ruleId:t}){var s,o,i;const{data:n}=qn(t);return!t||!((s=n==null?void 0:n.rule)!=null&&s.severity)?null:e.jsxs(h,{row:!0,center:!0,gap:!0,children:[e.jsx(vi,{severity:(o=n==null?void 0:n.rule)==null?void 0:o.severity}),e.jsx(W,{children:e.jsx(ee,{noWrap:!0,children:Le((i=n==null?void 0:n.rule)==null?void 0:i.severity)})})]})}function Cr({ruleId:t,...n}){var o;const{data:s}=qn(t);return e.jsx(W,{children:e.jsx(ee,{clamp:!0,...n,children:(o=s==null?void 0:s.rule)==null?void 0:o.name})})}function qn(t){return M(A(`
    query RemediationRule($ruleId: ID) {
      rule(id: $ruleId) {
        name
        severity
      }
    }
  `),{variables:{ruleId:t}})}const Rr=A(`
  query RemediationExecutions($skip: Int, $limit: Int) {
    remediation_executions(skip: $skip, limit: $limit) {
      _id
      execution_id
      execution_url
      start_time
      account_id
      region
      remediated_resource_id
      remediated_resource_type
      violated_rule_id
      status
      event_name
      event_id
      runbook_name
    }
  }
`);function wr(){return e.jsxs(Sr,{children:[e.jsx(Ht,{value:"/settings",label:"Remediation Settings",component:xr}),e.jsx(Ht,{value:"/log",label:"Remediation Log",component:br})]})}function Sr({children:t}){const{url:n,path:s}=dt(),o=Xt(),i=Zt(),a=s.replace(st,""),r=J.Children.toArray(t)[0].props,c=o.replace(a,"")||r.value;return e.jsxs(h,{fullHeight:!0,column:!0,children:[e.jsx(h,{border:"bottom",paper:!0,children:e.jsx(Oe,{value:c,onChange:(l,p)=>i.push(n+p),children:t})}),e.jsx(h,{grow:!0,scroll:!0,children:e.jsxs(ut,{children:[J.Children.map(t,l=>{const{value:p,component:u}=l.props;return e.jsx(le,{path:`${s}${p}`,exact:!0,component:u})}),e.jsx(le,{path:s,exact:!0,component:r.component})]})})]})}function Ht({component:t,...n}){return e.jsx(ce,{...n})}const Gn=d.createContext({selectedRuleIds:new Set,setSelectedRuleIds:t=>{}});function Ir(){const{path:t}=dt(),[n,s]=d.useState(new Set);return e.jsx(Gn.Provider,{value:{selectedRuleIds:n,setSelectedRuleIds:s},children:e.jsxs(ut,{children:[e.jsx(le,{path:`${t}/`,exact:!0,component:Zo}),e.jsx(le,{path:`${t}/:id`,component:ar})]})})}function Or(){const t=`/${Xt().split("/")[1]}`,n=Kt();return e.jsxs(h,{column:!0,fullHeight:!0,children:[e.jsxs(h,{header:!0,paper:!0,style:{padding:0},children:[e.jsxs(h,{row:!0,center:!0,gap:!0,pad:2,children:[e.jsx(vn,{color:"action"}),e.jsx(m,{variant:"h5",children:"Rules"})]}),e.jsxs(Oe,{value:t,onChange:(s,o)=>n.push(o),children:[e.jsx(ce,{value:"/rules",label:"Rules"}),e.jsx(ce,{value:"/remediation",label:"Remediation Log & Settings"})]})]}),e.jsx(h,{grow:!0,scroll:!0,children:e.jsxs(ut,{children:[e.jsx(le,{path:`${st}/rules`,component:Ir}),e.jsx(le,{path:`${st}/remediation`,component:wr})]})})]})}export{Gn as SelectedRulesContext,Or as default};

import{m as ts,r as j,j as e,q as d,av as ue,aQ as C,I as Le,al as $e,o as J,e as fe,a7 as Oe,d as lt,f as ie,aR as ss,a as q,F as rs,aO as dt,aS as ns,X as os,p as as,aT as $,aU as P,k as is,w as cs,H as ls,v as ds,x as us}from"./index-CDz6_-F0.js";import{a7 as hs,fM as xs,fl as ps,d as r,hy as ms,hz as js,hA as ys,hB as gs,hC as ut,hD as ht,hE as xt,hF as pt,hG as mt,bb as fs,e$ as jt,R as B,hH as bs,m as yt,n as z,fG as Is,cj as vs,ck as Ne,cl as Ve,p as _,l as gt,hI as L,hJ as Cs,o as ws,F as ft,c as bt,S as Ue,di as ye,T as Ye,eX as Ss,hK as _s,bL as We,K as i,hL as It,I as se,bg as be,s as vt,ah as Ke,M as ks,ai as Rs,hM as Ct,cF as ce,B as ee,hN as As,aL as Ts,hO as Ns,q as O,hP as w,bz as Z,hQ as T,hR as wt,hS as Ws,ae as Ee,as as St,hT as Ae,hU as Es,hV as zs,hW as je,hX as Ls,bl as te,g as ge,cJ as _t,i as $s,j as kt,hY as Os,hZ as Us,bq as Rt,C as At,h_ as Ps,h$ as Bs,i0 as Tt,i1 as Nt,i2 as Ds,y as Ms,hw as Fs,i3 as Gs,i4 as Wt,fi as Et,L as zt,i5 as Hs,i6 as Vs,i7 as Ys,i8 as Ks,i9 as qs,b$ as Qs,f_ as Js,ia as qe,ib as Zs,er as Xs,ic as er,id as tr,ie as Lt,ig as sr,ih as rr,ii as nr,ij as or,ik as $t,il as Ot,im as Ut,io as oe,A as ar,ip as Pt,iq as ir,J as Bt,e as cr,bP as lr,c2 as dr,ir as ur,is as he,it as hr,iu as xr,iv as pr,iw as mr,ix as jr,iy as Te,iz as Qe,x as yr,an as gr,N as fr,O as Je,iA as Ze,iB as br,iC as Ir,iD as vr,iE as Cr,iF as wr,iG as Sr,iH as _r,iI as kr}from"./App-c61S4xKC.js";import{a as Dt,F as Mt}from"./webhook-mark-JBEld7N6.js";import{a as Ft,u as Gt,b as Pe,Y as Rr,S as Ar,c as Tr,d as Nr,e as Wr,f as Er,g as zr}from"./AddIntegrationTooltip-Hm0OBwX1.js";import Lr from"./Cloud_AWS_light-CzrMQba6.js";import $r from"./Cloud_AWS_dark-DTwdEQ-k.js";import Or from"./s3_bucket_light-BDi6A15I.js";import{H as Ur}from"./Header-CRo7NnqJ.js";var Ht={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=n(hs);function n(a){return a&&a.__esModule?a:{default:a}}var o=(0,s.default)("M4 2A2 2 0 0 0 2 4V20A2 2 0 0 0 4 22H12.41A7 7 0 0 0 16 23A7 7 0 0 0 23 16A7 7 0 0 0 18 9.3V8L12 2H4M4 4H11V9H16A7 7 0 0 0 9 16A7 7 0 0 0 10.26 20H4V4M16 11A5 5 0 0 1 21 16A5 5 0 0 1 16 21A5 5 0 0 1 11 16A5 5 0 0 1 16 11M15 12V17L18.61 19.16L19.36 17.94L16.5 16.25V12H15Z");t.default=o})(Ht);const Pr=ts(Ht),Br=d(r).withConfig({displayName:"IntegrationList__ListTitle",componentId:"sc-pry133-0"})(["display:inline-block;font-size:1rem;"]),Dr=d.div.withConfig({displayName:"IntegrationList__SideBySide",componentId:"sc-pry133-1"})(["display:flex;align-items:center;& > :first-child{margin-right:","px;}"],t=>t.theme.spacing(2)),Mr=d.div.withConfig({displayName:"IntegrationList__SpaceBetween",componentId:"sc-pry133-2"})(["display:flex;justify-content:space-between;margin-bottom:","px;"],t=>t.theme.spacing(2)),Fr=d($e).withConfig({displayName:"IntegrationList__TablePaper",componentId:"sc-pry133-3"})(["padding:","px;box-shadow:0px 3px 6px #00000029;&:not(:last-of-type){margin-bottom:","px;}"],t=>t.theme.spacing(1),t=>t.theme.spacing(2)),Gr={[C.Aws]:{Icon:()=>e.jsx(B,{id:"AWS",type:"Cloud",size:"medium"})},[C.Azure]:{Icon:()=>e.jsx(B,{id:"Azure",type:"Cloud",size:"medium"})},[C.Gcp]:{Icon:()=>e.jsx(B,{id:"GCP",type:"Cloud",size:"medium"})},slack:{Icon:()=>e.jsx(ue,{children:e.jsx(Mt,{})})},webhook:{Icon:()=>e.jsx(ue,{children:e.jsx(Dt,{})})},kubernetes:{Icon:()=>e.jsx(ue,{children:e.jsx(jt,{})})},cve:{Icon:()=>e.jsx(fs,{})},jira:{Icon:()=>e.jsx(ue,{children:e.jsx(mt,{})})},dp:{Icon:()=>e.jsx("img",{height:18,width:18,src:pt,alt:"Cyera icon"})},edr:{Icon:({id:t})=>({CrowdStrike:e.jsx(xt,{style:{width:"18px",height:"18px"}}),SentinelOne:e.jsx(ht,{style:{width:"18px",height:"18px"}}),Cortex:e.jsx(ut,{style:{width:"18px",height:"18px"}})})[t]}},Hr=d.div.withConfig({displayName:"IntegrationList__WarningContainer",componentId:"sc-pry133-4"})(["position:relative;display:flex;align-items:center;border-radius:","px;padding:","px;margin-bottom:","px;background-color:#252629;background:linear-gradient( 90deg,rgba(255,154,0,1) 2%,rgba(37,38,41,1) 7% );color:#fff;& > *:not(:last-child){margin-right:","px;}"],t=>t.theme.shape.borderRadius,t=>t.theme.spacing(2),t=>t.theme.spacing(2),t=>t.theme.spacing(3)),Vr=d(Le).withConfig({displayName:"IntegrationList__CloseWarning",componentId:"sc-pry133-5"})(["margin-left:auto;"]),Yr=d(Le).withConfig({displayName:"IntegrationList__AddIntegrationButton",componentId:"sc-pry133-6"})(["margin-right:","px;"],t=>t.theme.spacing(1));function Kr({children:t,...s}){return e.jsx(bs,{...s,children:t})}function W({id:t,title:s,type:n,addModal:o=void 0,integrations:a,selected:l,setSelected:c,handleOptionsClick:h}){var b,I;const[x,m]=j.useState(!0);return(a==null?void 0:a.length)>0&&e.jsxs(e.Fragment,{children:[e.jsxs(Mr,{children:[e.jsxs(Dr,{children:[(I=(b=Gr[n])==null?void 0:b.Icon)==null?void 0:I.call(b,{id:t}),e.jsxs(Br,{variant:"body1",children:[s," ",a.length>1&&`(${a.length})`]})]}),o&&e.jsx(Yr,{onClick:o,id:`${t}-addIntegration-button`,children:e.jsx(Ft,{color:"action"})})]}),n==="aws"&&x&&(a==null?void 0:a.reduce((g,N)=>{var k;return g+(N.status!=="PENDING"?((k=N.cloud_regions)==null?void 0:k.length)??0:0)},0))>(a==null?void 0:a.reduce((g,N)=>{var k;return g+(((k=N.realtime_regions)==null?void 0:k.length)||0)},0))&&e.jsx(xs,{children:e.jsxs(Hr,{children:[e.jsx(Kr,{$isDark:!0,children:e.jsx(ps,{})}),e.jsxs(r,{variant:"body2",children:["Some accounts are not configured to receive real-time events via CloudTrail on all managed regions.",e.jsx("br",{}),"It may cause a drift between the state of the account and its representation in the system."]}),e.jsx(Vr,{onClick:()=>m(!1),id:"closeWarning-button",children:e.jsx(ms,{color:"action"})})]})}),e.jsx(Fr,{children:e.jsx(js,{children:e.jsx(ys,{id:`${t}-listIntegrations`,children:a==null?void 0:a.map((g,N)=>e.jsx(gs,{id:`${t}-integration-${N}`,type:n,integration:g,isActive:(l==null?void 0:l._id)===g._id,setSelected:()=>c(g),handleOptionsClick:k=>h(g,k)},g._id))})})})]})}const qr=d.div.withConfig({displayName:"GroupedIntegrationInfo__GroupedInfo",componentId:"sc-15ngptr-0"})(["position:relative;display:flex;align-items:center;flex-wrap:wrap;overflow-wrap:break-word;img{align-self:flex-start;}.group-info-divider{width:100%;margin-bottom:","px;}&:first-of-type{.group-info-divider{display:none;}}"],t=>t.theme.spacing(2)),Qr=d.div.withConfig({displayName:"GroupedIntegrationInfo__ChildrenContainer",componentId:"sc-15ngptr-1"})(["display:flex;flex-direction:column;flex-basis:calc(100% - 30px - ","px);word-break:break-word;overflow:hidden;"],t=>t.theme.spacing(2)),Jr=yt(t=>({icon:{alignSelf:"flex-start",height:24,width:24,marginRight:t.spacing(2),color:`rgba(${t.palette.type==="dark"?"255, 255, 255":"0, 0, 0"}, 0.3)`,fill:t.palette.common.gray},muiIcon:{height:18,width:18}})),p=({Icon:t,children:s})=>{const n=Jr();return e.jsxs(qr,{children:[e.jsx(z,{className:"group-info-divider",light:!0}),typeof t=="string"?e.jsx("img",{src:t,alt:"Icon",className:n.icon}):e.jsx(t,{className:Is(n.icon,n.muiIcon)}),e.jsx(Qr,{children:s})]})},Zr=d(Or).withConfig({displayName:"CostOptionStep__BucketIconSvg",componentId:"sc-vklyfz-0"})(["path{fill:",";}height:25px;width:25px;"],t=>t.theme.palette.common.gray),Xe=d.div.withConfig({displayName:"CostOptionStep__OptionWrapper",componentId:"sc-vklyfz-1"})(["display:flex;& > *:not(:last-child){margin-bottom:","px;}"],t=>t.theme.spacing(2)),et=d.div.withConfig({displayName:"CostOptionStep__OptionIconWrapper",componentId:"sc-vklyfz-2"})(["background-color:",";border:2px solid ",";display:flex;flex-shrink:0;justify-content:center;align-items:center;width:60px;height:60px;border-radius:10px;margin-right:","px;"],t=>J(t.theme.palette.common.gray,.2),t=>t.$selected?t.theme.palette.primary.main:"none",t=>t.theme.spacing(2)),Xr=({handleNext:t,updateStep:s})=>{const[n,o]=j.useState("1"),a=l=>{l.preventDefault(),s({createCURAndBucket:n}),t()};return e.jsxs("form",{onSubmit:a,id:"wizard-form",children:[e.jsx(r,{variant:"h6",paragraph:!0,children:"Connect with CUR"}),e.jsxs(r,{variant:"subtitle2",color:"textSecondary",paragraph:!0,children:["Follow the steps below to enable the integration of Cost and Usage report from AWS. ",e.jsx("br",{}),"There are two different options for CUR setup:"]}),e.jsxs(vs,{"aria-label":"Theme",value:n,onChange:l=>o(l.target.value),children:[e.jsx(Ne,{value:"1",control:e.jsx(Ve,{color:"primary",id:"preferences-lightMode-input"}),label:e.jsxs(Xe,{children:[e.jsx(et,{$selected:n==="1",children:e.jsx(Ft,{color:"action"})}),e.jsxs("div",{children:[e.jsx(r,{variant:"subtitle1",children:"Create new CUR file"}),e.jsx(r,{variant:"body1",color:"textSecondary",children:"This option automatically creates the proper setup (CUR, S3 Bucket, and permissions)"})]})]})}),e.jsx(Ne,{value:"0",control:e.jsx(Ve,{color:"primary",id:"preferences-defaultMode-input"}),label:e.jsxs(Xe,{children:[e.jsx(et,{$selected:n==="0",children:e.jsx(Zr,{})}),e.jsxs("div",{style:{flex:"auto"},children:[e.jsx(r,{variant:"subtitle1",children:"Connect to existing S3 bucket"}),e.jsx(r,{variant:"body1",color:"textSecondary",children:"This option makes use of an existing S3 bucket that has historical CUR files."})]})]})})]}),e.jsx("br",{}),e.jsx(_,{variant:"contained",type:"submit",fullWidth:!0,color:"primary",children:"Next"})]})},Q="us-east-1",en=yt(t=>({submitButtons:{display:"flex",justifyContent:"flex-end","& > *:not(:last-child)":{marginRight:t.spacing(1)}}})),tn=({handleNext:t,stepsState:s,updateStep:n,optionalInfo:o,onClose:a})=>{const l=en(),{workspaceId:c}=fe(),h=`${gt()}-streamsec-cost-stack-${c}`,x=m=>{m.preventDefault();const b=window.location.hostname.endsWith("streamsec.io"),I=b?"https://prod-lightlytics-public-cloudformation.s3.amazonaws.com/lightlytics-cost-main.yaml":"https://public-lightlytics-cft.s3.amazonaws.com/lightlytics-cost-main.yaml";window.open(`https://${s.region||Q}.console.aws.amazon.com/cloudformation/home?region=${s.region||Q}#/stacks/create/review?templateURL=${I}&stackName=${h}&param_LightlyticsCostCollectionToken=${o==null?void 0:o.lightlytics_collection_token}&param_CFTBucketName=${b?"prod-lightlytics-public-cloudformation":"public-lightlytics-cft"}&param_LightlyticsApiUrl=${window.location.protocol}//${window.location.hostname}&param_LightlyticsAwsAccountId=${b?"624907860825":"654654251344"}${(s==null?void 0:s.createCURAndBucket)==="0"?`&param_CURBucketName=${s==null?void 0:s.bucketName}${s!=null&&s.prefixPath?`&param_CURBucketPrefix=${s==null?void 0:s.prefixPath}`:""}`:`&param_CURBucketName=lightlytics-cur-${o==null?void 0:o.cloud_account_id}`}&param_CreateCURAndBucket=${s==null?void 0:s.createCURAndBucket}`,"_blank"),t()};return e.jsxs("form",{onSubmit:x,id:"wizard-form",children:[(s==null?void 0:s.createCURAndBucket)==="0"?e.jsx(rn,{regions:(o==null?void 0:o.cloud_regions)||[],updateStep:n}):e.jsx(sn,{regions:(o==null?void 0:o.cloud_regions)||[],updateStep:n}),e.jsxs("div",{className:l.submitButtons,children:[e.jsx(_,{variant:"text",onClick:a,children:"Dismiss"}),e.jsx(_,{variant:"contained",type:"submit",color:"primary",children:"Launch Stack"})]})]})},sn=()=>e.jsxs(e.Fragment,{children:[e.jsx(r,{variant:"h6",paragraph:!0,children:"Create a new CUR file"}),e.jsx(r,{variant:"subtitle2",color:"textSecondary",paragraph:!0,children:"Select the region where the S3 bucket will contain CUR file(s)"}),e.jsxs(ft,{fullWidth:!0,variant:"outlined",children:[e.jsx(bt,{children:"Select Region"}),e.jsx(Ue,{fullWidth:!0,value:Q,placeholder:"Select Region",label:"Select Region",variant:"outlined",disabled:!0,children:e.jsx(ye,{value:Q,children:e.jsx(Ss,{title:e.jsxs(r,{variant:"body2",children:["The AWS Cost and Usage Report service is only available in",Q," currently."]}),children:e.jsxs("div",{style:{display:"flex"},children:[e.jsx(_s,{color:"action",fontSize:"small",display:"inline",style:{marginLeft:"3px"}})," ",Q]})})})})]}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("br",{}),e.jsx(r,{variant:"subtitle2",color:"textSecondary",paragraph:!0,children:"Clicking on “Launch stack” will open AWS console. launch and approve a new stack that will create the necessary resources to forward CUR files."})]}),rn=({regions:t,updateStep:s})=>e.jsxs(e.Fragment,{children:[e.jsx(r,{variant:"h6",paragraph:!0,children:"Connect to existing S3 Bucket"}),e.jsxs(L,{color:"gray",padding:3,Icon:Cs,children:[e.jsx(r,{variant:"body2",gutterBottom:!0,children:"Ensure the CUR configuration meets the prerequisite for this integration"}),e.jsx(ws,{variant:"subtitle2",color:"secondary",href:"https://docs.streamsec.io/docs/costs-integration#connect-to-existing-s3-bucket",target:"_blank",children:"Read More ->"})]}),e.jsx("br",{}),e.jsxs(ft,{fullWidth:!0,variant:"outlined",children:[e.jsx(bt,{children:"Select Region"}),e.jsx(Ue,{defaultValue:Q,onChange:n=>s({region:n.target.value}),fullWidth:!0,placeholder:"Select Region",label:"Select Region",variant:"outlined",children:t==null?void 0:t.map(n=>e.jsx(ye,{value:n,children:n},n))})]}),e.jsx("br",{}),e.jsx("br",{}),e.jsx(Ye,{label:"S3 Bucket Name",fullWidth:!0,defaultValue:"",variant:"outlined",onChange:n=>s({bucketName:n.target.value}),required:!0}),e.jsx("br",{}),e.jsx("br",{}),e.jsx(Ye,{label:"Report path prefix",fullWidth:!0,required:!0,defaultValue:"",variant:"outlined",onChange:n=>s({prefixPath:n.target.value})}),e.jsx("br",{}),e.jsx("br",{}),e.jsx(r,{variant:"subtitle2",color:"textSecondary",paragraph:!0,children:'Clicking on "Launch stack” will open AWS console. Launch and approve a new stack that will create the necessary resources to forward CUR files.'})]}),nn=[{label:"Cost Module",stepLabel:"Integration options",Component:Xr,maxWidth:"700px",Icon:We,hideSubmit:!0},{Icon:We,label:"Cost Module",stepLabel:"Launch Stack",Component:tn,maxWidth:"700px",hideSubmit:!0}];function on(t){const s=Oe(),n=lt(),[o,a]=j.useState(!1),[l,c]=j.useState(null),[h,x]=j.useState();return j.useEffect(()=>{I();async function I(){try{a(!0);let g=await m();g||(await b(),g=await m()),x(g)}catch(g){n(g.message,"error"),c(g)}finally{a(!1)}}},[]),{templateURL:h,loading:o,error:l};async function m(){var g;const{data:I}=await s.query({query:ie(`
        query AutoRemediationTemplate($accountId: ID) {
            account(id: $accountId) {
                _id
                remediation_template_url
            }
        }    
    `),fetchPolicy:"network-only",variables:{accountId:t}});return(g=I==null?void 0:I.account)==null?void 0:g.remediation_template_url}async function b(){await s.mutate({mutation:ie(`
        mutation GenerateAutoRemediationTemplate($accountId: ID!) {
            remediation_generate_template(cloud_account_id: $accountId) 
        }
    `),variables:{accountId:t}})}}function an({accountId:t,onClose:s}){const{workspaceId:n}=fe(),[o,a]=j.useState(tt[0]),l=`${gt()}-streamsec-remediation-stack-${n}`,{templateURL:c,loading:h,error:x}=on(t);return e.jsxs(i,{column:!0,children:[e.jsxs(i,{row:!0,center:!0,gap:!0,pad:2,children:[e.jsx(It,{color:"action"}),e.jsx(r,{variant:"subtitle1",children:"Enable Auto-Remediation"}),e.jsx(i,{grow:!0}),e.jsx(se,{size:"small",onClick:s,children:e.jsx(be,{fontSize:"small"})})]}),e.jsx(i,{pad:2,children:x?e.jsx(vt,{error:x}):e.jsxs(i,{column:!0,gap:2,style:{minWidth:400},children:[e.jsxs(i,{round:!0,bg:!0,pad:2,row:!0,gap:!0,children:[e.jsx(Ke,{color:"action"}),e.jsx(r,{children:"You are about to deploy the auto remediation stack with the required resources. Please ensure that you are logged in to the appropriate cloud account in your console and that you have the necessary permissions to create these resources before proceeding with the stack creation."})]}),e.jsxs(i,{row:!0,center:!0,gap:!0,children:[e.jsx(r,{variant:"subtitle2",children:"Select Region"}),e.jsx(Ke,{fontSize:"small",color:"action"})]}),e.jsx(Ue,{fullWidth:!0,variant:"outlined",value:o,onChange:b=>a(b.target.value),children:tt.map(b=>e.jsx(ks,{value:b,children:Rs[b].name},b))}),e.jsx(r,{color:"textSecondary",children:"The stack creation process may take up to 1 minute. Once it has been created successfully, the remediation status in your integration section will be updated accordingly."})]})}),e.jsxs(i,{pad:2,row:!0,center:!0,gap:!0,children:[h&&e.jsx(r,{color:"textSecondary",children:"Loading template..."}),e.jsx(i,{grow:!0}),e.jsx(_,{variant:"text",onClick:s,children:"Cancel"}),e.jsx(_,{color:"primary",disabled:!c||h,onClick:m,endIcon:e.jsx(Ct,{fontSize:"small"}),children:"Deploy Stack"})]})]});async function m(){if(!c)return;const b=ss(`https://console.aws.amazon.com/cloudformation/home?region=${o}#/stacks/quickcreate`,{templateURL:c,stackName:l});window.open(b,"_blank"),s()}}const tt=["us-east-1","us-east-2","us-west-1","us-west-2","ap-south-1","ap-northeast-3","ap-northeast-2","ap-southeast-1","ap-southeast-2","ap-northeast-1","ca-central-1","eu-central-1","eu-west-1","eu-west-2","eu-west-3","eu-north-1","sa-east-1"];function cn(t){var a;const{data:s,loading:n}=q(ie(`
        query AccountAutoRemediationConfig($accountId: ID) {
            account(id: $accountId) {
                _id
                remediation {
                    status
                    template_version
                    external_id
                    role_arn
                    stack_id
                }
            }
        }    
    `),{variables:{accountId:t}}),o=(a=s==null?void 0:s.account)==null?void 0:a.remediation;return{config:o,enabled:!!(o!=null&&o.status),loading:n}}function ln(t){const{config:s,enabled:n,loading:o}=cn(t.accountId);return e.jsx(i,{column:!0,gap:!0,children:e.jsx(un,{icon:e.jsx(It,{color:"action"}),title:"Auto Remediation",indicator:e.jsx(hn,{enabled:n}),action:!n&&!o&&e.jsx(mn,{accountId:t.accountId}),children:o?e.jsx(r,{color:"textSecondary",children:"Loading..."}):n?e.jsx(dn,{config:s}):e.jsx(r,{color:"textSecondary",style:{maxWidth:350},children:"Set up the necessary resources in your Cloud Account to activate Auto-Remediation capabilities."})})})}function dn(t){var s,n;return e.jsxs(i,{column:!0,gap:2,children:[e.jsxs("div",{children:[e.jsx(r,{color:"textSecondary",children:"Remediation Execution Role"}),e.jsx(r,{children:((s=t.config)==null?void 0:s.role_arn)??"N/A"})]}),e.jsxs("div",{children:[e.jsx(r,{color:"textSecondary",children:"Version"}),e.jsx(r,{children:((n=t.config)==null?void 0:n.template_version)??"N/A"})]})]})}function un({icon:t,title:s,action:n,indicator:o,children:a}){return e.jsxs(i,{column:!0,gap:!0,children:[e.jsxs(i,{row:!0,gap:2,center:!0,children:[t,e.jsx(pn,{children:s}),o,e.jsx(i,{grow:!0}),n]}),e.jsxs(i,{row:!0,gap:2,children:[e.jsx(i,{hidden:!0,children:t}),a]})]})}function hn(t){return t.enabled?e.jsxs(xn,{row:!0,center:!0,gap:!0,pad:!0,round:!0,children:[e.jsx(As,{fontSize:"small",color:"success"}),e.jsx(r,{children:"Deployed"})]}):e.jsxs(i,{row:!0,center:!0,gap:!0,round:!0,bg:!0,pad:!0,children:[e.jsx(be,{color:"action",fontSize:"small"}),e.jsx(r,{children:"Not Deployed"})]})}const xn=d(i).withConfig({displayName:"AutoRemediationConfig__GreenLayout",componentId:"sc-u0b7ar-0"})(({theme:t})=>({background:J(t.palette.common.green,.25)})),pn=d(r).withConfig({displayName:"AutoRemediationConfig__Title",componentId:"sc-u0b7ar-1"})(["font-size:","px;font-weight:",";"],t=>t.theme.typography.subtitle1.fontSize,t=>t.theme.typography.fontWeightMedium);function mn(t){const s=ce();return e.jsx(ee,{size:"small",color:"primary",onClick:()=>s.open(n=>e.jsx(an,{accountId:t.accountId,...n}),{fullWidth:!1}),children:"Create Stack"})}const xe=d(r).withConfig({displayName:"InspectIntegrationAWS__CategoryTitle",componentId:"sc-ss5b44-0"})(["font-size:13px;font-weight:500;margin-right:","px;& ~ *:not(:last-child){margin-top:","px;}"],t=>t.theme.spacing(1),t=>t.theme.spacing(1)),ae=d.div.withConfig({displayName:"InspectIntegrationAWS__SpaceBetween",componentId:"sc-ss5b44-1"})(["display:flex;justify-content:space-between;align-items:center;"]),st=d.div.withConfig({displayName:"InspectIntegrationAWS__SpaceWrapper",componentId:"sc-ss5b44-2"})(["margin-top:","px;"],t=>t.theme.spacing(t.$marTop)),jn=({integration:t,handleOptionsClick:s})=>{var c,h,x,m,b,I,g,N,k;const n=Ts((c=t==null?void 0:t.cost)==null?void 0:c.last_timestamp),o=rs(),a=j.useMemo(()=>Ns(t),[t]);if(!t)return e.jsx(O,{children:e.jsx(r,{color:"textSecondary",children:"Nothing selected..."})});const l=w[t.status]||w.default;return e.jsxs(D,{children:[e.jsxs(p,{Icon:o.palette.type==="dark"?$r:Lr,children:[e.jsx(G,{children:e.jsx(Z,{options:a,onClickOptions:s})}),e.jsx(r,{variant:"subtitle2",color:"textSecondary",children:"Amazon Web Services"}),e.jsx(r,{variant:"h6",children:t.cloud_account_id}),t.display_name&&e.jsx(r,{noWrap:!0,variant:"body2",color:"textSecondary",children:t.display_name})]}),e.jsx(p,{Icon:R=>e.jsx("div",{...R}),children:e.jsxs(L,{...l,padding:1,InnerWrap:"div",children:[e.jsx(xe,{id:"integrationStatus",children:l.label}),l.Info&&e.jsx(l.Info,{integration:t,handleOptionsClick:s})]})}),e.jsxs(p,{Icon:l.icon||T,children:[e.jsx(xe,{children:"Account Properties"}),e.jsx(y,{variant:"body2",color:"textSecondary",children:"Collection token"}),e.jsx(wt,{textToCopy:t==null?void 0:t.lightlytics_collection_token,title:"Collection token",children:e.jsx(r,{variant:"subtitle2",noWrap:!0,children:t==null?void 0:t.lightlytics_collection_token})})]}),e.jsxs(p,{Icon:We,children:[e.jsxs(ae,{children:[e.jsx(xe,{children:"Cost Module"}),((h=t==null?void 0:t.cost)==null?void 0:h.status)==="success"&&((x=t==null?void 0:t.cost)==null?void 0:x.operation)!=="Delete"&&e.jsx("div",{children:n?e.jsxs(ae,{children:[e.jsx(Ws,{color:"secondary"}),"  Enabled"]}):e.jsxs(ae,{children:[e.jsx(Pr,{color:"action"}),"  Pending"]})})]}),((m=t==null?void 0:t.cost)==null?void 0:m.status)==="success"&&((b=t==null?void 0:t.cost)==null?void 0:b.operation)!=="Delete"?e.jsxs(e.Fragment,{children:[e.jsx(Ee,{title:`CUR prefix path: ${(I=t==null?void 0:t.cost)==null?void 0:I.cur_prefix}`,children:e.jsx(y,{variant:"body2",color:"textSecondary",children:"CUR file location"})}),e.jsx(St,{id:(g=t==null?void 0:t.cost)==null?void 0:g.bucket_arn}),e.jsx(y,{variant:"body2",color:"textSecondary",children:"Last file received time-stamp"}),e.jsx(Ee,{title:n,children:e.jsx(r,{variant:"subtitle2",noWrap:!0,children:n||"Waiting for first CUR file"})})]}):e.jsx("div",{style:{paddingTop:6},children:e.jsx(r,{component:"a",color:"primary",onClick:()=>s({steps:nn.map(R=>({...R,optionalInfo:{...t}}))}),children:"Configure"})})]}),e.jsx(z,{}),e.jsx(ln,{accountId:t.cloud_account_id}),e.jsxs(p,{Icon:Ae,children:[e.jsx(st,{$marTop:-2/3,children:e.jsxs(ae,{children:[e.jsxs(ae,{children:[e.jsxs(xe,{children:["Regions (",t.cloud_regions.length,")"]}),e.jsx(_,{variant:"text",onClick:()=>s({label:"Edit Regions",steps:[{optionalInfo:{...t},label:`Edit regions ${t.cloud_account_id}`,Component:Es,Icon:Ae,hideSubmit:!0}],Icon:Ae,hideSubmit:!0,submitStepText:"Edit regions"}),size:"small",children:e.jsx(r,{variant:"body2",color:"textSecondary",children:"Edit"})})]}),e.jsxs(r,{color:"textSecondary",variant:"body2",children:[((N=t==null?void 0:t.realtime_regions)==null?void 0:N.length)||0," Real-time"]})]})}),e.jsx(st,{$marTop:2}),e.jsx(zs,{regions:t.cloud_regions,realtime_regions:(k=t==null?void 0:t.realtime_regions)==null?void 0:k.map(R=>R.region_name),templateURL:t.collection_template_url,onEnable:()=>s({steps:[je[2]].map(R=>({...R,maxWidth:"500px",label:`${t.cloud_account_id}${t.display_name?` ${t.display_name}`:""}`,optionalInfo:{...t,_id:t._id,accountId:t.cloud_account_id,primaryRegion:t.cloud_regions[0],collection_template_url:t.collection_template_url}}))})})]})]})},ze=d(r).withConfig({displayName:"InspectIntegrationAzure__CategoryTitle",componentId:"sc-1jomprx-0"})(["font-size:13px;font-weight:500;margin-right:","px;& ~ *:not(:last-child){margin-top:","px;}"],t=>t.theme.spacing(1),t=>t.theme.spacing(1)),yn=d.div.withConfig({displayName:"InspectIntegrationAzure__CategoryAction",componentId:"sc-1jomprx-1"})(["position:absolute;top:0;right:0;"]),gn=({integration:t,handleOptionsClick:s})=>{const n=j.useMemo(()=>Ls(t),[t]);if(!t)return e.jsx(O,{children:e.jsx(r,{color:"textSecondary",children:"Nothing selected..."})});const o=w[t.status]||w.default;return e.jsxs(D,{children:[e.jsxs(p,{Icon:a=>e.jsx(B,{type:"Cloud",id:"Azure",...a}),children:[e.jsx(G,{children:e.jsx(Z,{options:n,onClickOptions:s})}),e.jsx(r,{variant:"subtitle2",color:"textSecondary",children:"Azure"}),t.display_name&&e.jsx(r,{noWrap:!0,variant:"body2",color:"textSecondary",children:t.display_name})]}),e.jsx(p,{Icon:a=>e.jsx("div",{...a}),children:e.jsxs(L,{...o,padding:1,InnerWrap:"div",children:[e.jsx(ze,{id:"integrationStatus",children:o.label}),o.Info&&e.jsx(o.Info,{integration:t,handleOptionsClick:s})]})}),e.jsxs(p,{Icon:T,children:[e.jsx(ze,{children:"Application Properties"}),e.jsx(rt,{title:"API Key",value:t==null?void 0:t.account_token}),e.jsx(rt,{title:"Tenant ID",value:t==null?void 0:t.tenant_id})]}),e.jsx(fn,{account:t})]})};function fn({account:t}){const s=j.useMemo(()=>(t==null?void 0:t.subscriptions)||[],[t]),n=lt(),[o,a]=j.useState(!1),[l,{loading:c,error:h}]=$s(_n,{variables:{id:t._id},onCompleted(){n("Subscriptions updated successfully","success")},onError(x){n(`Subscriptions update error ${x.message}`,"error")}});return e.jsxs(p,{Icon:Os,children:[e.jsx(ze,{children:`${(s==null?void 0:s.length)||""} Subscriptions`}),e.jsx(yn,{children:e.jsx(Ee,{disabled:!!t.template_url,title:"Missing template URL",children:e.jsx("div",{children:e.jsx(ee,{variant:"text",color:"primary",onClick:()=>a(!0),disabled:!t.template_url,children:"Add subscription"})})})}),(s==null?void 0:s.length)>0?e.jsx(vn,{account:t,loading:c,subscriptions:s,onRemove:x=>l({variables:{account:{subscriptions:s.map(({id:m})=>m).filter(m=>m!==x.id)}}})}):e.jsx(r,{color:"textSecondary",children:"No subscriptions"}),e.jsx(In,{open:o,onClose:()=>a(!1),templateUrl:t==null?void 0:t.template_url})]})}const bn=d.div.withConfig({displayName:"InspectIntegrationAzure__AzureSubscriptionDetails",componentId:"sc-1jomprx-2"})(({theme:t})=>({backgroundColor:t.palette.background.default,borderRadius:"12px",padding:t.spacing(3,2)}));function In({open:t,onClose:s,templateUrl:n}){const o=()=>{window.open(n)};return e.jsx(Rt,{open:t,onClose:s,children:e.jsxs(Vt,{children:[e.jsxs(te,{gap:1,grow:[0,1,0],children:[e.jsx(B,{type:"Cloud",id:"Azure"}),e.jsx(r,{variant:"subtitle1",children:"Add New Azure Subscriptions"}),e.jsx(se,{onClick:s,children:e.jsx(be,{})})]}),e.jsx(bn,{children:e.jsxs(r,{variant:"body1",children:["To add a new subscription, update and redeploy the existing ARM template in your Azure environment by following these steps:",e.jsx("br",{}),e.jsx("br",{}),"1. Navigate to your existing Stream Security ARM template deployment",e.jsx("br",{}),"2. Add your new subscription ID to the template parameters",e.jsx("br",{}),"3. Redeploy the template to update the configuration"]})}),e.jsx(L,{color:"yellow",children:e.jsx(r,{variant:"body1",children:"Once the ARM template is updated, Stream will automatically start scanning the newly added subscriptions. This process may take some time to complete."})}),e.jsxs(te,{gap:1,grow:[1],children:[e.jsx("div",{}),e.jsx(ee,{variant:"text",onClick:s,children:"Cancel"}),e.jsx(ee,{variant:"contained",color:"primary",onClick:o,disabled:!n,endIcon:e.jsx(Ct,{style:{width:16,height:16}}),children:"Open ARM Template"})]})]})})}const Vt=d.div.withConfig({displayName:"InspectIntegrationAzure__DialogContainer",componentId:"sc-1jomprx-3"})(({theme:t})=>({display:"flex",flexDirection:"column",gap:t.spacing(2),padding:t.spacing(2)}));function vn({account:t,subscriptions:s,loading:n,onRemove:o}){const[a,l]=j.useState(null),c=()=>{l(null)},h=async()=>{await o(a),c()};return e.jsxs(wn,{children:[s.map((x,m)=>e.jsxs(Sn,{children:[e.jsx(St,{id:`${t.cloud_account_id}_${x.id}`,disableIcon:!0,disableMenu:!0,disableTooltip:!0}),x.real_time&&e.jsx(Us,{size:"small",color:"primary",children:"Real-time"}),e.jsx("div",{style:{flexGrow:1}})]},m)),e.jsx(Rt,{open:!!a,onClose:()=>l(null),children:e.jsxs(Vt,{style:{maxWidth:400},children:[e.jsxs(te,{gap:1,grow:[0,1,0],children:[e.jsx(B,{type:"Cloud",id:"Azure"}),e.jsx(r,{variant:"subtitle1",children:"Remove subscription"}),e.jsx(se,{onClick:c,children:e.jsx(be,{})})]}),e.jsx(r,{children:"Continue with this action will remove all subscription data and settings from this Application."}),e.jsx(r,{children:"Would you like to to continue?"}),e.jsxs(te,{gap:1,grow:[1],children:[e.jsx("div",{}),e.jsx(ee,{variant:"text",onClick:c,children:"Cancel"}),e.jsx(Cn,{variant:"outlined",startIcon:n&&e.jsx(At,{size:15}),disabled:n,onClick:h,children:"Yes, Remove"})]})]})})]})}const Cn=d(ee).withConfig({displayName:"InspectIntegrationAzure__RedButton",componentId:"sc-1jomprx-4"})(({theme:t})=>({color:t.palette.common.red,borderColor:t.palette.common.red})),wn=d.div.withConfig({displayName:"InspectIntegrationAzure__SubscriptionsListContainer",componentId:"sc-1jomprx-5"})(({theme:t})=>({display:"flex",flexDirection:"column",border:`solid 1px ${t.palette.dividerLight}`,padding:t.spacing(1),borderRadius:t.shape.borderRadius,marginTop:t.spacing(2)})),Sn=d.div.withConfig({displayName:"InspectIntegrationAzure__Subscription",componentId:"sc-1jomprx-6"})(({theme:t})=>({display:"flex",flexDirection:"row",alignItems:"center",padding:t.spacing(1),borderRadius:t.shape.borderRadius/2,"&:nth-child(even)":{background:J(t.palette.background.default,.5)}})),_n=kt(`
  mutation UpdateSubscriptions($id: ID!, $account: AccountUpdateInput) {
    updateAccount(id: $id, account: $account) {
      _id
      subscriptions {
        id
      }
    }
  }
`);function rt({value:t,title:s}){const n=dt();return t?e.jsxs(e.Fragment,{children:[e.jsx(y,{variant:"body2",color:"textSecondary",children:s}),e.jsxs(te,{gap:1,grow:[1,0],className:"hover-me",children:[e.jsx(ge,{children:e.jsx(r,{variant:"subtitle2",noWrap:!0,children:t})}),e.jsx(se,{size:"small",className:"hide-me",onClick:()=>n(t),children:e.jsx(_t,{fontSize:"small"})})]})]}):e.jsx(e.Fragment,{})}const nt=d(r).withConfig({displayName:"InspectIntegrationGCP__CategoryTitle",componentId:"sc-1dg2msl-0"})(["font-size:13px;font-weight:500;margin-right:","px;& ~ *:not(:last-child){margin-top:","px;}"],t=>t.theme.spacing(1),t=>t.theme.spacing(1)),kn=({integration:t})=>{const s=w[t==null?void 0:t.status]||w.default;return e.jsxs(D,{children:[e.jsxs(p,{Icon:n=>e.jsx(B,{type:"Cloud",id:"GCP",...n}),children:[e.jsx(G,{children:e.jsx(Ps,{account:t})}),e.jsx(r,{variant:"subtitle2",color:"textSecondary",children:"Google Cloud Platform"}),(t==null?void 0:t.display_name)&&e.jsx(r,{noWrap:!0,variant:"body2",color:"textSecondary",children:t==null?void 0:t.display_name})]}),e.jsx(p,{Icon:n=>e.jsx("div",{...n}),children:e.jsxs(L,{...s,padding:1,InnerWrap:"div",children:[e.jsx(nt,{id:"integrationStatus",children:s.label}),s.Info&&e.jsx(s.Info,{integration:t})]})}),e.jsxs(p,{Icon:T,children:[e.jsx(nt,{children:"Integration Properties"}),(t==null?void 0:t.account_type)&&e.jsx(pe,{title:{[C.Gcp]:"Google Project ID",[C.GoogleWorkspace]:"Workspace Customer ID"}[t.account_type],value:t.cloud_account_id}),e.jsx(pe,{title:"Domain",value:window.location.hostname}),e.jsx(pe,{title:"Client Email",value:t==null?void 0:t.client_email}),e.jsx(pe,{title:"Project Token",value:t==null?void 0:t.account_token})]})]})};function pe({value:t,title:s}){const n=dt();return t?e.jsxs(e.Fragment,{children:[e.jsx(y,{variant:"body2",color:"textSecondary",children:s}),e.jsxs(te,{gap:1,grow:[1,0],className:"hover-me",children:[e.jsx(ge,{children:e.jsx(r,{variant:"subtitle2",noWrap:!0,children:t})}),e.jsx(se,{size:"small",className:"hide-me",onClick:()=>n(t),children:e.jsx(_t,{fontSize:"small"})})]})]}):e.jsx(e.Fragment,{})}const Rn=d(_).withConfig({displayName:"InspectIntegrationSlack__RemoveButton",componentId:"sc-1f2x23k-0"})(["color:",";border-color:",";"],t=>t.theme.palette.common.error,t=>t.theme.palette.common.error),An=({integration:t,handleOptionsClick:s})=>{const n=j.useMemo(()=>Bs(t),[t]);if(!t)return e.jsx(O,{children:e.jsx(r,{color:"textSecondary",children:"Nothing selected..."})});const o=w[t.status]||w.default;return e.jsxs(D,{children:[e.jsxs(p,{Icon:Mt,children:[e.jsx(G,{children:e.jsx(Z,{options:n,onClickOptions:s})}),e.jsx(r,{variant:"subtitle2",color:"textSecondary",children:"Slack"}),e.jsx(r,{variant:"h6",children:t.incoming_webhook.channel})]}),e.jsx(p,{Icon:a=>e.jsx("div",{...a}),children:e.jsxs(L,{...o,padding:t.unhealthy_reason?2:1,children:[e.jsx(r,{variant:"subtitle2",children:o.label}),t.unhealthy_reason&&e.jsxs(e.Fragment,{children:[e.jsxs(r,{variant:"body2",paragraph:!0,children:["We encountered an error while trying to send messages to"," ",t.incoming_webhook.channel,". Slack webhook or workspace are either missing or invalid"]}),e.jsx(Rn,{variant:"outlined",type:"submit",onClick:()=>s(n[2]),children:"Remove this integration"})]})]})}),e.jsxs(p,{Icon:o.icon||T,children:[e.jsx(r,{variant:"subtitle2",children:"Account Properties"}),e.jsx(y,{variant:"body2",color:"textSecondary",children:"Slack Workspace"}),e.jsx(r,{variant:"subtitle2",children:t.team.name})]}),e.jsxs(p,{Icon:Tt,children:[e.jsx(r,{variant:"subtitle2",children:"Alerts Properties"}),e.jsx(Be,{onClick:()=>s(n[0]),children:"Edit"}),e.jsx(Nt,{state:t.notify_settings,view:!0})]})]})},Tn=d(_).withConfig({displayName:"InspectIntegrationWebhook__RemoveButton",componentId:"sc-71lri9-0"})(["color:",";border-color:",";"],t=>t.theme.palette.common.error,t=>t.theme.palette.common.error),Nn=({integration:t,handleOptionsClick:s})=>{const n=j.useMemo(()=>Ds(t),[t]);if(!t)return e.jsx(O,{children:e.jsx(r,{color:"textSecondary",children:"Nothing selected..."})});const o=w[t.status]||w.default;return e.jsxs(D,{children:[e.jsxs(p,{Icon:Dt,children:[e.jsx(G,{children:e.jsx(Z,{options:n,onClickOptions:s})}),e.jsx(r,{variant:"subtitle2",color:"textSecondary",children:"Webhook"})]}),e.jsx(p,{Icon:a=>e.jsx("div",{...a}),children:e.jsxs(L,{...o,padding:t.unhealthy_reason?2:1,children:[e.jsx(r,{variant:"subtitle2",children:o.label}),t.unhealthy_reason&&e.jsxs(e.Fragment,{children:[e.jsx(r,{variant:"body2",paragraph:!0,children:"We encountered an error while trying to send messages to the URL. Webhook URL not valid or invalid response."}),e.jsx(Tn,{variant:"outlined",type:"submit",onClick:()=>s(n[2]),children:"Remove this integration"})]})]})}),e.jsxs(p,{Icon:o.icon||T,children:[e.jsx(r,{variant:"subtitle2",children:"Webhook Properties"}),e.jsx(y,{variant:"body2",color:"textSecondary",children:"Webhook Url"}),e.jsx(ge,{children:e.jsx(r,{variant:"subtitle2",noWrap:!0,children:t.webhook_url})}),e.jsx(y,{variant:"body2",color:"textSecondary",children:"Webhook Name"}),e.jsx(r,{variant:"subtitle2",children:t.app_name}),e.jsx(y,{variant:"body2",color:"textSecondary",children:"Webhook Description"}),e.jsx(r,{variant:"subtitle2",children:t.app_description}),e.jsx(y,{variant:"body2",color:"textSecondary",children:"Webhook Header"}),e.jsx(r,{variant:"subtitle2",children:t.webhook_header}),e.jsx(y,{variant:"body2",color:"textSecondary",children:"Webhook JSON"}),e.jsx(ge,{children:e.jsx(r,{variant:"subtitle2",noWrap:!0,children:t.webhook_json})}),e.jsx(Ne,{control:e.jsx(Ms,{disabled:!0,size:"small",checked:t.tls_enabled}),label:"TLS Enabled"})]}),e.jsxs(p,{Icon:Tt,children:[e.jsx(r,{variant:"subtitle2",children:"Alerts Properties"}),e.jsx(Be,{onClick:()=>s(n[0]),children:"Edit"}),e.jsx(Nt,{state:t.notify_settings,view:!0})]})]})},Wn="https://docs.streamsec.io/docs/kubernetes-integration",En=({integration:t,handleOptionsClick:s})=>{const[n]=Fs(),o=j.useMemo(()=>Gs(t),[t]),a=j.useMemo(()=>Wt.slice(1),[]);if(!t)return e.jsx(O,{children:e.jsx(r,{color:"textSecondary",children:"Nothing selected..."})});const l=w[t.status]||w.default;return e.jsxs(D,{children:[e.jsxs(p,{Icon:jt,children:[e.jsxs(G,{children:[e.jsx(Le,{onClick:()=>window.open(Wn,"_blank"),children:e.jsx(Et,{fontSize:"small"})}),e.jsx(Z,{options:o,onClickOptions:s})]}),e.jsx(r,{variant:"subtitle2",color:"textSecondary",children:"Kubernetes"}),e.jsx(r,{variant:"h6",children:t.display_name})]}),e.jsx(p,{Icon:c=>e.jsx("div",{...c}),children:e.jsx(L,{...l,padding:t.unhealthy_reason?2:1,children:e.jsxs(zt,{children:[e.jsx(r,{variant:"subtitle2",gutterBottom:!0,children:l.label}),t.status==="UNINITIALIZED"&&e.jsxs(e.Fragment,{children:[e.jsx(r,{color:"textSecondary",variant:"body2",paragraph:!0,children:"Pending agent confirmation of successful installation within your Kubernetes cluster. If the agent failed to install click below to return the integration wizard."}),e.jsx(_,{variant:"outlined",color:"primary",endIcon:e.jsx(Hs,{color:"action"}),onClick:()=>s({steps:a.map(c=>({...c,maxWidth:"600px",optionalInfo:{...t,_id:t._id,collection_token:t.collection_token,clusterType:t.cluster_type}}))}),children:"Install with Helm"})]})]})})}),e.jsxs(p,{Icon:l.icon||T,children:[e.jsx(r,{variant:"subtitle2",children:"Cluster Properties"}),e.jsx(y,{variant:"body2",color:"textSecondary",children:"Cluster API key"}),e.jsx(wt,{textToCopy:t.collection_token,title:"Collection token",children:e.jsx(r,{variant:"subtitle2",children:t.collection_token})}),e.jsx(y,{variant:"body2",color:"textSecondary",children:"Date added"}),e.jsx(r,{variant:"subtitle2",children:ns(t.creation_date,"long",n.is24h)})]})]})},ot=d(r).withConfig({displayName:"InspectIntegrationJira__CategoryTitle",componentId:"sc-13tah9s-0"})(["font-size:13px;font-weight:500;margin-right:","px;& ~ *:not(:last-child){margin-top:","px;}"],t=>t.theme.spacing(1),t=>t.theme.spacing(1)),zn=({integration:t,handleOptionsClick:s})=>{if(!t)return e.jsx(O,{children:e.jsx(r,{color:"textSecondary",children:"Nothing selected..."})});const n=w[t.status]||w.default;return e.jsxs(D,{children:[e.jsxs(p,{Icon:mt,children:[e.jsx(G,{children:e.jsx(Z,{options:Vs,onClickOptions:s})}),e.jsx(r,{variant:"subtitle2",color:"textSecondary",children:"Jira"}),t.name&&e.jsx(r,{noWrap:!0,variant:"body2",color:"textSecondary",children:t.name})]}),e.jsx(p,{Icon:o=>e.jsx("div",{...o}),children:e.jsxs(L,{...n,padding:1,InnerWrap:"div",children:[e.jsx(ot,{id:"integrationStatus",children:n.label}),n.Info&&e.jsx(n.Info,{integration:t,handleOptionsClick:s})]})}),e.jsxs(p,{Icon:n.icon||T,children:[e.jsx(ot,{children:"Integration Properties"}),(t==null?void 0:t.description)&&e.jsxs(e.Fragment,{children:[e.jsx(y,{variant:"body2",color:"textSecondary",children:"Description"}),e.jsx(r,{variant:"subtitle2",noWrap:!0,children:t.description})]}),(t==null?void 0:t.atlassian_cloud_url)&&e.jsxs(e.Fragment,{children:[e.jsx(y,{variant:"body2",color:"textSecondary",children:"Atlassian Cloud URL"}),e.jsx(r,{variant:"subtitle2",noWrap:!0,children:t.atlassian_cloud_url})]}),(t==null?void 0:t.email)&&e.jsxs(e.Fragment,{children:[e.jsx(y,{variant:"body2",color:"textSecondary",children:"API Creator Email"}),e.jsx(r,{variant:"subtitle2",noWrap:!0,children:t.email})]})]})]})},at=d(r).withConfig({displayName:"InspectIntegrationCVE__CategoryTitle",componentId:"sc-185dzp-0"})(["font-size:13px;font-weight:500;margin-right:","px;& ~ *:not(:last-child){margin-top:","px;}"],t=>t.theme.spacing(1),t=>t.theme.spacing(1)),Ln=/https:\/\/([a-zA-Z0-9]+)\.api\.insight\.rapid7\.com/,$n=({integration:t,handleOptionsClick:s})=>{var a,l,c,h,x;if(!t)return e.jsx(O,{children:e.jsx(r,{color:"textSecondary",children:"Nothing selected..."})});const n=w[t.status]||w.default,o=((x=(h=(c=(l=(a=t==null?void 0:t.platform_url)==null?void 0:a.match)==null?void 0:l.call(a,Ln))==null?void 0:c[1])==null?void 0:h.toUpperCase)==null?void 0:x.call(h))||"";return e.jsxs(D,{children:[e.jsxs(p,{Icon:m=>e.jsx(Ks,{source:t.type,...m}),children:[e.jsx(G,{children:e.jsx(Z,{options:Ys(t),onClickOptions:s})}),e.jsx(r,{variant:"subtitle2",color:"textSecondary"}),t.display_name&&e.jsx(r,{noWrap:!0,variant:"body2",color:"textSecondary",children:t.display_name})]}),e.jsx(p,{Icon:m=>e.jsx("div",{...m}),children:e.jsxs(L,{...n,padding:1,InnerWrap:"div",children:[e.jsx(at,{id:"integrationStatus",children:n.label}),n.Info&&e.jsx(n.Info,{integration:t,handleOptionsClick:s})]})}),e.jsxs(p,{Icon:n.icon||T,children:[e.jsx(at,{children:"Integration Properties"}),(t==null?void 0:t.description)&&e.jsxs(e.Fragment,{children:[e.jsx(y,{variant:"body2",color:"textSecondary",children:"Description"}),e.jsx(r,{variant:"subtitle2",noWrap:!0,children:t.description})]}),(t==null?void 0:t.organization_id)&&e.jsxs(e.Fragment,{children:[e.jsx(y,{variant:"body2",color:"textSecondary",children:"Organization ID"}),e.jsx(r,{variant:"subtitle2",noWrap:!0,children:t.organization_id})]}),(t==null?void 0:t.username)&&e.jsxs(e.Fragment,{children:[e.jsx(y,{variant:"body2",color:"textSecondary",children:"Username"}),e.jsx(r,{variant:"subtitle2",noWrap:!0,children:t.username})]}),(t==null?void 0:t.url)&&e.jsxs(e.Fragment,{children:[e.jsx(y,{variant:"body2",color:"textSecondary",children:"Server URL"}),e.jsx(r,{variant:"subtitle2",noWrap:!0,children:t.url})]}),(t==null?void 0:t.port)&&e.jsxs(e.Fragment,{children:[e.jsx(y,{variant:"body2",color:"textSecondary",children:"Port"}),e.jsx(r,{variant:"subtitle2",noWrap:!0,children:t.port})]}),(t==null?void 0:t.platform)&&e.jsxs(e.Fragment,{children:[e.jsx(y,{variant:"body2",color:"textSecondary",children:"Platform"}),e.jsx(r,{variant:"subtitle2",noWrap:!0,children:t.platform})]}),(t==null?void 0:t.platform_url)&&e.jsxs(e.Fragment,{children:[e.jsx(y,{variant:"body2",color:"textSecondary",children:"Platform URL"}),e.jsx(r,{variant:"subtitle2",noWrap:!0,children:t.platform_url})]}),o&&e.jsxs(e.Fragment,{children:[e.jsx(y,{variant:"body2",color:"textSecondary",children:"Region"}),e.jsx(r,{variant:"subtitle2",noWrap:!0,children:o})]})]})]})},On=qs(_)(({theme:t})=>({padding:"0px","&:hover":{background:"none"},"& .MuiButton-startIcon.MuiButton-iconSizeSmall":{marginLeft:0,marginRight:"5px"}})),re=({integration:t,editHandler:s,removeHandler:n})=>{const[o,a]=j.useState(null),l=m=>{a(m.currentTarget)},c=()=>{a(null)},h=()=>{n(t),c()},x=()=>{s(t),c()};return e.jsxs(e.Fragment,{children:[e.jsx(On,{variant:"text",onClick:l,size:"small",startIcon:e.jsx(Qs,{color:"action",fontSize:"small"})}),e.jsxs(Js,{anchorEl:o,keepMounted:!0,open:!!o,onClose:c,children:[e.jsxs(ye,{onClick:x,style:{padding:"8px 16px"},children:[e.jsx(qe,{children:e.jsx(Zs,{fontSize:"small"})}),"Edit Integration"]}),e.jsx(z,{component:"li",light:!0,variant:"middle"}),e.jsxs(ye,{onClick:h,style:{padding:"8px 16px"},children:[e.jsx(qe,{children:e.jsx(Xs,{fontSize:"small"})}),"Remove Integration"]})]})]})},Un={[$.Ready]:"Connected"},Pn=t=>{switch(t){case $.Deleting:case $.Unhealthy:case $.AccessDenied:case $.UnmatchAccounts:case"ERROR":return"red";case $.Ready:return"green";default:return"gray"}},H=({status:t})=>{const s=os(),n=Pn(t);return e.jsxs(e.Fragment,{children:[t===$.Ready?e.jsx(er,{style:{color:s.palette.common[n],fontSize:"26px"}}):e.jsx(tr,{style:{color:s.palette.common[n],fontSize:"18x"}}),Un[t]||as(t==null?void 0:t.toLowerCase())]})},Bn=({integration:t})=>{const{start:s,remove:n}=Gt(),{name:o,organization_name:a,ll_user:l,status:c}=t,h=x=>{n(x._id)};return e.jsxs(i,{column:!0,gap:2,pad:2,fullHeight:!0,children:[e.jsxs(i,{row:!0,gap:2,children:[e.jsx(i,{children:e.jsx(Lt,{width:24,height:24})}),e.jsxs(i,{column:!0,grow:!0,children:[e.jsx(r,{variant:"h6",color:"textSecondary",children:"Azure Boards"}),e.jsx(r,{variant:"body2",color:"textSecondary",children:o})]}),e.jsx(re,{integration:t,editHandler:s,removeHandler:h})]}),e.jsx(z,{}),e.jsx(i,{row:!0,center:!0,gap:!0,style:{paddingLeft:35},children:e.jsx(H,{status:c})}),e.jsx(z,{}),e.jsx(i,{column:!0,pad:2,gap:!0,children:e.jsxs(i,{row:!0,children:[e.jsx(i,{column:!0,style:{paddingRight:8,paddingTop:3},children:e.jsx(T,{fontSize:"small",color:"action"})}),e.jsxs(i,{column:!0,children:[e.jsx(r,{variant:"subtitle1",children:"Integration Properties:"}),e.jsxs(i,{column:!0,children:[e.jsx(r,{variant:"body2",color:"textSecondary",children:"Organization Name"}),e.jsx(r,{variant:"subtitle2",children:a}),e.jsx(r,{variant:"body2",color:"textSecondary",children:"Email"}),e.jsx(r,{variant:"subtitle2",children:l})]})]})]})})]})},it=d(r).withConfig({displayName:"InspectIntegrationDP__CategoryTitle",componentId:"sc-1gu6d95-0"})(["font-size:13px;font-weight:500;margin-right:","px;& ~ *:not(:last-child){margin-top:","px;}"],t=>t.theme.spacing(1),t=>t.theme.spacing(1)),Dn=({integration:t})=>{if(!t)return e.jsx(O,{children:e.jsx(r,{color:"textSecondary",children:"Nothing selected..."})});const s=w.READY;return e.jsxs(D,{children:[e.jsxs(p,{Icon:n=>e.jsx("img",{src:pt,alt:"Cyera logo",...n}),children:[e.jsx(G,{children:e.jsx(sr,{integration:t})}),e.jsx(r,{variant:"subtitle2",color:"textSecondary"}),t.display_name&&e.jsx(r,{noWrap:!0,variant:"body2",color:"textSecondary",children:t.display_name})]}),e.jsx(p,{Icon:n=>e.jsx("div",{...n}),children:e.jsx(L,{...s,padding:1,InnerWrap:"div",children:e.jsx(it,{id:"integrationStatus",children:s.label})})}),e.jsxs(p,{Icon:s.icon||T,children:[e.jsx(it,{children:"Integration Properties"}),(t==null?void 0:t.description)&&e.jsxs(e.Fragment,{children:[e.jsx(y,{variant:"body2",color:"textSecondary",children:"Description"}),e.jsx(r,{variant:"subtitle2",noWrap:!0,children:t.description})]}),t.client_id&&e.jsxs(e.Fragment,{children:[e.jsx(y,{variant:"body2",color:"textSecondary",children:"Client ID"}),e.jsx(r,{variant:"subtitle2",noWrap:!0,children:t.client_id})]})]})]})},ct=d(r).withConfig({displayName:"InspectIntegrationEDR__CategoryTitle",componentId:"sc-1t4ucgc-0"})(["font-size:13px;font-weight:500;margin-right:","px;& ~ *:not(:last-child){margin-top:","px;}"],t=>t.theme.spacing(1),t=>t.theme.spacing(1));function Mn(t){return e.jsx("div",{...t})}function Fn({integrationType:t}){switch(t){case P.Crowdstrike:return e.jsx(xt,{style:{width:"20px",height:"20px"}});case P.SentinelOne:return e.jsx(ht,{style:{width:"20px",height:"20px"}});case P.Cortex:return e.jsx(ut,{style:{width:"20px",height:"20px"}});default:return null}}function Gn({integration:t}){if(!t)return e.jsx(O,{children:e.jsx(r,{color:"textSecondary",children:"Nothing selected..."})});const s=w.READY;return e.jsxs(D,{children:[e.jsxs(i,{row:!0,center:!0,gap:2,children:[e.jsx(Fn,{integrationType:t.type}),e.jsxs(i,{column:!0,children:[e.jsx(r,{variant:"subtitle2",color:"textSecondary",children:{[P.Crowdstrike]:"CrowdStrike",[P.SentinelOne]:"SentinelOne",[P.Cortex]:"Cortex"}[t.type]||""}),t.display_name&&e.jsx(r,{noWrap:!0,variant:"subtitle1",children:t.display_name})]}),e.jsx(i,{grow:!0}),{[P.Crowdstrike]:e.jsx(or,{integration:t}),[P.SentinelOne]:e.jsx(nr,{integration:t}),[P.Cortex]:e.jsx(rr,{integration:t})}[t.type]||""]}),e.jsx(p,{Icon:Mn,children:e.jsx(L,{...s,padding:1,InnerWrap:"div",children:e.jsx(ct,{id:"integrationStatus",children:s.label})})}),e.jsxs(p,{Icon:s.icon||T,children:[e.jsx(ct,{children:"Integration Properties"}),(t==null?void 0:t.description)&&e.jsxs(e.Fragment,{children:[e.jsx(y,{variant:"body2",color:"textSecondary",children:"Description"}),e.jsx(r,{variant:"subtitle2",noWrap:!0,children:t.description})]}),t.client_id&&e.jsxs(e.Fragment,{children:[e.jsx(y,{variant:"body2",color:"textSecondary",children:"Client ID"}),e.jsx(r,{variant:"subtitle2",noWrap:!0,children:t.client_id})]}),t.platform_url&&e.jsxs(e.Fragment,{children:[e.jsx(y,{variant:"body2",color:"textSecondary",children:t.type===P.Cortex?"API Base URL":"Domain URL"}),e.jsx(r,{variant:"subtitle2",noWrap:!0,children:t.platform_url})]}),t.access_token&&e.jsxs(e.Fragment,{children:[e.jsx(y,{variant:"body2",color:"textSecondary",children:"SentinelOne Token"}),e.jsx(r,{variant:"subtitle2",noWrap:!0,children:t.access_token})]})]})]})}const Hn=({integration:t})=>{const{display_name:s,api_key:n,status:o,domain:a}=t,{start:l,remove:c}=Pe(),h=x=>{c(x.id)};return e.jsxs(i,{column:!0,gap:2,pad:2,fullHeight:!0,children:[e.jsxs(i,{row:!0,gap:2,children:[e.jsx(i,{children:e.jsx($t,{width:24,height:24})}),e.jsxs(i,{column:!0,grow:!0,children:[e.jsx(r,{variant:"h6",color:"textSecondary",children:"Okta"}),e.jsx(r,{variant:"body2",color:"textSecondary",children:s})]}),e.jsx(re,{integration:t,editHandler:l,removeHandler:h})]}),e.jsx(z,{}),e.jsx(i,{row:!0,center:!0,gap:!0,style:{paddingLeft:35},children:e.jsx(H,{status:o})}),e.jsx(z,{}),e.jsx(i,{column:!0,pad:2,gap:!0,children:e.jsxs(i,{row:!0,children:[e.jsx(i,{column:!0,style:{paddingRight:8,paddingTop:3},children:e.jsx(T,{fontSize:"small",color:"action"})}),e.jsxs(i,{column:!0,children:[e.jsx(r,{variant:"subtitle1",children:"Integration Properties:"}),e.jsxs(i,{column:!0,children:[e.jsx(r,{variant:"body2",color:"textSecondary",children:"API Key"}),e.jsx(r,{variant:"subtitle2",children:n}),e.jsx(r,{variant:"body2",color:"textSecondary",children:"Domain"}),e.jsx(r,{variant:"subtitle2",children:a})]})]})]})})]})};function Vn({integration:t}){const{name:s,cloud_url:n,status:o}=t;return e.jsxs(i,{column:!0,gap:2,pad:2,fullHeight:!0,children:[e.jsxs(i,{row:!0,gap:2,children:[e.jsx(i,{children:e.jsx(Ot,{width:24,height:24})}),e.jsxs(i,{column:!0,grow:!0,children:[e.jsx(r,{variant:"h6",color:"textSecondary",children:"JetBrains YouTrack"}),e.jsx(r,{variant:"body2",color:"textSecondary",children:s})]})]}),e.jsx(z,{}),e.jsx(i,{row:!0,center:!0,gap:!0,style:{paddingLeft:35},children:e.jsx(H,{status:o})}),e.jsx(z,{}),e.jsx(i,{column:!0,pad:2,gap:!0,children:e.jsxs(i,{row:!0,children:[e.jsx(i,{column:!0,style:{paddingRight:8,paddingTop:3},children:e.jsx(T,{fontSize:"small",color:"action"})}),e.jsxs(i,{column:!0,children:[e.jsx(r,{variant:"subtitle1",children:"Integration Properties:"}),e.jsxs(i,{column:!0,children:[e.jsx(r,{variant:"body2",color:"textSecondary",children:"Service URL"}),e.jsx(r,{variant:"subtitle2",children:n})]})]})]})})]})}function Yn({integration:t}){const{name:s,instance_name:n,status:o,username:a}=t;return e.jsxs(i,{column:!0,gap:2,pad:2,fullHeight:!0,children:[e.jsxs(i,{row:!0,gap:2,children:[e.jsx(i,{children:e.jsx(Ut,{width:24,height:24})}),e.jsxs(i,{column:!0,grow:!0,children:[e.jsx(r,{variant:"h6",color:"textSecondary",children:"ServiceNow"}),e.jsx(r,{variant:"body2",color:"textSecondary",children:s})]})]}),e.jsx(z,{}),e.jsx(i,{row:!0,center:!0,gap:!0,style:{paddingLeft:35},children:e.jsx(H,{status:o})}),e.jsx(z,{}),e.jsx(i,{column:!0,pad:2,gap:!0,children:e.jsxs(i,{row:!0,children:[e.jsx(i,{column:!0,style:{paddingRight:8,paddingTop:3},children:e.jsx(T,{fontSize:"small",color:"action"})}),e.jsxs(i,{column:!0,children:[e.jsx(r,{variant:"subtitle1",children:"Integration Properties:"}),e.jsxs(i,{column:!0,children:[e.jsx(r,{variant:"body2",color:"textSecondary",children:"Instance Name"}),e.jsx(r,{variant:"subtitle2",children:n}),e.jsx(r,{variant:"body2",color:"textSecondary",children:"Username"}),e.jsx(r,{variant:"subtitle2",children:a})]})]})]})})]})}const Kn={[C.Aws]:jn,[C.Azure]:gn,[C.Gcp]:kn,slack:An,webhook:Nn,kubernetes:En,jira:zn,cve:$n,azureBoards:Bn,dp:Dn,edr:Gn,okta:Hn,youtrack:Vn,service_now:Yn},D=d.div.withConfig({displayName:"InspectIntegration__Layout",componentId:"sc-nxaeib-0"})(["position:relative;display:flex;flex-direction:column;padding:","px;& > *:not(:last-child){margin-bottom:","px;}"],t=>t.theme.spacing(3),t=>t.theme.spacing(2)),G=d.div.withConfig({displayName:"InspectIntegration__IconWrapper",componentId:"sc-nxaeib-1"})(["position:absolute;right:0;top:0;"]),y=d(r).withConfig({displayName:"InspectIntegration__Subtitle",componentId:"sc-nxaeib-2"})(["display:flex;align-items:center;margin-top:","px;& > *{margin-left:","px;}"],t=>t.theme.spacing(2),t=>t.theme.spacing(1)),Be=d(_).withConfig({displayName:"InspectIntegration__EditLink",componentId:"sc-nxaeib-3"})(["position:absolute;top:","px;right:0;"],t=>t.theme.spacing(1.5));Be.defaultProps={variant:"text"};const qn=t=>{if(!t.integration)return e.jsx(O,{children:e.jsx(r,{color:"textSecondary",children:"Nothing selected..."})});const s=Kn[t.type||t.integration.type];return e.jsx(s,{...t})},Qn=484,Jn=(t={})=>{const{workspaceId:s}=fe(),n=is(),{error:o,loading:a}=q(kt`
      query Permissions($user_id: ID, $workspace_id: ID) {
        permissions(user_id: $user_id, workspace_id: $workspace_id) {
          _id
        }
      }
    `,{fetchPolicy:"cache-and-network",...t,variables:{workspace_id:s,user_id:n==null?void 0:n._id}}),l=j.useMemo(()=>{var c,h,x;return!((c=o==null?void 0:o.graphQLErrors)!=null&&c.length&&((x=(h=o==null?void 0:o.graphQLErrors[0])==null?void 0:h.extensions)==null?void 0:x.status)===Qn)},[o]);return{loading:a,isUserHasPermission:l}},Ie=d("div").withConfig({displayName:"IntegrationsBadge",componentId:"sc-sldkfw-0"})(({theme:t,isActive:s,color:n="green"})=>({display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:s?t.palette.common[n]:t.palette.common.gray,width:8,height:28,borderRadius:t.shape.borderRadius})),ve=d(i).withConfig({displayName:"IntegrationsStyles__InnerContainer",componentId:"sc-1if8jlb-0"})(({theme:t,isSelected:s})=>({cursor:s?"default":"pointer",backgroundColor:s?J(t.palette.primary.main,.12):t.palette.background.paper,border:"1px solid",borderColor:J(t.palette.common.gray,.1),height:"42px","&:hover":{backgroundColor:s?void 0:t.palette.action.hover}})),E=d("div").withConfig({displayName:"IntegrationsStyles__ColumnItem",componentId:"sc-1if8jlb-1"})(({theme:t})=>({padding:"6px",minWidth:"250px"})),Zn=({integration:t,selected:s,setSelected:n})=>{const o=(s&&(s==null?void 0:s.id)===(t==null?void 0:t.id))??!1,{start:a,remove:l}=Pe(),c=h=>{l(h.id),n(null)};return e.jsxs(ve,{row:!0,center:!0,grow:!0,gap:!0,onClick:()=>n(t),isSelected:o,children:[e.jsx(E,{children:e.jsxs(i,{row:!0,grow:!0,gap:4,center:!0,children:[e.jsx(Ie,{isActive:(t==null?void 0:t.status)===$.Ready}),e.jsx("span",{children:t==null?void 0:t.display_name})]})}),e.jsx(E,{style:{paddingLeft:30},children:t==null?void 0:t.domain}),e.jsx(E,{}),e.jsx(i,{row:!0,center:!0,grow:!0,gap:2,pad:3,children:e.jsx(H,{status:t.status})}),e.jsx(re,{integration:t,editHandler:a,removeHandler:c})]})},Xn=d.div.withConfig({displayName:"IntegrationsList__StyledContainer",componentId:"sc-vgrp7o-0"})(({theme:t})=>({background:t.palette.background.paper,padding:t.spacing(1),boxShadow:"0px 3px 6px #00000029",borderRadius:t.shape.borderRadius,"& > :nth-child(odd)":{background:J(t.palette.common.gray,.06)},"& > :first-child":{borderTopLeftRadius:t.shape.borderRadius,borderTopRightRadius:t.shape.borderRadius,"& > :first-of-type":{borderTopLeftRadius:t.shape.borderRadius,borderTopRightRadius:t.shape.borderRadius}},"& > :last-child":{borderBottomLeftRadius:t.shape.borderRadius,borderBottomRightRadius:t.shape.borderRadius,"& > :first-of-type":{borderBottomLeftRadius:t.shape.borderRadius,borderBottomRightRadius:t.shape.borderRadius}},"& > :not(:first-child):not(:last-child)":{borderRadius:0}})),me=({title:t,integrations:s,addIntegrationCB:n,render:o,Icon:a})=>s!=null&&s.length?e.jsxs(oe,{container:!0,direction:"column",spacing:1,style:{marginBottom:12},children:[e.jsxs(oe,{item:!0,container:!0,direction:"row",spacing:1,children:[e.jsx(oe,{item:!0,children:a}),e.jsx(oe,{item:!0,children:e.jsx(r,{variant:"h5",children:t})}),e.jsx(i,{row:!0,grow:!0}),n&&e.jsx(oe,{item:!0,style:{paddingRight:5},children:e.jsx(se,{onClick:()=>n(null),children:e.jsx(ar,{color:"action"})})})]}),e.jsx(Xn,{children:s.map((l,c)=>o(l))})]}):e.jsx(e.Fragment,{}),eo=({integration:t,selected:s,setSelected:n})=>{const{start:o,remove:a}=Gt(),l=!!(s&&s._id===t._id),c=h=>{a(h._id),n(null)};return e.jsxs(ve,{row:!0,center:!0,grow:!0,onClick:()=>n(t),isSelected:l,gap:!0,children:[e.jsx(E,{children:e.jsxs(i,{row:!0,grow:!0,gap:4,center:!0,children:[e.jsx(Ie,{isActive:t.status===$.Ready}),e.jsx("span",{children:t.name})]})}),e.jsx(E,{style:{paddingLeft:30},children:t.organization_name}),e.jsx(E,{}),e.jsx(i,{row:!0,center:!0,grow:!0,gap:2,pad:3,children:e.jsx(H,{status:t.status})}),e.jsx(re,{integration:t,editHandler:o,removeHandler:c})]})},to=({integration:t,selected:s,setSelected:n})=>{const o=s&&s._id===t._id;return e.jsxs(ve,{row:!0,center:!0,grow:!0,onClick:()=>n(t),isSelected:o,gap:!0,children:[e.jsx(E,{children:e.jsxs(i,{row:!0,grow:!0,gap:4,center:!0,children:[e.jsx(Ie,{isActive:t.status===$.Ready}),e.jsx("span",{children:t.name})]})}),e.jsx(E,{style:{paddingLeft:30}}),e.jsx(E,{}),e.jsx(i,{row:!0,center:!0,grow:!0,gap:2,pad:3,children:e.jsx(H,{status:t.status})}),e.jsx(so,{integration:t,onDelete:()=>n(null)})]})};function so({integration:t,onDelete:s}){const n=Oe(),o=ce(),a=()=>{o.confirm({title:"Delete JetBrains YouTrack Integration",text:"Are you sure you want to delete this integration?",confirmText:"Delete",declineText:"Cancel",actionsLayout:"row",confirmRed:!0,inputText:{disabled:!0}}).then(()=>{n.mutate({mutation:ie(`
          mutation DeleteYoutrackIntegration($id: ID!) {
            ticket_system_delete_integration(integration_id: $id)
          }
        `),variables:{id:t._id},update(c){c.evict({fieldName:"ticket_system_integrations"})}}),s()})},l=()=>{o.open(c=>e.jsx(Rr,{...c,id:t._id}),{fullWidth:!1})};return e.jsx(re,{integration:t,editHandler:l,removeHandler:a})}const ro=({integration:t,selected:s,setSelected:n})=>{const o=s&&s._id===t._id;return e.jsxs(ve,{row:!0,center:!0,grow:!0,onClick:()=>n(t),isSelected:o,gap:!0,children:[e.jsx(E,{children:e.jsxs(i,{row:!0,grow:!0,gap:4,center:!0,children:[e.jsx(Ie,{isActive:t.status===$.Ready}),e.jsx("span",{children:t.name})]})}),e.jsx(E,{style:{paddingLeft:30}}),e.jsx(E,{}),e.jsx(i,{row:!0,center:!0,grow:!0,gap:2,pad:3,children:e.jsx(H,{status:t.status})}),e.jsx(no,{integration:t,onDelete:()=>n(null)})]})};function no({integration:t,onDelete:s}){const n=Oe(),o=ce(),a=()=>{o.confirm({title:"Delete ServiceNow Integration",text:"Are you sure you want to delete this integration?",confirmText:"Delete",declineText:"Cancel",actionsLayout:"row",confirmRed:!0,inputText:{disabled:!0}}).then(()=>{n.mutate({mutation:ie(`
          mutation DeleteServiceNowIntegration($id: ID!) {
            ticket_system_delete_integration(integration_id: $id)
          }
        `),variables:{id:t._id},update(c){c.evict({fieldName:"ticket_system_integrations"})}}),s()})},l=()=>{o.open(c=>e.jsx(Ar,{...c,id:t._id}),{fullWidth:!1})};return e.jsx(re,{integration:t,editHandler:l,removeHandler:a})}const oo=d.div.withConfig({displayName:"IntegrationsMain__Container",componentId:"sc-1y25330-0"})(["display:flex;justify-content:space-between;flex-wrap:wrap;margin-top:",";margin-bottom:",";margin-left:","px;height:100%;overflow:auto;"],t=>`${t.theme.spacing(4)}px`,t=>`${t.theme.spacing(.5)}px`,t=>t.theme.spacing(3)),ao=d.div.withConfig({displayName:"IntegrationsMain__MainIntegrations",componentId:"sc-1y25330-1"})(["flex-basis:65%;border-radius:","px;margin-right:","px;flex-grow:9999;"],t=>t.theme.shape.borderRadius,t=>t.theme.spacing(2)),io=d($e).withConfig({displayName:"IntegrationsMain__SideSettings",componentId:"sc-1y25330-2"})(["position:sticky;top:0;flex-basis:calc(35% - ","px);max-width:500px;height:calc(100% - ","px);border-radius:","px;border:1px solid ",";margin-right:","px;overflow-x:hidden;flex-grow:1;"],t=>t.theme.spacing(5),t=>t.theme.spacing(4),t=>t.theme.shape.borderRadius,t=>J(t.theme.palette.common.gray,.1),t=>t.theme.spacing(3));function co({accounts:t,slacks:s,webhooks:n,kubernetes:o,cve_integrations:a,dp_integrations:l,edr_integrations:c,jira_integrations:h,azureIntegrations:x,ytIntegrations:m,snIntegrations:b,oktaIntegrations:I,addAwsModal:g,addAzureModal:N,addSlackModal:k,addWebhookModal:R,addKubernetesModal:Ce,addSnykModal:we}){const M=j.useMemo(()=>[...t,...s,...n,...o,...a,...h,...l,...c,...x,...I,...m,...b],[t,a,l,c,h,o,s,n,x,I,m,b]),Se=ce(),[f,F]=j.useState(),[_e,ke]=j.useState(),[V,ne]=j.useState(),{isUserHasPermission:Y}=Jn(),{start:X}=Pe();j.useEffect(()=>{f&&F(M.find(u=>u._id===f._id))},[F,f,M]);const S=(u,U)=>{var le;console.log("handleOptionsClick",U),U.steps&&(U={stepsInfo:U.steps}),ne({...U,stepsInfo:(le=U.stepsInfo)==null?void 0:le.map(K=>({...K,optionalInfo:{integration:u,...K.optionalInfo}}))})},v=u=>U=>{ke(u),F(U)};return j.useEffect(()=>{f&&!M.find(u=>f.id===u.id)&&F(null)},[M,f]),e.jsxs(oo,{children:[e.jsxs(ao,{children:[e.jsx(W,{id:"AWS",type:C.Aws,title:"Amazon web services",integrations:j.useMemo(()=>t.filter(u=>u.account_type===C.Aws),[t]),selected:f,setSelected:v(C.Aws),handleOptionsClick:S,addModal:Y&&g}),e.jsx(W,{id:"Azure",type:C.Azure,title:"Azure",integrations:j.useMemo(()=>t.filter(u=>u.account_type===C.Azure),[t]),selected:f,setSelected:v(C.Azure),handleOptionsClick:S,addModal:Y&&N}),e.jsx(W,{id:"GCP",type:C.Gcp,title:"Google Cloud Platform",integrations:j.useMemo(()=>t.filter(u=>u.account_type===C.Gcp||u.account_type===C.GoogleWorkspace),[t]),selected:f,setSelected:v(C.Gcp),addModal:()=>Se.open(Pt,{fullWidth:!0,size:"md"})}),e.jsx(W,{id:"Slack",type:"slack",title:"Slack",integrations:s,selected:f,setSelected:v("slack"),handleOptionsClick:S,addModal:k}),e.jsx(W,{id:"Webhook",type:"webhook",title:"Webhook",integrations:n,selected:f,setSelected:v("webhook"),handleOptionsClick:S,addModal:R}),e.jsx(W,{id:"Kubernetes",type:"kubernetes",title:"Kubernetes",integrations:o,selected:f,setSelected:v("kubernetes"),handleOptionsClick:S,addModal:Y&&Ce}),e.jsx(W,{id:"CVE",type:"cve",title:"Vulnerabilities",integrations:a,selected:f,setSelected:v("cve"),handleOptionsClick:S,addModal:Y&&we}),e.jsx(W,{id:"Jira",type:"jira",title:"Jira",integrations:h,selected:f,setSelected:v("jira"),handleOptionsClick:S}),e.jsx(W,{id:"dp",type:"dp",title:"Cyera",integrations:l,selected:f,setSelected:v("dp"),handleOptionsClick:S}),e.jsx(W,{id:"CrowdStrike",type:"edr",title:"CrowdStrike",integrations:j.useMemo(()=>c==null?void 0:c.filter(u=>u.type==="Crowdstrike"),[c]),selected:f,setSelected:v("edr"),handleOptionsClick:S}),e.jsx(W,{id:"SentinelOne",type:"edr",title:"SentinelOne",integrations:j.useMemo(()=>c==null?void 0:c.filter(u=>u.type==="SentinelOne"),[c]),selected:f,setSelected:v("edr"),handleOptionsClick:S}),e.jsx(W,{id:"Cortex",type:"edr",title:"Cortex",integrations:j.useMemo(()=>c==null?void 0:c.filter(u=>u.type==="Cortex"),[c]),selected:f,setSelected:v("edr"),handleOptionsClick:S}),e.jsx(me,{title:"Azure",integrations:x,render:u=>e.jsx(eo,{integration:u,selected:f,setSelected:v("azureBoards")},u._id),Icon:e.jsx(Lt,{width:18,height:18})}),e.jsx(me,{title:"JetBrains YouTrack",integrations:m,render:u=>e.jsx(to,{integration:u,selected:f,setSelected:v("youtrack")},u._id),Icon:e.jsx(Ot,{width:18,height:18})}),e.jsx(me,{title:"ServiceNow",integrations:b,render:u=>e.jsx(ro,{integration:u,selected:f,setSelected:v("service_now")},u._id),Icon:e.jsx(Ut,{width:18,height:18})}),e.jsx(me,{title:"Okta",integrations:I,addIntegrationCB:X,render:u=>e.jsx(Zn,{integration:u,selected:f,setSelected:v("okta")},u.id),Icon:e.jsx($t,{width:18,height:18})})]}),e.jsx(io,{children:e.jsx(ir,{children:e.jsx(qn,{integration:f,type:_e,handleOptionsClick:u=>S(f,u)})},(f==null?void 0:f._id)??"none")}),!!V&&e.jsx(Bt,{closeDialog:()=>ne(!1),dialogOpen:!0,...V})]})}const lo="/playground/assets/empty-header-DGiavIoQ.png",uo=d.div.withConfig({displayName:"NoAccountsView__Content",componentId:"sc-znhm10-0"})(["display:flex;flex-direction:column;align-items:flex-start;padding:","px;& > *:not(:last-child){margin-bottom:","px;}"],t=>t.theme.spacing(4),t=>t.theme.spacing(2)),ho=({addAwsModal:t,addAzureModal:s})=>{const n=cr(),o=lr(),a=ce();return e.jsxs(xo,{children:[e.jsx("img",{alt:"Header",src:lo}),e.jsxs(uo,{children:[e.jsx(r,{variant:"subtitle1",color:"textSecondary",children:n==null?void 0:n.display_name}),e.jsxs("div",{children:[e.jsxs(r,{variant:"h6",children:["Hello ",o==null?void 0:o.full_name,","]}),e.jsx(r,{variant:"subtitle1",color:"textSecondary",children:"Your new workspace is ready! Let’s start by adding a cloud account"})]}),e.jsx(_,{startIcon:e.jsx(B,{id:"AWS",type:"Cloud",size:"medium"}),variant:"text",color:"default",fullWidth:!1,onClick:t,children:e.jsx(r,{variant:"subtitle2",children:"Add AWS Cloud account"})}),e.jsx(_,{startIcon:e.jsx(B,{id:"Azure",type:"Cloud",size:"medium"}),variant:"text",color:"default",fullWidth:!1,onClick:s,children:e.jsx(r,{variant:"subtitle2",children:"Add Azure Cloud account"})}),e.jsx(_,{startIcon:e.jsx(B,{id:"GCP",type:"Cloud",size:"medium"}),variant:"text",color:"default",fullWidth:!1,onClick:()=>{a.open(Pt,{fullWidth:!0,size:"md"})},children:e.jsx(r,{variant:"subtitle2",children:"Add Google Cloud account"})}),e.jsx(z,{light:!0,style:{width:"100%"}}),e.jsx(r,{variant:"subtitle2",color:"textSecondary",children:"You might be interested in"}),e.jsx(_,{component:"a",href:"https://docs.streamsec.io/",target:"_blank",variant:"text",color:"default",startIcon:e.jsx(Et,{color:"action"}),children:e.jsx(r,{variant:"subtitle2",children:"Help center"})})]})]})},xo=cs(t=>({root:{position:"relative",alignSelf:"center",paddingTop:0,borderRadius:t.shape.borderRadius*2,display:"flex",marginRight:"10%",flexDirection:"column",maxWidth:"370px",marginTop:"8%"}}))($e),po=()=>e.jsx(mo,{children:e.jsxs(jo,{gap:1,children:[e.jsx(dr,{fontSize:"large",color:"primary"}),e.jsx(r,{variant:"h6",color:"primary",children:"No Access"}),e.jsx(r,{children:"Contact your workspace administrator"})]})}),mo=d.div.withConfig({displayName:"NoGroupsView__Container",componentId:"sc-1q65cng-0"})(["display:flex;height:100%;"]),jo=d(zt).withConfig({displayName:"NoGroupsView__MainContent",componentId:"sc-1q65cng-1"})(["margin:0 auto;align-items:center;align-self:center;"]),So=()=>{var Fe;const{workspaceId:t}=fe(),s=ur(t),n=ls(),{data:{cloudAccounts:o=[]}={},error:a,loading:l}=he(Ir,br),{data:{slacks:c=[]}={},error:h,loading:x}=he(Cr,vr),{data:{webhooks:m=[]}={},error:b,loading:I}=he(Sr,wr),{data:{kubernetes:g=[]}={},error:N,loading:k}=he(kr,_r),{data:{cve_integrations:R=[]}={},error:Ce,loading:we}=q(hr),{data:{dp_integrations:M=[]}={},error:Se,loading:f}=q(xr),{data:{edr_integrations:F=[]}={},error:_e,loading:ke}=q(pr),{integrations:V=[],error:ne,loading:Y}=mr(),{integrations:X=[],error:S,loading:v}=jr(),{data:{ticket_system_integrations:u=[]}={ticket_system_integrations:[]},error:U,loading:le}=q(Tr),{data:{ticket_system_integrations:K=[]}={ticket_system_integrations:[]},error:Yt,loading:Kt}=q(Nr),{integrations:de=[],error:qt,loading:Qt}=Wr(),[Re,A]=j.useState(!1),Jt=(c==null?void 0:c.length)+(m==null?void 0:m.length)+(o==null?void 0:o.length)+(g==null?void 0:g.length)+(R==null?void 0:R.length)+(V==null?void 0:V.length)+(X==null?void 0:X.length)+(de==null?void 0:de.length)+(M==null?void 0:M.length)+(F==null?void 0:F.length)+(u==null?void 0:u.length)+(K==null?void 0:K.length),De=l||x||I||k||we||Y||v||f||ke||Y||v||Qt||le||Kt,Me=a||h||b||N||Ce||ne||S||Se||_e||ne||S||qt||U||Yt;j.useEffect(()=>{var He;if(new URLSearchParams(window.location.search).get("code")){const es=Te.slice(1);A(es)}(He=n.state)!=null&&He.addIntegration&&(n.state.addIntegration==="AWS"?A(je):n.state.addIntegration==="slack"?A(Te):n.state.addIntegration==="webhook"&&A(Qe))},[n]);const Zt=ds();return e.jsxs(yr,{display:"flex",flexDirection:"column",height:"100%",children:[e.jsx(Ur,{Icon:gr,title:"Settings",selector:e.jsxs(fr,{onChange:(Xt,Ge)=>{Zt.push(Ge)},value:us(),children:[e.jsx(Je,{value:"/integrations",label:"Integrations"}),e.jsx(Je,{value:"/collection",label:"Log Collection Status"})]}),actions:!s&&e.jsx(Er,{setIntegrationSteps:A,initialOpened:((Fe=n.state)==null?void 0:Fe.addIntegration)==="openTooltip"})}),Jt>0?e.jsx(co,{accounts:o,slacks:c,webhooks:m,kubernetes:g,azureIntegrations:X,ytIntegrations:u,snIntegrations:K,cve_integrations:R,dp_integrations:M,edr_integrations:F,jira_integrations:V,oktaIntegrations:de,addAwsModal:()=>A(je),addAzureModal:()=>A(Ze),addSlackModal:()=>A(Te),addWebhookModal:()=>A(Qe),addKubernetesModal:()=>A(Wt),addSnykModal:()=>A(zr)}):De||Me?e.jsx(O,{children:De?e.jsx(At,{}):e.jsx(vt,{error:Me})}):s?e.jsx(po,{}):!Re&&e.jsx(ho,{addAwsModal:()=>A(je),addAzureModal:()=>A(Ze)}),Re&&e.jsx(Bt,{closeDialog:()=>A(!1),dialogOpen:!0,stepsInfo:Re})," "]})};export{So as default};

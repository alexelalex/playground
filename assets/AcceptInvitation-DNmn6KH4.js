import{u as F,a as L,j as s,b as W,c as V,r as m}from"./index-SzT5NDvv.js";import{j as f,q as y,r as _,s as $,m as B,i as N,k as j,v as z,W as D,d as r,n as M,T as Q,t as R,w as Y,x as A,y as H,o as G,p as J,C as K}from"./App-C5BQGUHJ.js";import{u as O}from"./login-BdZ1iQ2N.js";const is=()=>{var t;const[e]=F("token");let{data:i,error:n,loading:o}=L(f`
      query VerifySignUpToken($token: String) {
        verifySignUpToken(token: $token) {
          email
        }
      }
    `,{skip:!e,variables:{token:e}});if(o)return s.jsx(y,{children:s.jsx(_,{})});const l=(t=i==null?void 0:i.verifySignUpToken)==null?void 0:t.email;return n?s.jsx(y,{children:s.jsx($,{error:n})}):e?s.jsx(Z,{email:l,token:e}):s.jsx(W,{to:"/login"})},X=B(e=>({userEmail:{padding:e.spacing(2,0,0,5)},passwordValidText:{color:e.palette.success.main},mainTextClass:{marginBottom:e.spacing(2)}}));function Z({email:e,token:i}){const n=X(),o=V(),[l,{loading:t,error:v}]=O(),[k,{error:b,loading:u}]=N(f`
      mutation SignUp($input: SignUpInput) {
        signUp(input: $input)
      }
    `),[p,S]=j(""),[c,w]=j(""),[C,U]=m.useState(!1),d=z(c),g=u||t,h=!g&&(b||v),[x,P]=m.useState(!1),T=u||!!d||!p||!x;async function E(){I().catch(()=>{})}async function I(){await k({variables:{input:{email:e,verify_user_token:i,password:c,full_name:p}}}),await l({variables:{credentials:{email:e,password:c}}}).catch(q=>{console.error(q)}),o.replace("/")}return s.jsxs(D,{children:[s.jsxs("div",{children:[s.jsx(r,{variant:"h6",className:n.mainTextClass,children:"Set up your account"}),s.jsx(M,{})]}),s.jsxs("div",{children:[s.jsx(r,{variant:"body1",children:"You've been invited to signup to Stream Security."}),s.jsx(r,{variant:"body1",children:"Please finish creating your account by completing the following registration form."})]}),s.jsxs("div",{children:[s.jsx(r,{variant:"body1",children:"Your work E-mail:"}),s.jsx(r,{variant:"h6",className:n.userEmail,children:e})]}),s.jsx(Q,{label:"Full Name",type:"text",fullWidth:!0,variant:"outlined",...S,required:!0}),s.jsx(R,{label:"Password",fullWidth:!0,variant:"outlined",onFocus:()=>U(!0),inputProps:{autoComplete:"new-password"},...w,required:!0}),s.jsx(Y,{in:C,children:d&&d.map(a=>s.jsx(r,{variant:"body2",children:a},a))}),s.jsxs(A,{display:"flex",alignItems:"center",children:[s.jsx(H,{id:"tos",color:"primary",checked:x,onClick:()=>P(a=>!a)}),s.jsx(r,{display:"inline",variant:"subtitle2",children:s.jsxs("label",{htmlFor:"tos",children:["I agree to the"," ",s.jsx(G,{target:"_blank",href:"https://stream.security/proof-of-concept-agreement",color:"primary",children:"Terms of Service and Privacy policy"})]})})]}),s.jsx(J,{startIcon:g&&s.jsx(K,{size:20}),variant:"contained",size:"large",color:"primary",fullWidth:!0,onClick:E,disabled:T,children:"Sign Up"}),h&&s.jsx(r,{color:"error",children:h.message})]})}export{is as default};
